{
  "hash": "e4b4d16a3f6f9ac7544d17416099fe08",
  "result": {
    "markdown": "---\ntitle: \"Day 11: Inference for difference in means from two independent samples and Power (Sections 5.3, 5.4)\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"09/25/2024\"\ncategories: [\"Week 6\"]\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    toc: true\n    toc-depth: 1\n    toc-title: Class Overview\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1600\n    height: 1100\n    footer: Lesson 8 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n\n## MoRitz's tip of the day\n\nAdd tabbed sections to your html file using `tabset`.\n\n::: panel-tabset\n\n### First tab\n\n* You can make subsections appear as different tabs in your html file.\n* This is the first tab.\n* It was created by adding `::: panel-tabset` right above the subsection `### First tab` ([see the code file]{style=\"color:green\"}). \n* Look up to the right of where it says \"First tab,\" and you will see a second tab with the creative name \"Second tab.\"\n* If you are viewing the html output of this file, you can click on the different tabs to see what's in them.\n* To stop new tabs from being created, close off the original `::: panel-tabset` command with `:::` at the end.\n    * In the source code file, you will see the `:::` at the end of the `### Read up on tabsets` tab.\n\n\n### Second tab\n\n* Welcome to the second tab! \n\n\n![](/img_slides/mimi_normal_IMG_4244.png){fig-align=\"center\"}\n\n### Read up on tabsets\n\n* You can read up more about creating tabs at\n  * <https://quarto.org/docs/interactive/layout.html#tabset-panel>\n\n\n\n```{=html}\n<iframe width=\"800\" height=\"300\" src=\"https://quarto.org/docs/interactive/layout.html#tabset-panel\" title=\"Webpage example\"></iframe>\n```\n\n\n\nIf you are reading the source code file, the next line contains `:::`, which closes the tabsets. \n:::\n\n\n## Where are we?\n\n<br>\n<br>\n\n![](/img_slides/flowchart_511_continuous.png){fig-align=\"center\"}\n\n## Where are we? Continuous outcome zoomed in\n\n<br>\n<br>\n\n![](/img_slides/flowchart_only_continuous.jpg){fig-align=\"center\"}\n\n\n## Where are we?\n\n::: {style=\"font-size: 90%;\"}\nCI's and hypothesis tests for different scenarios:\n\n$$\\text{point estimate} \\pm z^*(or~t^*)\\cdot SE,~~\\text{test stat} = \\frac{\\text{point estimate}-\\text{null value}}{SE}$$\n\nDay | Book | Population <br> parameter | Symbol | Point estimate | Symbol | SE\n--|--|--|--|--|--|--\n10 | 5.1 | Pop mean | $\\mu$ | Sample mean | $\\bar{x}$ | $\\frac{s}{\\sqrt{n}}$\n10 | 5.2 | Pop mean of paired diff | $\\mu_d$ or $\\delta$ | Sample mean of paired diff | $\\bar{x}_{d}$  | **$\\frac{s_d}{\\sqrt{n}}$**\n11 | 5.3 | [Diff in pop <br> means]{style=\"color:green\"} | [$\\mu_1-\\mu_2$]{style=\"color:green\"} | [Diff in sample <br> means]{style=\"color:green\"} | [$\\bar{x}_1 - \\bar{x}_2$]{style=\"color:green\"}  | [**???**]{style=\"color:red\"}\n12 | 8.1 | Pop proportion | $p$ | Sample prop | $\\widehat{p}$  |\n12 | 8.2 | Diff in pop <br> proportions | $p_1-p_2$ | Diff in sample <br> proportions | $\\widehat{p}_1-\\widehat{p}_2$ |\n\n:::\n\n\n## Goals for today \n\n### 2-sample t-test (Section 5.3)\n\n* Statistical inference for difference in means from 2 independent samples\n    1. What are $H_0$ and $H_a$?\n    \n    1. What is the SE for $\\bar{x}_1 - \\bar{x}_2$?\n    \n    1. Hypothesis test\n    \n    1. Confidence Interval\n    \n    1. Run test in R - using long vs. wide data\n    \n    1. Satterthwaite's df\n    \n    1. Pooled SD\n\n### Power and sample size (4.3.4, 5.4, plus notes)\n\n* Critical values & rejection region\n* Type I & II errors\n* Power\n* How to calculate sample size needed for a study?\n\n\n## Examples of designs with two independent samples\n\n* Any study where participants are randomized to a control and treatment group\n\n* Study where create two groups based on whether they were exposed or not to some condition (can be observational)\n\n*  Book: \"Does treatment using embryonic stem cells (ESCs) help improve heart function following a heart attack?\"\n\n*  Book: \"Is there evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who do not smoke?\"\n\n\n* _The key is that the data from the two groups are independent of each other._\n\n\n## Steps in a Hypothesis Test\n\n1. Set the __[level of significance]{style=\"color:darkorange\"}__ $\\alpha$\n\n1. Specify the __[null]{style=\"color:darkorange\"}__ ( $H_0$ ) and __[alternative]{style=\"color:darkorange\"}__ ( $H_A$ ) __[hypotheses]{style=\"color:darkorange\"}__\n    1. In symbols\n    1. In words\n    1. Alternative: one- or two-sided?\n\n1. Calculate the __[test statistic]{style=\"color:darkorange\"}__. \n\n1. Calculate the __[p-value]{style=\"color:darkorange\"}__ based on the observed test statistic and its sampling distribution\n\n1. Write a __[conclusion]{style=\"color:darkorange\"}__ to the hypothesis test\n    1. Do we reject or fail to reject $H_0$?\n    1. Write a conclusion in the context of the problem\n\n\n## Does caffeine increase finger taps/min (on average)?\n\n__Study Design__:\n\n::: {style=\"font-size: 85%;\"}\n* 20 male college students students were trained to tap their fingers at a rapid rate.\n* Each then drank 2 cups of coffee (double-blind)\n    * __Control__ group: decaf\n    * __Caffeine__ group: ~ 200 mg caffeine \n* After 2 hours, students were tested.\n* __Taps/minute__ recorded\n:::\n\n::: {style=\"font-size: 70%;\"}\nHand, David J.; Daly, Fergus; McConway, K.; Lunn, D. and Ostrowski, E. (1993). [A handbook of small data sets](https://www.crcpress.com/A-Handbook-of-Small-Data-Sets/Hand-Daly-McConway-Lunn-Ostrowski/p/book/9780412399206). London, U.K.: Chapman and Hall.\n:::\n\n::: {style=\"font-size: 85%;\"}\n* Load the data from the csv file `CaffeineTaps.csv`\n* The code below is for when the data file is in a folder called `data` that is in your R project folder (your working directory)\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCaffTaps <- read_csv(here::here(\"data\", \"CaffeineTaps.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 20 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Group\ndbl (1): Taps\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nglimpse(CaffTaps)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 20\nColumns: 2\n$ Taps  <dbl> 246, 248, 250, 252, 248, 250, 246, 248, 245, 250, 242, 245, 244,…\n$ Group <chr> \"Caffeine\", \"Caffeine\", \"Caffeine\", \"Caffeine\", \"Caffeine\", \"Caf…\n```\n:::\n:::\n\n\n\n\n\n## EDA: Explore the finger taps data\n::: columns\n::: {.column width=\"47%\"}\nDotplot of taps/minute stratified by group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CaffTaps, aes(x=Taps)) +\n  geom_dotplot() +\n  facet_wrap(vars(Group), ncol=1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"53%\"}\n\nSummary statistics stratified by group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get_summary_stats() from rstatix package\nsumstats <- CaffTaps %>% \n  group_by(Group) %>% \n  get_summary_stats(type = \"mean_sd\") \nsumstats %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mecfuynzio\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mecfuynzio table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mecfuynzio thead, #mecfuynzio tbody, #mecfuynzio tfoot, #mecfuynzio tr, #mecfuynzio td, #mecfuynzio th {\n  border-style: none;\n}\n\n#mecfuynzio p {\n  margin: 0;\n  padding: 0;\n}\n\n#mecfuynzio .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mecfuynzio .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mecfuynzio .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mecfuynzio .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mecfuynzio .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mecfuynzio .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mecfuynzio .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mecfuynzio .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mecfuynzio .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mecfuynzio .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mecfuynzio .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mecfuynzio .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mecfuynzio .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mecfuynzio .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mecfuynzio .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mecfuynzio .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mecfuynzio .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mecfuynzio .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mecfuynzio .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mecfuynzio .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mecfuynzio .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mecfuynzio .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mecfuynzio .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mecfuynzio .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mecfuynzio .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mecfuynzio .gt_left {\n  text-align: left;\n}\n\n#mecfuynzio .gt_center {\n  text-align: center;\n}\n\n#mecfuynzio .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mecfuynzio .gt_font_normal {\n  font-weight: normal;\n}\n\n#mecfuynzio .gt_font_bold {\n  font-weight: bold;\n}\n\n#mecfuynzio .gt_font_italic {\n  font-style: italic;\n}\n\n#mecfuynzio .gt_super {\n  font-size: 65%;\n}\n\n#mecfuynzio .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mecfuynzio .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mecfuynzio .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mecfuynzio .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mecfuynzio .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mecfuynzio .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mecfuynzio .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mecfuynzio .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mecfuynzio div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">Caffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.214</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">NoCaffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.394</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\ndiff(sumstats$mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -3.5\n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n## Step 2: Null & Alternative Hypotheses \n\n* __Question__: Is there evidence to support that drinking caffeine increases the number of finger taps/min?\n\n::: columns\n::: {.column width=\"60%\"}\nNull and alternative hypotheses in __words__\n\n*Include as much context as possible*\n\n<br>\n\n* $H_0$: The population difference in mean finger taps/min between the caffeine and control groups is ... \n\n* $H_A$: The population difference in mean finger taps/min between the caffeine and control groups is ...\n:::\n\n::: {.column width=\"40%\"}\nNull and alternative hypotheses in __symbols__\n\n\\begin{align}\nH_0:& \\mu_{caff} - \\mu_{ctrl} = \\\\\nH_A:& \\mu_{caff} - \\mu_{ctrl} \\\\\n\\end{align}\n:::\n:::\n\n\n\n## Step 3: Test statistic (part 1)\n\nRecall that in general the test statistic has the form:\n\n\n$$\\text{test stat} = \\frac{\\text{point estimate}-\\text{null value}}{SE}$$\nThus, for a two sample independent means test, we have:\n\n$$\\text{test statistic} = \\frac{\\bar{x}_1 - \\bar{x}_2 - 0}{SE_{\\bar{x}_1 - \\bar{x}_2}}$$\n\n* What is the formula for $SE_{\\bar{x}_1 - \\bar{x}_2}$?\n* What is the probability distribution of the test statistic?\n* What assumptions need to be satisfied?\n\n\n\n\n## What distribution does $\\bar{X}_1 - \\bar{X}_2$ have?\n::: columns\n::: {.column width=\"50%\"}\nLet $\\bar{X}_1$ and $\\bar{X}_2$ be the means of random samples from two independent groups, with parameters shown in table:\n:::\n\n::: {.column width=\"50%\"}\n|             | Group 1    | Group 2    |\n|-------------|------------|------------|\n| sample size | $n_1$      | $n_2$      |\n| pop mean    | $\\mu_1$    | $\\mu_2$    |\n| pop sd      | $\\sigma_1$ | $\\sigma_2$ |\n:::\n:::\n\n::: {style=\"font-size: 90%;\"}\nSome theoretical statistics:\n\n* If $\\bar{X}_1$ and $\\bar{X}_2$ are independent normal r.v.'s, then $\\bar{X}_1 - \\bar{X}_2$ is also normal\n* What is the mean of $\\bar{X}_1 - \\bar{X}_2$? \n\n$$E[\\bar{X}_1 - \\bar{X}_2] = E[\\bar{X}_1] - E[\\bar{X}_2] = \\mu_1-\\mu_2$$\n\n* What is the standard deviation of $\\bar{X}_1 - \\bar{X}_2$?\n\n\\begin{align}\nVar(\\bar{X}_1 - \\bar{X}_2) &= Var(\\bar{X}_1) + Var(\\bar{X}_2) = \\frac{\\sigma_1^2}{n_1}+\\frac{\\sigma_2^2}{n_2} \\\\\nSD(\\bar{X}_1 - \\bar{X}_2) &= \\sqrt{\\frac{\\sigma_1^2}{n_1}+\\frac{\\sigma_2^2}{n_2}}\n\\end{align}\n\n:::\n\n\n## Step 3: Test statistic (part 2)\n\n::: {style=\"font-size: 90%;\"}\n::: columns\n::: {.column width=\"50%\"}\n$$\nt_{\\bar{x}_1 - \\bar{x}_2} = \\frac{\\bar{x}_1 - \\bar{x}_2 - 0}{\\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}\n$$\n\n:::\n\n::: {.column width=\"50%\"}\n* $\\bar{x}_1, \\bar{x}_2$ are the sample means\n* $\\mu_0=0$ is the mean value specified in $H_0$\n* $s_1, s_2$ are the sample SD's\n* $n_1, n_2$ are the sample sizes\n\n:::\n:::\n\n\n* Statistical theory tells us that $t_{\\bar{x}_1 - \\bar{x}_2}$ follows a __student's t-distribution__ with \n    * $df \\approx$ smaller of $n_1-1$ and $n_2-1$\n    * this is a conservative estimate (smaller than actual $df$ )\n\n__Assumptions__:\n\n* __Independent observations & samples__\n    * The observations were collected independently. \n    * In particular, the observations from the two groups were not paired in any meaningful way.\n* __Approximately normal samples or big n's__ \n    * The distributions of the samples should be approximately normal \n    * _or_ _both_ their sample sizes should be at least 30.\n:::\n\n\n\n## Step 3: Test statistic (part 3)\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"zskwhnmeto\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zskwhnmeto table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zskwhnmeto thead, #zskwhnmeto tbody, #zskwhnmeto tfoot, #zskwhnmeto tr, #zskwhnmeto td, #zskwhnmeto th {\n  border-style: none;\n}\n\n#zskwhnmeto p {\n  margin: 0;\n  padding: 0;\n}\n\n#zskwhnmeto .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zskwhnmeto .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zskwhnmeto .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zskwhnmeto .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zskwhnmeto .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zskwhnmeto .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zskwhnmeto .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zskwhnmeto .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zskwhnmeto .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zskwhnmeto .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zskwhnmeto .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zskwhnmeto .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zskwhnmeto .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zskwhnmeto .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zskwhnmeto .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskwhnmeto .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zskwhnmeto .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zskwhnmeto .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zskwhnmeto .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskwhnmeto .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zskwhnmeto .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskwhnmeto .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zskwhnmeto .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskwhnmeto .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zskwhnmeto .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskwhnmeto .gt_left {\n  text-align: left;\n}\n\n#zskwhnmeto .gt_center {\n  text-align: center;\n}\n\n#zskwhnmeto .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zskwhnmeto .gt_font_normal {\n  font-weight: normal;\n}\n\n#zskwhnmeto .gt_font_bold {\n  font-weight: bold;\n}\n\n#zskwhnmeto .gt_font_italic {\n  font-style: italic;\n}\n\n#zskwhnmeto .gt_super {\n  font-size: 65%;\n}\n\n#zskwhnmeto .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zskwhnmeto .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zskwhnmeto .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zskwhnmeto .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zskwhnmeto .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zskwhnmeto .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zskwhnmeto .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zskwhnmeto .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zskwhnmeto div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">Caffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.214</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">NoCaffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.394</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n$$\n\\text{test statistic} = t_{\\bar{x}_1 - \\bar{x}_2} = \\frac{\\bar{x}_1 - \\bar{x}_2 - 0}{\\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}\n$$\n\n:::\n::: {.column width=\"60%\"}\n\n\n\n\n\n\n\n:::\n:::\n\n<br>\n\n<br>\n\n<hr>\n\nBased on the value of the test statistic, do you think we are going to reject or fail to reject $H_0$?\n\n\n\n## Step \"3b\": Assumptions satisfied?\n::: columns\n::: {.column width=\"50%\"}\n__Assumptions__:\n\n* __Independent observations & samples__\n    * The observations were collected independently. \n    * In particular, the observations from the two groups were not paired in any meaningful way.\n\n* __Approximately normal samples or big n's__ \n    * The distributions of the samples should be approximately normal \n    * _or_ _both_ their sample sizes should be at least 30.\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n\n\n## Step 4: p-value\n\nThe __[p-value]{style=\"color:darkorange\"}__ is the __probability__ of obtaining a test statistic _just as extreme or more extreme_ than the observed test statistic assuming the null hypothesis $H_0$ is true. \n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\nCalculate the _p_-value:\n\n\n\n\n\n\n\n:::\n:::\n\n\n\n## Step 5: Conclusion to hypothesis test\n\n\\begin{align}\nH_0:& \\mu_{caff} - \\mu_{ctrl} = 0\\\\\nH_A:& \\mu_{caff} - \\mu_{ctrl} > 0\\\\\n\\end{align}\n\n* Recall the $p$-value = 0.00397\n* Use $\\alpha$ = 0.05.\n* Do we reject or fail to reject $H_0$?\n\n__Conclusion statement__:\n\n* Stats class conclusion\n    * There is sufficient evidence that the (population) difference in mean finger taps/min with vs. without caffeine is greater than 0 ( $p$-value = 0.004).\n\n* More realistic manuscript conclusion: \n    * The mean finger taps/min were 244.8 (SD = 2.4) and 248.3 (SD = 2.2) for the control and caffeine groups, and the increase of 3.5 taps/min was statistically discrenible ( $p$-value = 0.004).\n\n\n## 95% CI for the mean difference in cholesterol levels\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"yqfheibtzd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yqfheibtzd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yqfheibtzd thead, #yqfheibtzd tbody, #yqfheibtzd tfoot, #yqfheibtzd tr, #yqfheibtzd td, #yqfheibtzd th {\n  border-style: none;\n}\n\n#yqfheibtzd p {\n  margin: 0;\n  padding: 0;\n}\n\n#yqfheibtzd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yqfheibtzd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yqfheibtzd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yqfheibtzd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yqfheibtzd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yqfheibtzd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yqfheibtzd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yqfheibtzd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yqfheibtzd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yqfheibtzd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yqfheibtzd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yqfheibtzd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yqfheibtzd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yqfheibtzd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yqfheibtzd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yqfheibtzd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yqfheibtzd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yqfheibtzd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yqfheibtzd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yqfheibtzd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yqfheibtzd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yqfheibtzd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yqfheibtzd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yqfheibtzd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yqfheibtzd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yqfheibtzd .gt_left {\n  text-align: left;\n}\n\n#yqfheibtzd .gt_center {\n  text-align: center;\n}\n\n#yqfheibtzd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yqfheibtzd .gt_font_normal {\n  font-weight: normal;\n}\n\n#yqfheibtzd .gt_font_bold {\n  font-weight: bold;\n}\n\n#yqfheibtzd .gt_font_italic {\n  font-style: italic;\n}\n\n#yqfheibtzd .gt_super {\n  font-size: 65%;\n}\n\n#yqfheibtzd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yqfheibtzd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yqfheibtzd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yqfheibtzd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yqfheibtzd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yqfheibtzd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yqfheibtzd .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yqfheibtzd .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yqfheibtzd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">Caffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.214</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">NoCaffeine</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Taps</td>\n<td headers=\"n\" class=\"gt_row gt_right\">10</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.394</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n::: columns\n::: {.column width=\"50%\"}\nCI for $\\mu_{caff} - \\mu_{ctrl}$:\n\n$$\\bar{x}_{caff} - \\bar{x}_{ctrl} \\pm t^* \\cdot \\sqrt{\\frac{s_{caff}^2}{n_{caff}}+\\frac{s_{ctrl}^2}{n_{ctrl}}}$$\n\n:::\n\n::: {.column width=\"50%\"}\n\n:::\n:::\n\n<br>\n<br>\n<br>\n\n::: {style=\"font-size: 90%;\"}\n__Interpretation__:  \nWe are 95% confident that the (population) difference in mean finger taps/min between the caffeine and control groups is between 1.167 mg/dL and 5.833 mg/dL.\n\n* _Based on the CI, is there evidence that drinking caffeine made a difference in finger taps/min? Why or why not?_\n:::\n\n\n\n## R: 2-sample t-test (with long data)\n\n* The `CaffTaps` data are in a *long* format, meaning that \n    * all of the outcome values are in one column and \n    * another column indicates which group the values are from\n* This is a common format for data from multiple samples, especially if the sample sizes are different.\n\n<!-- Using the caffeine induced finger tapping example with $H_A: \\mu_{caff} - \\mu_{ctrl} > 0$: -->\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(Taps_2ttest <- t.test(formula = Taps ~ Group, \n                       alternative = \"greater\", \n                       data = CaffTaps))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  Taps by Group\nt = 3.3942, df = 17.89, p-value = 0.001628\nalternative hypothesis: true difference in means between group Caffeine and group NoCaffeine is greater than 0\n95 percent confidence interval:\n 1.711272      Inf\nsample estimates:\n  mean in group Caffeine mean in group NoCaffeine \n                   248.3                    244.8 \n```\n:::\n:::\n\n\n\n<!-- * The test output gives the 1-sided 95% CI since we ran a 1-sided test -->\n\n\n\n## `tidy` the `t.test` output\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use tidy command from broom package for briefer output that's a tibble\ntidy(Taps_2ttest) %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"jajxyktkxb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jajxyktkxb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jajxyktkxb thead, #jajxyktkxb tbody, #jajxyktkxb tfoot, #jajxyktkxb tr, #jajxyktkxb td, #jajxyktkxb th {\n  border-style: none;\n}\n\n#jajxyktkxb p {\n  margin: 0;\n  padding: 0;\n}\n\n#jajxyktkxb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jajxyktkxb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jajxyktkxb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jajxyktkxb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jajxyktkxb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jajxyktkxb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jajxyktkxb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jajxyktkxb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jajxyktkxb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jajxyktkxb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jajxyktkxb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jajxyktkxb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jajxyktkxb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jajxyktkxb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jajxyktkxb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jajxyktkxb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jajxyktkxb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jajxyktkxb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jajxyktkxb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jajxyktkxb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jajxyktkxb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jajxyktkxb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jajxyktkxb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jajxyktkxb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jajxyktkxb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jajxyktkxb .gt_left {\n  text-align: left;\n}\n\n#jajxyktkxb .gt_center {\n  text-align: center;\n}\n\n#jajxyktkxb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jajxyktkxb .gt_font_normal {\n  font-weight: normal;\n}\n\n#jajxyktkxb .gt_font_bold {\n  font-weight: bold;\n}\n\n#jajxyktkxb .gt_font_italic {\n  font-style: italic;\n}\n\n#jajxyktkxb .gt_super {\n  font-size: 65%;\n}\n\n#jajxyktkxb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jajxyktkxb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jajxyktkxb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jajxyktkxb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jajxyktkxb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jajxyktkxb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jajxyktkxb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jajxyktkxb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jajxyktkxb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate1\">estimate1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate2\">estimate2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"estimate1\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"estimate2\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">3.394168</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.001627703</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">17.89012</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">1.711272</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">Inf</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Welch Two Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">greater</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n* Pull the p-value:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(Taps_2ttest)$p.value  # we can pull specific values from the tidy output\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.001627703\n```\n:::\n:::\n\n\n\n\n## R: 2-sample t-test (with wide data)\n\n<!-- Using the caffeine induced finger tapping example with $H_A: \\mu_{caff} - \\mu_{ctrl} > 0$: -->\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make CaffTaps data wide: pivot_wider needs an ID column so that it \n# knows how to \"match\" values from the Caffeine and NoCaffeine groups\nCaffTaps_wide <- CaffTaps %>% \n  mutate(id = rep(1:10, 2)) %>% #  \"fake\" IDs for pivot_wider step\n  pivot_wider(names_from = \"Group\",\n              values_from = \"Taps\")\n\nglimpse(CaffTaps_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 10\nColumns: 3\n$ id         <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\n$ Caffeine   <dbl> 246, 248, 250, 252, 248, 250, 246, 248, 245, 250\n$ NoCaffeine <dbl> 242, 245, 244, 248, 247, 248, 242, 244, 246, 242\n```\n:::\n\n```{.r .cell-code}\nt.test(x = CaffTaps_wide$Caffeine, y = CaffTaps_wide$NoCaffeine, alternative = \"greater\") %>% \n  tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"fkcopadtpi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fkcopadtpi table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fkcopadtpi thead, #fkcopadtpi tbody, #fkcopadtpi tfoot, #fkcopadtpi tr, #fkcopadtpi td, #fkcopadtpi th {\n  border-style: none;\n}\n\n#fkcopadtpi p {\n  margin: 0;\n  padding: 0;\n}\n\n#fkcopadtpi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fkcopadtpi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fkcopadtpi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fkcopadtpi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fkcopadtpi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fkcopadtpi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fkcopadtpi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fkcopadtpi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fkcopadtpi .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fkcopadtpi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fkcopadtpi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fkcopadtpi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fkcopadtpi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fkcopadtpi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fkcopadtpi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fkcopadtpi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fkcopadtpi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fkcopadtpi .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fkcopadtpi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fkcopadtpi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fkcopadtpi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fkcopadtpi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fkcopadtpi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fkcopadtpi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fkcopadtpi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fkcopadtpi .gt_left {\n  text-align: left;\n}\n\n#fkcopadtpi .gt_center {\n  text-align: center;\n}\n\n#fkcopadtpi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fkcopadtpi .gt_font_normal {\n  font-weight: normal;\n}\n\n#fkcopadtpi .gt_font_bold {\n  font-weight: bold;\n}\n\n#fkcopadtpi .gt_font_italic {\n  font-style: italic;\n}\n\n#fkcopadtpi .gt_super {\n  font-size: 65%;\n}\n\n#fkcopadtpi .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fkcopadtpi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fkcopadtpi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fkcopadtpi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fkcopadtpi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fkcopadtpi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fkcopadtpi .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fkcopadtpi .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fkcopadtpi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate1\">estimate1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate2\">estimate2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"estimate1\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"estimate2\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">3.394168</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.001627703</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">17.89012</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">1.711272</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">Inf</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Welch Two Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">greater</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n## Why are the df's in the R output different?\n\nFrom many slides ago:\n\n* Statistical theory tells us that $t_{\\bar{x}_1 - \\bar{x}_2}$ follows a __student's t-distribution__ with \n    * $df \\approx$ smaller of $n_1-1$ and $n_2-1$\n    * this is a __conservative__ estimate (smaller than actual $df$ )\n\nThe actual degrees of freedom are calculated using  Satterthwaite's method:\n\n$$\\nu = \\frac{[ (s_1^2/n_1) + (s_2^2/n_2) ]^2}\n{(s_1^2/n_1)^2/(n_1 - 1) + (s_2^2/n_2)^2/(n_2-1) }\n= \\frac{ [ SE_1^2 + SE_2^2 ]^2}{ SE_1^4/df_1 + SE_2^4/df_2 }$$\n\n<hr>\n\nVerify the _p_-value in the R output using $\\nu$ = 17.89012:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npt(3.3942, df = 17.89012, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.001627588\n```\n:::\n:::\n\n\n\n\n## Pooled standard deviation estimate {.smaller}\n\n* Sometimes we have reasons to believe that the population SD's from the two groups are equal, such as when randomizing participants to two groups\n\n::: columns\n::: {.column width=\"60%\"}\n* In this case we can use a __pooled SD__:\n\n$$s_{pooled}^2 = \\frac{s_1^2 (n_1-1) + s_2^2 (n_2-1)}{n_1 + n_2 - 2}$$\n:::\n\n::: {.column width=\"40%\"}\n* $n_1$, $n_2$ are the sample sizes, and\n* $s_1$, $s_2$ are the sample standard deviations \n* of the two groups \n:::\n:::\n\n* We use the pooled SD instead of $s_1^2$ and $s_2^2$ when calculating the standard error \n\n$$SE = \\sqrt{\\frac{s_{pooled}^2}{n_1} + \\frac{s_{pooled}^2}{n_2}}= s_{pooled}\\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}$$\n\n::: columns\n::: {.column width=\"50%\"}\n\n__Test statistic__ with pooled SD:\n\n$$t_{\\bar{x}_1 - \\bar{x}_2} = \\frac{\\bar{x}_1 - \\bar{x}_2 -0}{s_{pooled}\\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}}$$\n\n:::\n\n::: {.column width=\"50%\"}\n__CI__  with pooled SD:\n\n$$(\\bar{x}_1 - \\bar{x}_2) \\pm t^{\\star} \\cdot s_{pooled} \\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}$$\n:::\n:::\n\n* The $t$ distribution degrees of freedom are now:\n\n$$df = (n_1 - 1) + (n_2 - 1) = n_1 + n_2 - 2.$$\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n## R: 2-sample t-test with pooled SD \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# t-test with pooled SD\nt.test(formula = Taps ~ Group, \n       alternative = \"greater\", \n       var.equal = TRUE,  # pooled SD \n       data = CaffTaps) %>% \n  tidy() %>% \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ybwppxvyco\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ybwppxvyco table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ybwppxvyco thead, #ybwppxvyco tbody, #ybwppxvyco tfoot, #ybwppxvyco tr, #ybwppxvyco td, #ybwppxvyco th {\n  border-style: none;\n}\n\n#ybwppxvyco p {\n  margin: 0;\n  padding: 0;\n}\n\n#ybwppxvyco .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ybwppxvyco .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ybwppxvyco .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ybwppxvyco .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ybwppxvyco .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ybwppxvyco .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ybwppxvyco .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ybwppxvyco .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ybwppxvyco .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ybwppxvyco .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ybwppxvyco .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ybwppxvyco .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ybwppxvyco .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ybwppxvyco .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ybwppxvyco .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ybwppxvyco .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ybwppxvyco .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ybwppxvyco .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ybwppxvyco .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ybwppxvyco .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ybwppxvyco .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ybwppxvyco .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ybwppxvyco .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ybwppxvyco .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ybwppxvyco .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ybwppxvyco .gt_left {\n  text-align: left;\n}\n\n#ybwppxvyco .gt_center {\n  text-align: center;\n}\n\n#ybwppxvyco .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ybwppxvyco .gt_font_normal {\n  font-weight: normal;\n}\n\n#ybwppxvyco .gt_font_bold {\n  font-weight: bold;\n}\n\n#ybwppxvyco .gt_font_italic {\n  font-style: italic;\n}\n\n#ybwppxvyco .gt_super {\n  font-size: 65%;\n}\n\n#ybwppxvyco .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ybwppxvyco .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ybwppxvyco .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ybwppxvyco .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ybwppxvyco .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ybwppxvyco .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ybwppxvyco .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ybwppxvyco .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ybwppxvyco div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate1\">estimate1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate2\">estimate2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"estimate1\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"estimate2\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">3.394168</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.001616497</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">18</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">1.711867</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">Inf</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Two Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">greater</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\n# t-test without pooled SD\nt.test(formula = Taps ~ Group, \n       alternative = \"greater\", \n       var.equal = FALSE,  # default, NOT pooled SD \n       data = CaffTaps) %>% \n  tidy() %>% \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"zcwalwlqbq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zcwalwlqbq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zcwalwlqbq thead, #zcwalwlqbq tbody, #zcwalwlqbq tfoot, #zcwalwlqbq tr, #zcwalwlqbq td, #zcwalwlqbq th {\n  border-style: none;\n}\n\n#zcwalwlqbq p {\n  margin: 0;\n  padding: 0;\n}\n\n#zcwalwlqbq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zcwalwlqbq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zcwalwlqbq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zcwalwlqbq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zcwalwlqbq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zcwalwlqbq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zcwalwlqbq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zcwalwlqbq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zcwalwlqbq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zcwalwlqbq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zcwalwlqbq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zcwalwlqbq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zcwalwlqbq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zcwalwlqbq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zcwalwlqbq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zcwalwlqbq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zcwalwlqbq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zcwalwlqbq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zcwalwlqbq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zcwalwlqbq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zcwalwlqbq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zcwalwlqbq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zcwalwlqbq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zcwalwlqbq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zcwalwlqbq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zcwalwlqbq .gt_left {\n  text-align: left;\n}\n\n#zcwalwlqbq .gt_center {\n  text-align: center;\n}\n\n#zcwalwlqbq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zcwalwlqbq .gt_font_normal {\n  font-weight: normal;\n}\n\n#zcwalwlqbq .gt_font_bold {\n  font-weight: bold;\n}\n\n#zcwalwlqbq .gt_font_italic {\n  font-style: italic;\n}\n\n#zcwalwlqbq .gt_super {\n  font-size: 65%;\n}\n\n#zcwalwlqbq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zcwalwlqbq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zcwalwlqbq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zcwalwlqbq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zcwalwlqbq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zcwalwlqbq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zcwalwlqbq .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zcwalwlqbq .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zcwalwlqbq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate1\">estimate1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate2\">estimate2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"estimate1\" class=\"gt_row gt_right\">248.3</td>\n<td headers=\"estimate2\" class=\"gt_row gt_right\">244.8</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">3.394168</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.001627703</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">17.89012</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">1.711272</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">Inf</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Welch Two Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">greater</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nSimilar output in this case - why??\n\n\n\n\n## What's next? \n\n::: {style=\"font-size: 90%;\"}\nCI's and hypothesis tests for different scenarios:\n\n$$\\text{point estimate} \\pm z^*(or~t^*)\\cdot SE,~~\\text{test stat} = \\frac{\\text{point estimate}-\\text{null value}}{SE}$$\n\nDay | Book | Population <br> parameter | Symbol | Point estimate | Symbol | SE\n--|--|--|--|--|--|--\n10 | 5.1 | Pop mean | $\\mu$ | Sample mean | $\\bar{x}$ | $\\frac{s}{\\sqrt{n}}$\n10 | 5.2 | Pop mean of paired diff | $\\mu_d$ or $\\delta$ | Sample mean of paired diff | $\\bar{x}_{d}$  | **$\\frac{s_d}{\\sqrt{n}}$**\n11 | 5.3 | [Diff in pop <br> means]{style=\"color:green\"} | [$\\mu_1-\\mu_2$]{style=\"color:green\"} | [Diff in sample <br> means]{style=\"color:green\"} | [$\\bar{x}_1 - \\bar{x}_2$]{style=\"color:green\"}  | [**$\\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}$ or pooled**]{style=\"color:red\"}\n12 | 8.1 | [Pop proportion]{style=\"color:darkblue\"} | [$p$]{style=\"color:darkblue\"} | [Sample prop]{style=\"color:darkblue\"} | [$\\widehat{p}$]{style=\"color:darkblue\"}  | [**???**]{style=\"color:red\"}\n12 | 8.2 | [Diff in pop <br> proportions]{style=\"color:darkblue\"} | [$p_1-p_2$]{style=\"color:darkblue\"} | [Diff in sample <br> proportions]{style=\"color:darkblue\"} | [$\\widehat{p}_1-\\widehat{p}_2$]{style=\"color:darkblue\"} | [**???**]{style=\"color:red\"}\n\n:::\n\n\n# Power and sample size calculations\n\n* Critical values & rejection region\n\n* Type I & II errors\n\n* Power\n\n* How to calculate sample size needed for a study?\n\n<hr>\n\n* Materials are from \n    * __Section 4.3.4__ Decision errors\n    * __Section 5.4__ Power calculations for a difference of means\n    * plus notes\n\n\n\n## Critical values \n\n::: {style=\"font-size: 90%;\"}\n\n* __Critical values__ are the cutoff values that determine whether a test statistic is statistically significant or not.\n* If a test statistic is greater in absolute value than the critical value, we reject $H_0$\n\n::: columns\n::: {.column width=\"49%\"}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n\n::: {.column width=\"49%\"}\n\n* Critical values are determined by \n    * the significance level $\\alpha$, \n    * whether a test is 1- or 2-sided, &\n    * the probability distribution being used to calculate the p-value (such as normal or t-distribution).\n* The critical values in the figure should look very familiar! \n    * Where have we used these before?\n\n:::\n:::\n<br>\n\n* How can we calculate the critical values using R?\n:::\n\n\n## Rejection region\n\n* If the absolute value of the test statistic is greater than the critical value, we reject $H_0$\n    * In this case the test statistic is in the __rejection region__.\n    * Otherwise it's in the nonrejection region.\n\n::: columns\n::: {.column width=\"60%\"}\n\n![[Stats & Geospatial Analysis](https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Introduction-to-Hypothesis-Testing/Critical-Value-and-the-p-Value-Approach/index.html)](/img_slides/RejectionRegion.png){fig-align=\"center\"}\n\n:::\n::: {.column width=\"40%\"}\n\n* What do rejection regions look like for 1-sided tests?\n\n:::\n:::\n\n\n# Hypothesis Testing \"Errors\" \n\n![[StatisticsSolutions](https://www.statisticssolutions.com/to-err-is-human-what-are-type-i-and-ii-errors/)](/img_slides/rachnovblog-768x310.jpg){fig-align=\"center\"}\n\n\n## Justice system analogy \n\n<br><br>\n\n![[Type I and Type II Errors - Making Mistakes in the Justice System](http://www.intuitor.com/statistics/T1T2Errors.html)](/img_slides/intuitor_charts.png){fig-align=\"center\"}\n\n\n## Type I & II Errors\n\n::: columns\n::: {.column width=\"40%\"}\n\n![](/img_slides/type-i-and-type-ii-errors_chart.png){fig-align=\"center\"}\n\n::: {style=\"font-size: 90%;\"}\n\n* [$\\alpha$]{style=\"color:violet\"} = probability of making a [__Type I error__]{style=\"color:violet\"}\n    * This is the significance level (usually 0.05)\n    * Set before study starts\n* [$\\beta$]{style=\"color:green\"} = probability of making a [__Type II error__]{style=\"color:green\"}\n* Ideally we want\n    * small Type I & II errors and\n    * big power\n\n::: \n:::\n\n::: {.column width=\"60%\"}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n\n::: {style=\"font-size: 90%;\"}\nApplet for visualizing Type I & II errors and power: \n<https://rpsychologist.com/d3/NHST/>\n\n:::\n\n:::\n:::\n\n\n## Relationship between Type I & II errors \n\n* __Type I vs. Type II error__\n    * Decreasing P(Type I error) leads to \n        * increasing P(Type II error)\n    * We typically keep P(Type I error) = $\\alpha$ set to 0.05\n        \nFrom the applet at <https://rpsychologist.com/d3/NHST/>\n\n::: columns\n::: {.column width=\"50%\"}\n\n![](/img_slides/power_applet_screenshot_alpha05.png){fig-align=\"center\"}\n\n:::\n\n::: {.column width=\"50%\"}\n\n![](/img_slides/power_applet_screenshot_alpha01.png){fig-align=\"center\"}\n:::\n:::\n\n\n## Relationship between Type II errors and power\n\n<center>__Power__ = P(correctly rejecting the null hypothesis)</center>\n\n<br>\n\n::: columns\n::: {.column width=\"49%\"}\n\n* Power is also called the\n    * true positive rate,\n    * probability of detection, or \n    * the _sensitivity_ of a test\n    \n![](/img_slides/power_applet_screenshot_alpha05.png){fig-align=\"center\"}\n\n:::\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"49%\"}\n\n* __Power vs. Type II error__\n\n    * Power = 1 - P(Type II error) = 1 - $\\beta$\n\n    * Thus as $\\beta$ = P(Type II error) decreases, the power increases\n\n    * P(Type II error) decreases as the mean of the alternative population shits further away from the mean of the null population (effect size gets bigger).\n\n    * Typically want at least 80% power; 90% power is good\n:::\n:::\n\n\n\n## Example calculating power\n\n::: {style=\"font-size: 90%;\"}\n\n* Suppose the mean of the null population is 0 ( $H_0: \\mu=0$ ) with standard error 1\n* Find the power of a 2-sided test if the actual $\\mu=3$, assuming the SE doesn't change.\n\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n* Power = $P($Reject $H_0$ when alternative pop is $N(3,1))$\n* When $\\alpha$ = 0.05, we reject $H_0$ when the test statistic z is at least 1.96\n* Thus for $X\\sim N(3,1)$ we need to calculate $P(X \\le -1.96) + P(X \\ge 1.96)$:\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# left tail + right tail:\npnorm(-1.96, mean=3, sd=1, lower.tail=TRUE) + pnorm(1.96, mean=3, sd=1, lower.tail=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8508304\n```\n:::\n:::\n\n\n\n:::\n\n::: {style=\"font-size: 70%;\"}\nThe left tail probability `pnorm(-1.96, mean=3, sd=1, lower.tail=TRUE)` is essentially 0 in this case.\n:::\n\n::: {style=\"font-size: 90%;\"}\n* Note that this power calculation specified the value of the SE instead of the standard deviation and sample size $n$ individually.\n:::\n\n\n## __Sample size__ calculation for testing one mean\n\n::: {style=\"font-size: 90%;\"}\n\n* Recall in our body temperature example that $\\mu_0=98.6$ °F and $\\bar{x}= 98.25$ °F. \n    * The _p_-value from the hypothesis test was highly significant (very small).\n    * What would the sample size $n$ need to be for 80% power?\n\n* [__Calculate $n$__]{style=\"color:green\"}, \n    * given $\\alpha$, power ( $1-\\beta$ ), \"true\" alternative mean $\\mu$, and null $\\mu_0$, \n    * _assuming_ the test statistic is normal (instead of t-distribution):\n\n::: columns\n::: {.column width=\"30%\"}\n\n$$n=\\left(s\\frac{z_{1-\\alpha/2}+z_{1-\\beta}}{\\mu-\\mu_0}\\right)^2$$\n:::\n\n::: {.column width=\"70%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 98.25\nmu0 <- 98.6\nsd <- 0.73\nalpha <- 0.05\nbeta <- 0.20\nn <- (sd*(qnorm(1-alpha/2) + qnorm(1-beta)) / (mu-mu0))^2\nn\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 34.14423\n```\n:::\n\n```{.r .cell-code}\nceiling(n)  # always round UP to the next highest integer \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 35\n```\n:::\n:::\n\n\n:::\n:::\n\n_We would only need a sample size of 35 for 80% power!_  \nHowever, this is an under-estimate since we used the normal instead of t-distribution.\n:::\n\n::: {style=\"font-size: 70%;\"}\nSee <http://powerandsamplesize.com/Calculators/Test-1-Mean/1-Sample-Equality>.\n:::\n\n\n## __Power__ calculation for testing one mean\n\n::: {style=\"font-size: 90%;\"}\nConversely, we can calculate how much power we had in our body temperature one-sample test, given the sample size of 130.\n\n* [__Calculate power__]{style=\"color:green\"}, \n    * given $\\alpha$, $n$, \"true\" alternative mean $\\mu$, and null $\\mu_0$, \n    * _assuming_ the test statistic is normal (instead of t-distribution)\n\n$$1-\\beta=\n\t\t\\Phi\\left(z-z_{1-\\alpha/2}\\right)+\\Phi\\left(-z-z_{1-\\alpha/2}\\right)\n\t\t\\quad ,\\quad \\text{where } z=\\frac{\\mu-\\mu_0}{s/\\sqrt{n}}$$\n\n$\\Phi$ is the probability for a standard normal distribution \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 98.25; mu0 <- 98.6; sd <- 0.73; alpha <- 0.05; n <- 130\n(z <- (mu-mu0) / (sd/sqrt(n)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -5.466595\n```\n:::\n\n```{.r .cell-code}\n(Power <- pnorm(z-qnorm(1-alpha/2)) + pnorm(-z-qnorm(1-alpha/2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9997731\n```\n:::\n:::\n\n\n\nIf the population mean is 98.2 instead of 98.6, we have a 99.98% chance of correctly rejecting $H_0$ when the sample size is 130.  \n\n:::\n\n\n## R package `pwr` for power analyses\n\n::: {style=\"font-size: 90%;\"}\n\n* Use `pwr.t.test` for both one- and two-sample t-tests.  \n* Specify all parameters _except for_ the one being solved for.\n\n`pwr.t.test(n = NULL, d = NULL, sig.level = 0.05, power = NULL,`   \n`type = c(\"two.sample\", \"one.sample\", \"paired\"),`  \n`alternative = c(\"two.sided\", \"less\", \"greater\"))`\n\n`d` is __Cohen's d__ effect size: small = 0.2, medium = 0.5, large = 0.8\n\n::: columns\n::: {.column width=\"49%\"}\nOne-sample test (or paired t-test):\n:::\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"49%\"}\n\n$$d = \\frac{\\mu-\\mu_0}{s}$$ \n\n:::\n:::\n\n::: columns\n::: {.column width=\"49%\"}\nTwo-sample test (independent):\n:::\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"49%\"}\n\n$$d = \\frac{\\bar{x}_1 - \\bar{x}_2}{s_{pooled}}$$\n\n:::\n:::\n\n:::\n\n::: {style=\"font-size: 80%;\"}\n* $\\bar{x}_1 - \\bar{x}_2$ is the difference in means between the two groups that one would want to be able to detect as being significant,\n* $s_{pooled}$ is the pooled SD between the two groups - often assume have same sd in each group\n\n\n* R package `pwr` for basic statistical tests\n    * <https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html>\n:::\n\n\n## `pwr`: __sample size__ for one mean test \n\n::: {style=\"font-size: 80%;\"}\n`pwr.t.test(n = NULL, d = NULL, sig.level = 0.05, power = NULL,`   \n`type = c(\"two.sample\", \"one.sample\", \"paired\"),` \n`alternative = c(\"two.sided\", \"less\", \"greater\"))`\n:::\n\n* `d` is __Cohen's d__ effect size: $d = \\frac{\\mu-\\mu_0}{s}$ \n\nSpecify all parameters _except for_ the sample size:\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pwr)\nt.n <- pwr.t.test(\n  d = (98.6-98.25)/0.73, \n  sig.level = 0.05, \n  power = 0.80, \n  type = \"one.sample\")\n\nt.n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     One-sample t test power calculation \n\n              n = 36.11196\n              d = 0.4794521\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(t.n)\n```\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-27-1.png){width=768}\n:::\n:::\n\n\n:::\n:::\n\n\n## `pwr`: __power__ for one mean test \n\n::: {style=\"font-size: 80%;\"}\n`pwr.t.test(n = NULL, d = NULL, sig.level = 0.05, power = NULL,`   \n`type = c(\"two.sample\", \"one.sample\", \"paired\"),` \n`alternative = c(\"two.sided\", \"less\", \"greater\"))`\n:::\n\n* `d` is __Cohen's d__ effect size: $d = \\frac{\\mu-\\mu_0}{s}$ \n\nSpecify all parameters _except for_ the power:\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.power <- pwr.t.test(\n  d = (98.6-98.25)/0.73, \n  sig.level = 0.05, \n  # power = 0.80, \n  n = 130,\n  type = \"one.sample\")\n\nt.power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     One-sample t test power calculation \n\n              n = 130\n              d = 0.4794521\n      sig.level = 0.05\n          power = 0.9997354\n    alternative = two.sided\n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(t.power)\n```\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-29-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n \n\n## `pwr`: Two-sample t-test: __sample size__\n\n::: {style=\"font-size: 70%;\"}\n`pwr.t.test(n = NULL, d = NULL, sig.level = 0.05, power = NULL,`   \n`type = c(\"two.sample\", \"one.sample\", \"paired\"),` \n`alternative = c(\"two.sided\", \"less\", \"greater\"))`\n:::\n\n::: {style=\"font-size: 85%;\"}\n\n* `d` is __Cohen's d__ effect size: $d = \\frac{\\bar{x}_1 - \\bar{x}_2}{s_{pooled}}$\n\n__Example__: Suppose the data collected for the caffeine taps study were pilot day for a larger study. Investigators want to know what sample size they would need to detect a 2 point difference between the two groups. Assume the SD in both groups is 2.3. \n\nSpecify all parameters _except for_ the sample size:\n:::\n\n::: {style=\"font-size: 90%;\"}\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt2.n <- pwr.t.test(\n  d = 2/2.3, \n  sig.level = 0.05, \n  power = 0.80, \n  type = \"two.sample\") \n\nt2.n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 21.76365\n              d = 0.8695652\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(t2.n)\n```\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-31-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n\n:::\n\n## `pwr`: Two-sample t-test: __power__\n\n::: {style=\"font-size: 70%;\"}\n`pwr.t.test(n = NULL, d = NULL, sig.level = 0.05, power = NULL,`   \n`type = c(\"two.sample\", \"one.sample\", \"paired\"),` \n`alternative = c(\"two.sided\", \"less\", \"greater\"))`\n:::\n\n::: {style=\"font-size: 85%;\"}\n\n* `d` is __Cohen's d__ effect size: $d = \\frac{\\bar{x}_1 - \\bar{x}_2}{s_{pooled}}$\n\n__Example__: Suppose the data collected for the caffeine taps study were pilot day for a larger study. Investigators want to know what sample size they would need to detect a 2 point difference between the two groups. Assume the SD in both groups is 2.3. \n\nSpecify all parameters _except for_ the power:\n:::\n\n::: {style=\"font-size: 90%;\"}\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt2.power <- pwr.t.test(\n  d = 2/2.3, \n  sig.level = 0.05, \n  # power = 0.80, \n  n = 22,\n  type = \"two.sample\") \n\nt2.power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 22\n              d = 0.8695652\n      sig.level = 0.05\n          power = 0.8044288\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(t2.power)\n```\n\n::: {.cell-output-display}\n![](11_Hyp_testing_02_files/figure-html/unnamed-chunk-33-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n\n:::\n\n## What information do we need for a power (or sample size) calculation?\n\n::: columns\n::: {.column width=\"40%\"}\nThere are 4 pieces of information:\n\n1. Level of significance $\\alpha$\n    * Usually fixed to 0.05\n1. Power\n    * Ideally at least 0.80\n1. Sample size\n1. Effect size (expected change)\n\nGiven any 3 pieces of information, we can solve for the 4th.\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwr.t.test(\n  d = (98.6-98.25)/0.73,\n  sig.level = 0.05, \n  # power = 0.80, \n  n=130,\n  type = \"one.sample\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     One-sample t test power calculation \n\n              n = 130\n              d = 0.4794521\n      sig.level = 0.05\n          power = 0.9997354\n    alternative = two.sided\n```\n:::\n:::\n\n\n:::\n:::\n\n\n## More software for power and sample size calculations: PASS \n\n* PASS is a very powerful (& expensive) software that does power and sample size calculations for many advanced statistical modeling techniques.\n    * Even if you don't have access to PASS, their [documentation](https://www.ncss.com/software/pass/pass-documentation/) is very good and free online.\n    * Documentation includes formulas and references.\n    * PASS documentation for powering [means](https://www.ncss.com/software/pass/pass-documentation/#Means)\n        * One mean, paired means, two independent means\n\n* One-sample t-test documentation:\n<https://www.ncss.com/wp-content/themes/ncss/pdf/Procedures/PASS/One-Sample_T-Tests.pdf>\n\n\n## OCTRI-BERD power & sample size presentations\n\n::: {style=\"font-size: 90%;\"}\n\n* __Power and Sample Size 101__\n  * Presented by Meike Niederhausen; April 13, 2023\n  * Slides: <http://bit.ly/PSS101-BERD-April2023>\n  * [Recording](https://echo360.org/media/10f37fa6-7196-4525-bd64-6b9fcca60ac0/public)\n\n* __Power and Sample Size for Clinical Trials: An Introduction__\n  * Presented by Yiyi Chen; Feb 18, 2021\n  * Slides: http://bit.ly/PSS-ClinicalTrials\n  * [Recording](https://echo360.org/lesson/9a21deb8-258d-4305-bdc9-7effdc35e719/classroom)\n\n* __Planning a Study with Power and Sample Size Considerations in Mind__\n  * Presented by David Yanez; May 29, 2019\n  * [Slides](https://www.ohsu.edu/sites/default/files/2019-12/PowerAndSampleSize_29MAY2019.pdf)\n  * [Recording](https://echo360.org/lesson/44c9a3e9-b8ec-4042-84d8-4758cc779a1f/classroom)\n\n* __Power and Sample Size Simulations in R__\n  * Presented by Robin Baudier; Sept 21, 2023\n  * [Slides](https://www.slideshare.net/ssuser84c78e/octri-pss-simulations-in-r-seminarpdf)\n  * [Recording](https://echo360.org/media/12e6e603-13f9-4b50-bf76-787185acdfce/public)\n\n:::",
    "supporting": [
      "11_Hyp_testing_02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}