{
  "hash": "01055cc4f3dd5b2b5526137b0fa89565",
  "result": {
    "markdown": "---\ntitle: \"Lesson 11: Hypothesis Testing 1: Single-sample mean\"\nsubtitle: \"TB sections 4.3, 5.1\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"11/6/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 11 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n## Where are we? Continuous outcome zoomed in {visibility=\"hidden\"}\n\n<br>\n<br>\n\n![](../img_slides/flowchart_only_continuous.jpg){fig-align=\"center\"}\n\n\n## Goals for today: Part 1 \n\n### (4.3, 5.1) Hypothesis testing for mean from one sample  \n\n* Introduce hypothesis testing using the case of analyzing a mean from one sample (group)\n\n::: columns\n::: {.column width=\"50%\"}\n* [Steps of a hypothesis test:]{style=\"color:purple\"}\n    1. level of significance\n    1. null ( $H_0$ ) and alternative ( $H_A$ ) hypotheses\n    1. test statistic\n    1. p-value\n    1. conclusion\n:::\n::: {.column width=\"50%\"}\n* [Run a hypothesis test in R]{style=\"color:green\"}\n    * Load a dataset - need to specify location of dataset\n    * R projects\n    * Run a t-test in R\n    * `tidy()` the test output using `broom` package\n:::\n:::\n\n### (4.3.3) Confidence intervals (CIs) vs. hypothesis tests \n\n\n## Answering a research question\n\nResearch question is a generic form: Is there evidence to support that the population mean is different than $\\mu$?\n\nTwo approaches to answer this question:\n\n::: columns\n::: {.column width=\"49%\"}\n::: green2\n::: green2-ttl\nConfidence interval\n:::\n::: green2-cont\n- Create a __confidence interval (CI)__ for the population mean $\\mu$ and determine whether 98.6°F is inside the CI or not.\n- Answering the question: is 98.6°F a plausible value?\n:::\n:::\n:::\n\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"49%\"}\n::: pink\n::: pink-ttl\nHypothesis test\n:::\n::: pink-cont\n- Run a __hypothesis test__ to see if there is evidence that the population mean $\\mu$ is _significantly different_ from 98.6°F or not\n- This does not give us a range of plausible values for the population mean $\\mu$.\n- Instead, we calculate a _test statistic_ and _p-value_ \n- See how likely we are to observe the sample mean $\\overline{x}$ or a more extreme sample mean assuming that the population mean $\\mu$ is 98.6°F\n:::\n:::\n:::\n:::\n\n## Last time: point estimates\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=1728}\n:::\n:::\n\n\n![](../img_slides/sample_point_est.png){fig-align=\"center\"}\n\n## Last time: Point estimates with their confidence intervals for $\\mu$\n\n:::::: columns\n::: {.column width=\"22%\"}\n \n\n![](../img_slides/samp_point_est_vert.png){fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=864}\n:::\n:::\n\n:::\n\n::: {.column width=\"28%\"}\nDo these confidence intervals include $\\mu$?\n:::\n::::::\n\n\n\n\n## This time: Point estimates with probability assuming population mean $\\mu$\n\n:::::: columns\n::: {.column width=\"22%\"}\n \n\n![](../img_slides/samp_point_est_vert.png){fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=864}\n:::\n:::\n\n:::\n\n::: {.column width=\"28%\"}\nAssuming the population mean is $\\mu$, what is the probability that we observe $\\overline{x}$ or a more extreme sample mean?\n:::\n::::::\n\n\n## Is 98.6°F  really the mean \"healthy\" body temperature?\n\n* __Where did the 98.6°F value come from?__\n    * German physician Carl Reinhold August [Wunderlich](https://www.google.com/books/edition/_/a6UNq33GPfIC?hl=en&gbpv=1&pg=PP14) determined  98.6°F (or 37°C) based on temperatures from 25,000 patients in Leipzig in 1851.\n\n* [1992 JAMA article](https://jamanetwork.com/journals/jama/article-abstract/400116) by Mackowiak, Wasserman, & Levine\n    * They claim that 98.2°F (36.8°C) is a more accurate average body temp\n    * Sample: n = 148 healthy individuals aged 18 - 40 years\n\n* Other research indicating that the human body temperature is lower\n    * In January 2020: _[Decreasing human body temperature in the United States since the Industrial Revolution](https://elifesciences.org/articles/49555)_\n    * September 2023 update: _[Defining Usual Oral Temperature Ranges in Outpatients Using an Unsupervised Learning Algorithm](https://jamanetwork.com/journals/jamainternalmedicine/article-abstract/2809098)_ in JAMA Internal Medicine\n\n* NYT article [The Average Human Body Temperature Is Not 98.6 Degrees](../resources/NYT_What_Is_a_Fever_Why_Your_Body_Temperature_May_Be_Cooler_Than_98.6_Degrees.pdf), Oct 12, 2023, by Dana G. Smith\n\n::: lob\n**Question:** based on the 1992 JAMA data, is there evidence to support that the population mean body temperature is different from 98.6°F?\n:::\n\n## Question: based on the 1992 JAMA data, is there evidence to support that the population mean body temperature is different from 98.6°F?\n\n\nTwo approaches to answer this question:\n\n::: columns\n::: {.column width=\"49%\"}\n::: green2\n::: green2-ttl\nConfidence interval\n:::\n::: green2-cont\n- Create a __confidence interval (CI)__ for the population mean $\\mu$ and determine whether 98.6°F is inside the CI or not.\n- Answering the question: is 98.6°F a plausible value?\n:::\n:::\n:::\n\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"49%\"}\n::: pink2\n::: pink2-ttl\nHypothesis test\n:::\n::: pink2-cont\n- Run a __hypothesis test__ to see if there is evidence that the population mean $\\mu$ is _significantly different_ from 98.6°F or not\n- This does not give us a range of plausible values for the population mean $\\mu$.\n- Instead, we calculate a _test statistic_ and _p-value_ \n- See how likely we are to observe the sample mean $\\overline{x}$ or a more extreme sample mean assuming that the population mean $\\mu$ is 98.6°F\n:::\n:::\n:::\n:::\n\n\n\n## [Approach 1: Create a 95% CI for the population mean body temperature]{style=\"color:#459B99\"}\n\n* Use data based on the results from the 1992 JAMA study\n    * The original dataset used in the JAMA article is not available\n    * However, Allen Shoemaker from Calvin College created a [dataset](http://jse.amstat.org/datasets/normtemp.dat.txt) with the same summary statistics as in the JAMA article, which we will use:\n\n$$\\overline{x} = 98.25,~s=0.733,~n=130$$\n\n\n\n\n::: columns\n::: {.column width=\"40%\"}\nCI for $\\mu$:\n\\begin{align}\n\\overline{x} &\\pm t^*\\cdot\\frac{s}{\\sqrt{n}}\\\\\n98.25 &\\pm 1.979\\cdot\\frac{0.733}{\\sqrt{130}}\\\\\n98.25 &\\pm 0.127\\\\\n(98.123&, 98.377)\n\\end{align}\n\n:::\n\n::: {.column width=\"60%\"}\n\n \n\nUsed $t^*$ = `qt(.975, df=129)` = 1.979\n\n \n\n**Conclusion:  **\nWe are 95% confident that the (population) mean body temperature is between 98.123°F and 98.377°F, which is discernably different than 98.6°F.\n\n:::\n:::\n\n\n\n## [Approach 2: Hypothesis Test]{style=\"color:#BF396F\"} \n\nFrom before: \n\n* Run a __hypothesis test__ to see if there is evidence that the population mean $\\mu$ is _significantly different_ from 98.6°F or not.\n    * This does not give us a range of plausible values for the population mean $\\mu$.\n    \n    * Instead, we calculate a _test statistic_ and _p-value_ \n        * to see how likely we are to observe the sample mean $\\overline{x}$\n        * or a more extreme sample mean \n        * assuming that the population mean $\\mu$ is 98.6°F.\n\n__How do we calculate a _test statistic_ and _p-value_?__\n\n- Use the sampling distribution and central limit theorem!!\n- Two cases\n  - Case 1: suppose we know the population sd $\\sigma$\n  - Case 2: we don't know the population sd $\\sigma$ \n\n\n\n## Case 1: suppose we know the population sd $\\sigma$\n\n* [How likely we are to observe the sample mean $\\overline{x}$ ,]{style=\"color:green\"}\n    * [or a more extreme sample mean, ]{style=\"color:green\"}\n    * [assuming that the population mean $\\mu$ is 98.6°F?]{style=\"color:green\"}\n* Use $\\overline{x} = 98.25$, $\\sigma=0.733$, and $n=130$\n\n\n\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n:::\n::: {.column width=\"50%\"}\n\n:::\n:::\n\n<!-- * Calculate a _test statistic_ and _p-value_  -->\n\n\n## Case 2: we don't know the population sd $\\sigma$ \n\n::: columns\n::: {.column width=\"40%\"}\n\n* This is usually the case in real life\n* We estimate $\\sigma$ with the sample standard deviation $s$\n* From last time, we know that in this case we need to use the __t-distribution with d.f. = n-1__, instead of the normal distribution \n* [Question: How likely we are to observe the sample mean $\\overline{x}$ or a more extreme sample mean, assuming that the population mean $\\mu$ is 98.6°F?]{style=\"color:green\"}\n* Use $\\overline{x} = 98.25$, $s=0.733$, and $n=130$\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n\n\n:::\n:::\n\n\n## Steps in a Hypothesis Test\n\n1. Set the __[level of significance]{style=\"color:darkorange\"}__ $\\alpha$\n\n1. Specify the __[null]{style=\"color:darkorange\"}__ ( $H_0$ ) and __[alternative]{style=\"color:darkorange\"}__ ( $H_A$ ) __[hypotheses]{style=\"color:darkorange\"}__\n    1. In symbols\n    1. In words\n    1. Alternative: one- or two-sided?\n\n1. Calculate the __[test statistic]{style=\"color:darkorange\"}__. \n\n1. Calculate the __[p-value]{style=\"color:darkorange\"}__ based on the observed test statistic and its sampling distribution\n\n1. Write a __[conclusion]{style=\"color:darkorange\"}__ to the hypothesis test\n    1. Do we reject or fail to reject $H_0$?\n    1. Write a conclusion in the context of the problem\n\n\n## Step 2: Null & Alternative Hypotheses (1/2)\n\nIn statistics, a __hypothesis__ is a statement about the value of an __unknown population parameter__.\n\n\nA __[hypothesis test]{style=\"color:darkorange\"}__ consists of a test between two competing hypotheses: \n\n1. a __[null]{style=\"color:darkorange\"}__ hypothesis $H_0$ (pronounced “H-naught”) vs. \n1. an __[alternative]{style=\"color:darkorange\"}__ hypothesis $H_A$ (also denoted $H_1$)\n\nExample of hypotheses in words: \n\n\\begin{aligned}\nH_0 &: \\text{The population mean body temperature is 98.6°F}\\\\\n\\text{vs. } H_A &: \\text{The population mean body temperature is not 98.6°F}\n\\end{aligned}\n\n1. $H_0$ is a claim that there is “no effect” or “no difference of interest.”\n1. $H_A$ is the claim a researcher wants to establish or find evidence to support. It is viewed as a “challenger” hypothesis to the null hypothesis $H_0$\n\n## Step 2: Null & Alternative Hypotheses (2/2)\n\n__[Notation for hypotheses:]{style=\"color:green\"}__\n\n\\begin{aligned}\nH_0 &: \\mu = \\mu_0\\\\\n\\text{vs. } H_A&: \\mu \\neq, <, \\textrm{or}, > \\mu_0\n\\end{aligned}\n\nWe call $\\mu_0$ the *null value*\n\n::: columns\n::: {.column width=\"40%\"}\n$H_A: \\mu \\neq \\mu_0$\n\n::: {style=\"font-size: 90%;\"}\n* not choosing a priori whether we believe the population mean is greater or less than the null value $\\mu_0$\n:::\n:::\n\n::: {.column width=\"30%\"}\n$H_A: \\mu < \\mu_0$\n\n::: {style=\"font-size: 90%;\"}\n* believe the population mean is **less** than the null value $\\mu_0$\n:::\n:::\n\n::: {.column width=\"30%\"}\n$H_A: \\mu > \\mu_0$\n\n::: {style=\"font-size: 90%;\"}\n* believe the population mean is **greater** than the null value $\\mu_0$\n:::\n:::\n:::\n\n* $H_A: \\mu \\neq \\mu_0$ is the most common option, since it's the most conservative\n\nExample: \n\n\\begin{aligned}\nH_0 &: \\mu = 98.6\\\\\n\\text{vs. } H_A&: \\mu \\neq 98.6\n\\end{aligned}\n\n\n## Step 3: [Test statistic]{style=\"color:darkorange\"} (& its distribution)\n::: columns\n::: {.column width=\"50%\"}\n__[Case 1: know population sd $\\sigma$]{style=\"color:purple\"}__\n\n$$\n\\text{test statistic} = z_{\\overline{x}} = \\frac{\\overline{x} - \\mu_0}{\\frac{\\sigma}{\\sqrt{n}}}\n$$\n\n* Statistical theory tells us that [$z_{\\overline{x}}$]{style=\"color:purple\"} follows a [__Standard Normal distribution__ $N(0,1)$]{style=\"color:purple\"}\n:::\n\n::: {.column width=\"50%\"}\n\n__[Case 2: don't know population sd $\\sigma$]{style=\"color:green\"}__\n\n$$\n\\text{test statistic} = t_{\\overline{x}} = \\frac{\\overline{x} - \\mu_0}{\\frac{s}{\\sqrt{n}}}\n$$\n\n* Statistical theory tells us that [$t_{\\overline{x}}$]{style=\"color:green\"} follows a [__Student's t distribution__ with degrees of freedom (df) = $n-1$]{style=\"color:green\"}\n\n:::\n:::\n\n::: {style=\"font-size: 90%;\"}\n$\\overline{x}$ = sample mean, $\\mu_0$ = hypothesized population mean from $H_0$,  \n$\\sigma$ = _population_ standard deviation, $s$ = _sample_ standard deviation,  \n$n$ = sample size\n:::\n\n__[Assumptions]{style=\"color:darkorange\"}__: same as CLT\n\n* __Independent observations__: the observations were collected independently.\n* __Approximately normal sample or big n__: the distribution of the sample should be approximately normal, _or_ the sample size should be at least 30.\n\n\n## Step 3: Test statistic calculation\n\nRecall that $\\overline{x} = 98.25$, $s=0.733$, and $n=130.$\n\nThe test statistic is:\n\n$$t_{\\overline{x}} = \\frac{\\overline{x} - \\mu_0}{\\frac{s}{\\sqrt{n}}}\n= \\frac{98.25 - 98.6}{\\frac{0.73}{\\sqrt{130}}}\n= -5.45$$\n\n* Statistical theory tells us that $t_{\\overline{x}}$ follows a __Student's t-distribution__ with $d.f. = n-1 = 129$.\n\n::: columns\n::: {.column width=\"75%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n:::\n::: {.column width=\"25%\"}\n__Assumptions met?__\n:::\n:::\n\n## Step 4: p-value\n\nThe __[p-value]{style=\"color:darkorange\"}__ is the [__probability__ of obtaining a test statistic _just as extreme or more extreme_ than the observed test statistic assuming the null hypothesis $H_0$ is true.]{style=\"color:darkblue\"} \n\n::: columns\n::: {.column width=\"50%\"}\n* The $p$-value is a quantification of \"surprise\"\n    * Assuming $H_0$ is true, _how surprised are we with the observed results_?\n    * _Ex_: assuming that the true mean body temperature is 98.6°F, how surprised are we to get a sample mean of 98.25°F  (or more extreme)?\n    \n* If the $p$-value is \"small,\" it means there's a small probability that we would get the observed statistic (or more extreme) when $H_0$ is true.\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\n\n\n## Step 4: p-value calculation \n\nCalculate the _p_-value using the __Student's t-distribution__ with $d.f. = n-1 = 129$:\n\n$$p-value=P(T \\leq -5.45) + P(T \\geq 5.45) = 2.410889 \\times 10^{-07}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use pt() instead of pnorm()\n# need to specify df\n2*pt(-5.4548, df = 130-1, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.410889e-07\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](11_Hyp_testing_01_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n## Step 4: p-value estimation using $t$-table\n\n* $t$-table only gives us *bounds* on the p-value\n* Recall from using the $t$-table for CIs, that the table gives us the cutoff values for varying tail probabilities (1-tail & 2-tail)\n* Find the row with the appropriate degrees of freedom\n    * Use next smallest df in table if actual df not shown\n    * I.e., for df = 129, use df = 100 in table\n* Figure out where the test statistic's absolute value is in relation to the values in the columns, i.e. between which columns is the test statistic?\n* The header rows for those columns gives the lower & upper bounds for the p-value\n    * Choosing one-tail vs. two-tail test, depends on the alternative hypothesis $H_A$.\n    * For a 2-sided test ( $H_A: \\mu \\neq \\mu_0$ ), use two-tails \n    * For a 1-sided test ( $H_A: \\mu < \\textrm{or} > \\mu_0$ ), use one-tail \n\n\n\n## Step 1: Significance Level $\\alpha$\n\n* __Before doing a hypothesis test__, we set a cut-off for how small the $p$-value should be in order to reject $H_0$.\n* We call this the __[significance level]{style=\"color:darkorange\"}__, denoted by the Greek symbol [alpha ( $\\alpha$ )]{style=\"color:darkorange\"}\n* [Typical $\\alpha$]{style=\"color:darkblue\"} values are \n    * 0.05 - _most common by far!!_\n    * 0.01 and 0.1\n* Decision rule:    \n    * When [$p$-value < $\\alpha$]{style=\"color:green\"}, we \"__[reject]{style=\"color:green\"}__ the null hypothesis [$H_0$]{style=\"color:green\"}.\"\n    * When [$p$-value $\\geq \\alpha$]{style=\"color:purple\"}, we \"__[fail to reject]{style=\"color:purple\"}__ the null hypothesis [$H_0$]{style=\"color:purple\"}.\"\n\n:::{.callout-important}\n* \"Failing to reject\" $H_0$ is __NOT__ the same as \"accepting\" $H_0$! \n* By failing to reject $H_0$ we are just saying that we don't have sufficient evidence to support the alternative $H_A$.\n* _This does not imply that $H_0$ is true!!_\n:::\n\n\n\n\n## Step 5: Conclusion to hypothesis test\n\n\\begin{aligned}\nH_0 &: \\mu = 98.6\\\\\n\\text{vs. } H_A&: \\mu \\neq 98.6\n\\end{aligned}\n\n* Recall the $p$-value = $2.410889 \\times 10^{-07}$ \n* Use $\\alpha$ = 0.05.\n* Do we reject or fail to reject $H_0$?\n\n__Conclusion statement__:\n\n* Basic: (\"stats class\" conclusion)\n    * There is sufficient evidence that the (population) mean body temperature is discernibly different from 98.6°F ( $p$-value < 0.001).\n\n* Better: (\"manuscript style\" conclusion)\n    * The average body temperature in the sample was 98.25°F (95% CI 98.12, 98.38°F), which is discernibly different from 98.6°F ( $p$-value < 0.001).\n\n\n## Confidence Intervals vs. Hypothesis Testing\n\n* See also V&H Section 4.3.3\n\n# Running a t-test in R\n\n* Working directory\n* Load a dataset - need to specify location of dataset\n* R projects\n* Run a t-test in R\n* `tidy()` the test output using `broom` package\n\n## Load the dataset\n\n* The data are in a csv file called `BodyTemperatures.csv`\n* You need to tell R where the dataset is located!\n* I recommend saving all datasets in a folder called data. \n    * The code I will be providing you will be set up this way.\n\n* To make it easier to specify where the dataset is located, I recommend using the `here()` function from the `here` package: `here::here()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read_csv() is a function from the readr package that is a part of the tidyverse\nlibrary(here)   # first install this package\n\nBodyTemps <- read_csv(here::here(\"data\", \"BodyTemperatures.csv\"))\n#                     location: look in \"data\" folder\n#                               for the file \"BodyTemperatures.csv\"\n\nglimpse(BodyTemps)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 130\nColumns: 3\n$ Temperature <dbl> 96.3, 96.7, 96.9, 97.0, 97.1, 97.1, 97.1, 97.2, 97.3, 97.4…\n$ Gender      <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ HeartRate   <dbl> 70, 71, 74, 80, 73, 75, 82, 64, 69, 70, 68, 72, 78, 70, 75…\n```\n:::\n:::\n\n\n## `t.test`: base R's function for testing one mean \n\n* Use the body temperature example with $H_A: \\mu \\neq 98.6$\n* We called the dataset `BodyTemps` when we loaded it\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(BodyTemps)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 130\nColumns: 3\n$ Temperature <dbl> 96.3, 96.7, 96.9, 97.0, 97.1, 97.1, 97.1, 97.2, 97.3, 97.4…\n$ Gender      <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ HeartRate   <dbl> 70, 71, 74, 80, 73, 75, 82, 64, 69, 70, 68, 72, 78, 70, 75…\n```\n:::\n\n```{.r .cell-code}\n(temps_ttest <- t.test(x = BodyTemps$Temperature,\n       # alternative = \"two.sided\",  # default\n       mu = 98.6))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  BodyTemps$Temperature\nt = -5.4548, df = 129, p-value = 2.411e-07\nalternative hypothesis: true mean is not equal to 98.6\n95 percent confidence interval:\n 98.12200 98.37646\nsample estimates:\nmean of x \n 98.24923 \n```\n:::\n:::\n\n\nNote that the test output also gives the 95% CI using the t-distribution.\n\n\n## `tidy()` the `t.test` output\n\n* Use the `tidy()` function from the `broom` package for briefer output in table format that's stored as a `tibble`\n* Combined with the `gt()` function from the `gt` package, we get a nice table \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(temps_ttest) %>% \n  gt() %>% \n  tab_options(table.font.size = 40) # use a different size in your HW\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ccavxmiduu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ccavxmiduu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ccavxmiduu thead, #ccavxmiduu tbody, #ccavxmiduu tfoot, #ccavxmiduu tr, #ccavxmiduu td, #ccavxmiduu th {\n  border-style: none;\n}\n\n#ccavxmiduu p {\n  margin: 0;\n  padding: 0;\n}\n\n#ccavxmiduu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 40px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ccavxmiduu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ccavxmiduu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ccavxmiduu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ccavxmiduu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ccavxmiduu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ccavxmiduu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ccavxmiduu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ccavxmiduu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ccavxmiduu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ccavxmiduu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ccavxmiduu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ccavxmiduu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ccavxmiduu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ccavxmiduu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ccavxmiduu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ccavxmiduu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ccavxmiduu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ccavxmiduu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ccavxmiduu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ccavxmiduu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ccavxmiduu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ccavxmiduu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ccavxmiduu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ccavxmiduu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ccavxmiduu .gt_left {\n  text-align: left;\n}\n\n#ccavxmiduu .gt_center {\n  text-align: center;\n}\n\n#ccavxmiduu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ccavxmiduu .gt_font_normal {\n  font-weight: normal;\n}\n\n#ccavxmiduu .gt_font_bold {\n  font-weight: bold;\n}\n\n#ccavxmiduu .gt_font_italic {\n  font-style: italic;\n}\n\n#ccavxmiduu .gt_super {\n  font-size: 65%;\n}\n\n#ccavxmiduu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ccavxmiduu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ccavxmiduu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ccavxmiduu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ccavxmiduu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ccavxmiduu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ccavxmiduu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ccavxmiduu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ccavxmiduu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">98.24923</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">-5.454823</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">2.410632e-07</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">129</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">98.122</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">98.37646</td>\n<td headers=\"method\" class=\"gt_row gt_left\">One Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n* Since the `tidy()` output is a tibble, we can easily `pull()` specific values from it:\n\n::: columns\n::: {.column width=\"50%\"}\n\nUsing base R's `$`\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(temps_ttest)$p.value  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.410632e-07\n```\n:::\n:::\n\n\nAdvantage: quick and easy\n:::\n\n::: {.column width=\"50%\"}\nOr the `tidyverse` way: using `pull()` from `dplyr` package \n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(temps_ttest) %>% pull(p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.410632e-07\n```\n:::\n:::\n\n\nAdvantage: can use together with piping (`%>%`) other functions\n:::\n:::\n\n## Answering a research question\n\nResearch question is a generic form: Is there evidence to support that the population mean is different than $\\mu$?\n\n\n\n## What's next? \n\nCI's and hypothesis testing for different scenarios:\n\n\n| Day | Section |  Population parameter   |       Symbol        |       Point estimate       |            Symbol             |\n|:----:|:------:|:----------:|:--------:|:----------:|:-------:|\n| 10  |   5.1   |        Pop mean         |        $\\mu$        |        Sample mean         |           $\\overline{x}$           |\n| 10  |   5.2   | Pop mean of paired diff | $\\mu_d$ or $\\delta$ | Sample mean of paired diff |         $\\overline{x}_{d}$         |\n| 11  |   5.3   |    Diff in pop means    |    $\\mu_1-\\mu_2$    |    Diff in sample means    |    $\\overline{x}_1 - \\overline{x}_2$    |\n| 12  |   8.1   |     Pop proportion      |         $p$         |        Sample prop         |         $\\widehat{p}$         |\n| 12  |   8.2   |   Diff in pop prop's    |      $p_1-p_2$      |   Diff in sample prop's    | $\\widehat{p}_1-\\widehat{p}_2$ |\n\n\n",
    "supporting": [
      "11_Hyp_testing_01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}