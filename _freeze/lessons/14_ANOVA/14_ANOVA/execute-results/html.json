{
  "hash": "1be64ec94dbff7f9ca3fb8c7612bf6d3",
  "result": {
    "markdown": "---\ntitle: \"Day 14: Comparing Means with ANOVA (Section 5.5)\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"09/25/2024\"\ncategories: [\"Week 6\"]\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    toc: true\n    toc-depth: 1\n    toc-title: Class Overview\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1600\n    height: 1100\n    footer: Lesson 8 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n\n\n## Where are we?\n\n<br>\n<br>\n\n![](/img_slides/flowchart_511_continuous_categorical.png){fig-align=\"center\"}\n\n## Where are we? Continuous outcome zoomed in\n\n<br>\n<br>\n\n![](/img_slides/flowchart_only_continuous.jpg){fig-align=\"center\"}\n\n\n## Goals for today (Section 5.5)\n\n* Analysis of Variance (ANOVA)\n\n* When to use an ANOVA\n* Hypotheses\n* ANOVA table\n* Different sources of variation in ANOVA\n* ANOVA conditions\n* F-distribution\n* Post-hoc testing of differences in means\n* Running an ANOVA in R\n\n\n\n## Disability Discrimination Example \n\n::: columns\n::: {.column width=\"50%\"}\n* The U.S. Rehabilitation Act of 1973 prohibited discrimination against people with physical disabilities. \n    * The act defined a disabled person as any individual who has a physical or mental impairment that limits the person's major life activities.\n* A 1980's study examined whether physical disabilities affect people's perceptions of employment qualifications \n    * ([Cesare, Tannenbaum, & Dalessio, 1990](https://psycnet.apa.org/record/1991-07629-001)). \n:::\n\n::: {.column width=\"50%\"}\n* Researchers prepared recorded job interviews, using _same actors and script each time_. \n* Only difference: job applicant appeared with different disabilities.\n    * _No disability_\n    * _Leg amputation_\n    * _Crutches_\n    * _Hearing impairment_\n    * _Wheelchair confinement_\n* 70 undergrad students were randomly assigned to view one of the videotapes, \n    * then __rated__ the candidate's qualifications on a __1-10 scale__.\n\n:::\n:::\n\n* The research question: __are qualifications evaluated differently depending on the applicant's presented disability?__\n\n\n\n## Load interview data from `.txt` file\n\n* `.txt` (text) files are usually tab-deliminated files\n    * `.csv` files are comma-separated files\n* `read_delim` is from the `readr` package, just like `read_csv`, and loads with other `tidyverse` packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemploy <- read_delim(\n  file = here::here(\"data\", \"DisabilityEmployment.txt\"), \n  delim = \"\\t\",   # tab delimited\n  trim_ws = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 70 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (1): disability\ndbl (1): score\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n\n`trim_ws`: \tspecify whether leading and trailing white space should be trimmed from each field before parsing it\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 70\nColumns: 2\n$ disability <chr> \"none\", \"none\", \"none\", \"none\", \"none\", \"none\", \"none\", \"no…\n$ score      <dbl> 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…\n```\n:::\n:::\n\n\n\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  disability            score      \n Length:70          Min.   :1.400  \n Class :character   1st Qu.:3.700  \n Mode  :character   Median :5.050  \n                    Mean   :4.929  \n                    3rd Qu.:6.100  \n                    Max.   :8.500  \n```\n:::\n:::\n\n\n:::\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemploy %>% tabyl(disability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n disability  n percent\n    amputee 14     0.2\n   crutches 14     0.2\n    hearing 14     0.2\n       none 14     0.2\n wheelchair 14     0.2\n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n## MoRitz's tip of the day\n\nRead [OHSU's Inclusive Language Guide](https://www.ohsu.edu/sites/default/files/2021-03/OHSU%20Inclusive%20Language%20Guide_031521.pdf) (below is from pgs. 22-25)\n \n\"... an evolving tool to help OHSU members learn about and use inclusive language...\"\n\nSections on: Race and ethnicity, Immigration status, Gender and sexual orientation, and Ability (including physical, mental and chronological attributes)\n\n::: columns\n::: {.column width=\"50%\"}\n\n![](/img_slides/OHSU_Inclusive_Language_Guide_Ability_header.png){fig-align=\"center\"}\n![](/img_slides/OHSU_Inclusive_Language_Guide_Respectful.png){fig-align=\"center\"}\n![](/img_slides/OHSU_Inclusive_Language_Guide_Respectful_disability.png){fig-align=\"center\"}\n\n:::\n\n::: {.column width=\"50%\"}\n![](/img_slides/OHSU_Inclusive_Language_Guide_Avoid.png){fig-align=\"center\"}\n:::\n:::\n\n\n## Factor variable: Make `disability` a factor variable\n\n::: columns\n::: {.column width=\"70%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 70\nColumns: 2\n$ disability <chr> \"none\", \"none\", \"none\", \"none\", \"none\", \"none\", \"none\", \"no…\n$ score      <dbl> 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…\n```\n:::\n:::\n\n\n\n:::\n::: {.column width=\"30%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  disability            score      \n Length:70          Min.   :1.400  \n Class :character   1st Qu.:3.700  \n Mode  :character   Median :5.050  \n                    Mean   :4.929  \n                    3rd Qu.:6.100  \n                    Max.   :8.500  \n```\n:::\n:::\n\n\n:::\n:::\n\nMake `disability` a factor variable:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemploy <- employ %>% \n  mutate(disability = factor(disability))\n```\n:::\n\n\n\n<br>\n\nWhat's different now?\n\n::: columns\n::: {.column width=\"70%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 70\nColumns: 2\n$ disability <fct> none, none, none, none, none, none, none, none, none, none,…\n$ score      <dbl> 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…\n```\n:::\n:::\n\n\n\n:::\n::: {.column width=\"30%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      disability     score      \n amputee   :14   Min.   :1.400  \n crutches  :14   1st Qu.:3.700  \n hearing   :14   Median :5.050  \n none      :14   Mean   :4.929  \n wheelchair:14   3rd Qu.:6.100  \n                 Max.   :8.500  \n```\n:::\n:::\n\n\n:::\n:::\n\n\n## Factor variable: Change order & name of disability levels \n\n[What are the current level names and order?]{style=\"color:purple\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(employ$disability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"amputee\"    \"crutches\"   \"hearing\"    \"none\"       \"wheelchair\"\n```\n:::\n:::\n\n\n\n[What changes are being made below?]{style=\"color:green\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemploy <- employ %>% \n  mutate(\n    # make \"none\" the first level\n    # by only listing the level none, all other levels will be in original order\n    disability = fct_relevel(disability, \"none\"),\n    # change the level name amputee to amputation\n    disability = fct_recode(disability, amputation = \"amputee\")\n    )\n```\n:::\n\n\n\n* `fct_relevel()` and `fct_recode()` are from the `forcats` package: <https://forcats.tidyverse.org/index.html>. \n* `forcats` is loaded with `library(tidyverse)`.\n\n[New order & names:]{style=\"color:purple\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(employ$disability) # note the new order and new name\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"none\"       \"amputation\" \"crutches\"   \"hearing\"    \"wheelchair\"\n```\n:::\n:::\n\n\n\n\n\n## Data viz (1/2)\n\n* What are the `score` distribution shapes within each group? \n* Any unusual values?\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(employ, aes(x=score)) +\n  geom_density() +\n  facet_wrap(~ disability)\n```\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggridges) \nggplot(employ, \n       aes(x=score,\n           y = disability,\n           fill = disability)) + \n  geom_density_ridges(alpha = 0.4) +\n  theme(legend.position=\"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.801\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n:::\n:::\n\n## Data viz (2/2)\n\n* Compare the `score` measures of __center__ and __spread__ between the groups\n\n::: columns\n::: {.column width=\"45%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(employ, \n       aes(y=score, \n           x = disability,\n           fill = disability)) +\n  geom_boxplot(alpha = 0.3) +\n  coord_flip() +\n  geom_jitter(width = 0.1, \n              alpha = 0.3) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"55%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(employ, \n       aes(x = disability, \n           y=score, \n           fill=disability, \n           color=disability)) +\n  geom_dotplot(binaxis = \"y\", alpha = 0.5) +\n  geom_hline(aes(yintercept = mean(score)), \n             lty = \"dashed\") +\n  stat_summary(fun =\"mean\", geom=\"point\", \n    size = 3, color = \"grey33\", alpha = 1) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-17-1.png){width=720}\n:::\n:::\n\n\n:::\n:::\n\n\n## Hypotheses\n\nTo test for a difference in means across _k_ groups:\n\n\\begin{align}\nH_0 &: \\mu_1 = \\mu_2 = ... = \\mu_k\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\mu_i \\neq \\mu_j \\text{ for } i \\neq j\n\\end{align}\n\n\n__Hypothetical examples:__  \nIn which set (A or B) do you believe the evidence will be stronger \nthat at least one population differs from the others?\n\n![](/img_slides/hypothetical_disability_data_v2.png){fig-align=\"center\"}\n\n\n## Comparing means\n\nWhether or not two means are significantly different depends on:\n\n* How far apart the __means__ are\n* How much __variability__ there is within each group\n\n__[Questions:]{style=\"color:green\"}__  \n\n* How to measure variability __between__ groups?\n* How to measure variability __within__ groups?\n* How to compare the two measures of variability?\n* How to determine significance?\n\n\n## ANOVA in base R\n\n* There are several options to run an ANOVA model in R\n* Two most common are `lm` and `aov`\n    * `lm` = linear model; will be using frequently in BSTA 512\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(score ~ disability, data = employ) %>% anova()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: score\n           Df  Sum Sq Mean Sq F value  Pr(>F)  \ndisability  4  30.521  7.6304  2.8616 0.03013 *\nResiduals  65 173.321  2.6665                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\naov(score ~ disability, data = employ) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)  \ndisability   4  30.52   7.630   2.862 0.0301 *\nResiduals   65 173.32   2.666                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\nHypotheses:\n\n\\begin{align}\nH_0 &: \\mu_{none} = \\mu_{amputation} = \\mu_{crutches} = \\mu_{hearing} =  \\mu_{wheelchair}\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\mu_i \\neq \\mu_j \\text{ for } i \\neq j\n\\end{align}\n\nDo we reject or fail to reject $H_0$?\n\n## ANOVA tables {.nostretch}\n\nDisability example ANOVA table from R:\n\n::: {style=\"font-size: 90%;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(score ~ disability, data = employ) %>% anova()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: score\n           Df  Sum Sq Mean Sq F value  Pr(>F)  \ndisability  4  30.521  7.6304  2.8616 0.03013 *\nResiduals  65 173.321  2.6665                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n:::\n\nGeneric ANOVA table:\n\n![](/img_slides/anova_table.png){fig-align=\"center\" width=80%}\n\n## ANOVA: Analysis of Variance  {.nostretch}\n\n__ANOVA__ compares the variability between groups to the variability within groups \n\n\n![](/img_slides/anova_total_variability.png){fig-align=\"center\" height=1.5in}\n\n![](/img_slides/SST_visually_unnamed-chunk-13-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSG_visually_unnamed-chunk-14-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSE_visually_unnamed-chunk-17-1.png){fig-align=\"center\" width=30%} \n\n\n## ANOVA: Analysis of Variance  {.nostretch}\n\n__Analysis of Variance (ANOVA)__ compares the variability between groups to the variability within groups \n\n![](/img_slides/anova_total_variability.png){fig-align=\"center\" height=1.5in}\n\n\n$$\\sum_{i = 1}^k \\sum_{j = 1}^{n_i}(x_{ij} -\\bar{x})^2 \\ \\ \n= \\ \\sum_{i = 1}^k n_i(\\bar{x}_{i}-\\bar{x})^2 \\ \\ \n+ \\ \\ \\sum_{i = 1}^k\\sum_{j = 1}^{n_i}(x_{ij}-\\bar{x}_{i})^2$$\n\n\n![](/img_slides/anova_SS_total.png){fig-align=\"center\" height=1.5in}\n\n\n\n\n## Notation\n\n::: columns\n::: {.column width=\"30%\"}\n\n* _k_ groups\n* $n_i$ observations in each of the _k_ groups\n* Total sample size is $N=\\sum_{i=1}^{k}n_i$\n* $\\bar{x}_{i}$ = mean of observations in group _i_\n* $\\bar{x}$ = mean of _all_ observations\n* $s_{i}$ = sd of observations in group _i_\n* $s$ = sd of _all_ observations\n\n:::\n\n::: {.column width=\"70%\"}\n\n| Observation | *i* = 1       | *i* = 2       | *i* = 3       | $\\ldots$ | *i* = *k*     | overall   |\n|:------------|:-------------:|:-------------:|:-------------:|:--------:|:-------------:|:---------:|\n| *j* = 1     | $x_{11}$      | $x_{21}$      | $x_{31}$      | $\\ldots$ | $x_{k1}$      |           |\n| *j* = 2     | $x_{12}$      | $x_{22}$      | $x_{32}$      | $\\ldots$ | $x_{k2}$      |           |\n| *j* = 3     | $x_{13}$      | $x_{23}$      | $x_{33}$      | $\\ldots$ | $x_{k3}$      |           |\n| *j* = 4     | $x_{14}$      | $x_{24}$      | $x_{34}$      | $\\ldots$ | $x_{k4}$      |           |\n| $\\vdots$    | $\\vdots$      | $\\vdots$      | $\\vdots$      | $\\ddots$ | $\\vdots$      |           |\n| *j* = $n_i$ | $x_{1n_1}$      | $x_{2n_2}$      | $x_{3n_3}$      | $\\ldots$ | $x_{kn_k}$      |           |\n| Means       | $\\bar{x}_{1}$ | $\\bar{x}_{2}$ | $\\bar{x}_{3}$ | $\\ldots$ | $\\bar{x}_{k}$ | $\\bar{x}$ |\n| Variance    | ${s}^2_{1}$   | ${s}^2_{2}$   | ${s}^2_{3}$   | $\\ldots$ | ${s}^2_{k}$   | ${s}^2$   |\n\n:::\n:::\n\n\n\n\n## Total Sums of Squares Visually\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n:::\n::: {.column width=\"60%\"}\n\nTotal Sums of Squares:\n\n$$SST = \\sum_{i = 1}^k \\sum_{j = 1}^{n_i}(x_{ij} -\\bar{x})^2 = (N-1)s^2$$\n\n* where \n    * $N=\\sum_{i=1}^{k}n_i$ is the total sample size and\n    * $s^2$ is the grand standard deviation of all the observations\n\n* This is the sum of the squared differences between each observed $x_{ij}$ value and the *grand mean*, $\\bar{x}$. \n\n* That is, it is the total deviation of the $x_{ij}$'s from the grand mean. \n\n:::\n:::\n\n\n## Calculate Total Sums of Squares \n\nTotal Sums of Squares:\n\n$$SST = \\sum_{i = 1}^k \\sum_{j = 1}^{n_i}(x_{ij} -\\bar{x})^2 = (N-1)s^2$$\n\n::: columns\n::: {.column width=\"35%\"}\n\n* where \n    * $N=\\sum_{i=1}^{k}n_i$ is the total sample size and\n    * $s^2$ is the grand standard deviation of all the observations\n:::\n\n::: {.column width=\"65%\"}\n\nTotal sample size $N$:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(Ns <- employ %>% group_by(disability) %>% count())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n# Groups:   disability [5]\n  disability     n\n  <fct>      <int>\n1 none          14\n2 amputation    14\n3 crutches      14\n4 hearing       14\n5 wheelchair    14\n```\n:::\n:::\n\n\n\n$SST$: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(SST <- (sum(Ns$n) - 1) * sd(employ$score)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 203.8429\n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n## ANOVA: Analysis of Variance  {.nostretch}\n\n__ANOVA__ compares the variability between groups to the variability within groups \n\n\n![](/img_slides/anova_total_variability.png){fig-align=\"center\" height=1.5in}\n\n![](/img_slides/SST_visually_unnamed-chunk-13-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSG_visually_unnamed-chunk-14-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSE_visually_unnamed-chunk-17-1.png){fig-align=\"center\" width=30%} \n\n\n\n## Sums of Squares due to Groups Visually (\"between\" groups)\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n:::\n::: {.column width=\"60%\"}\nSums of Squares due to Groups:\n\n$$SSG = \\sum_{i = 1}^k n_i(\\bar{x}_{i}-\\bar{x})^2$$\n\n* This is the sum of the squared differences between each *group* mean, $\\bar{x}_{i}$, and the *grand mean*, $\\bar{x}$. \n\n* That is, it is the deviation of the group means from the grand mean.\n\n* Also called the Model SS, or $SS_{model}.$\n\n:::\n:::\n\n\n## Calculate Sums of Squares due to Groups (\"between\" groups)\n\n$$SSG = \\sum_{i = 1}^k n_i(\\bar{x}_{i}-\\bar{x})^2$$\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n:::\n::: {.column width=\"60%\"}\n\nCalculate means $\\bar{x}_i$ for each group:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxbar_groups <- employ %>% \n  group_by(disability) %>% \n  summarise(mean = mean(score))\nxbar_groups\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  disability  mean\n  <fct>      <dbl>\n1 none        4.9 \n2 amputation  4.43\n3 crutches    5.92\n4 hearing     4.05\n5 wheelchair  5.34\n```\n:::\n:::\n\n\n\nCalculate $SSG$:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(SSG <- sum(Ns$n *\n  (xbar_groups$mean - mean(employ$score))^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30.52143\n```\n:::\n:::\n\n\n\n\n:::\n:::\n\n\n## ANOVA: Analysis of Variance  {.nostretch}\n\n__ANOVA__ compares the variability between groups to the variability within groups \n\n\n![](/img_slides/anova_total_variability.png){fig-align=\"center\" height=1.5in}\n\n![](/img_slides/SST_visually_unnamed-chunk-13-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSG_visually_unnamed-chunk-14-1.png){fig-align=\"center\" width=30%} \n![](/img_slides/SSE_visually_unnamed-chunk-17-1.png){fig-align=\"center\" width=30%} \n\n\n\n\n## Sums of Squares Error Visually (within groups)\n\n::: columns\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n:::\n::: {.column width=\"60%\"}\nSums of Squares Error:\n\n$$SSE = \\sum_{i = 1}^k\\sum_{j = 1}^{n_i}(x_{ij}-\\bar{x}_{i})^2 = \\sum_{i = 1}^k(n_i-1)s_{i}^2$$\nwhere $s_{i}$ is the standard deviation of the $i^{th}$ group\n\n* This is the sum of the squared differences between each observed $x_{ij}$ value and its group mean $\\bar{x}_{i}$. \n\n* That is, it is the deviation of the $x_{ij}$'s from the predicted score by group.\n\n* Also called the residual sums of squares, or $SS_{residual}.$\n\n:::\n:::\n\n\n## Calculate Sums of Squares Error (within groups)\n\n$$SSE = \\sum_{i = 1}^k\\sum_{j = 1}^{n_i}(x_{ij}-\\bar{x}_{i})^2 = \\sum_{i = 1}^k(n_i-1)s_{i}^2$$\nwhere $s_{i}$ is the standard deviation of the $i^{th}$ group\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\nCalculate sd's $s_i$ for each group:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd_groups <- employ %>% \n  group_by(disability) %>% \n  summarise(SD = sd(score))\nsd_groups\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  disability    SD\n  <fct>      <dbl>\n1 none        1.79\n2 amputation  1.59\n3 crutches    1.48\n4 hearing     1.53\n5 wheelchair  1.75\n```\n:::\n:::\n\n\n\nCalculate $SSE$:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(SSE <- sum(\n  (Ns$n-1)*sd_groups$SD^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 173.3214\n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n## Verify _SST = SSG + SSE_ {.nostretch}\n\n__ANOVA__ compares the variability between groups to the variability within groups \n\n![](/img_slides/anova_total_variability.png){fig-align=\"center\" height=1.25in}\n\n$$\\sum_{i = 1}^k \\sum_{j = 1}^{n_i}(x_{ij} -\\bar{x})^2 \\ \\ = \\ \\ n_i\\sum_{i = 1}^k(\\bar{x}_{i}-\\bar{x})^2 \\ \\ \n+ \\ \\ \\sum_{i = 1}^k\\sum_{j = 1}^{n_i}(x_{ij}-\\bar{x}_{i})^2$$\n\n$$(N-1)s^2 \\ \\ \n= \\ \\sum_{i = 1}^k n_i(\\bar{x}_{i}-\\bar{x})^2 \\ \\ \n+ \\ \\ \\sum_{i = 1}^k(n_i-1)s_{i}^2$$\n\n![](/img_slides/anova_SS_total.png){fig-align=\"center\" height=1.25in}\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSST\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 203.8429\n```\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSSG + SSE\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 203.8429\n```\n:::\n:::\n\n\n:::\n:::\n\n\n## ANOVA table\n\n::: columns\n::: {.column width=\"15%\"}\n![](/img_slides/SS_all3_vertical.png){fig-align=\"center\"} \n:::\n::: {.column width=\"85%\"}\n<!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->\n![](/img_slides/anova_table.png){fig-align=\"center\"}\n:::\n:::\n\n\n## Thinking about the F-statistic\n\n::: columns\n::: {.column width=\"50%\"}\n__[If the groups are actually different, then which of these is more accurate?]{style=\"color:green\"}__\n\n1. The variability between groups should be higher than the variability within groups\n1. The variability within groups should be higher than the variability between groups\n\n:::\n\n::: {.column width=\"50%\"}\n__[If there really is a difference between the groups, we would expect the F-statistic to be which of these: ]{style=\"color:green\"}__\n\n1. Higher than we would observe by random chance\n1. Lower than we would observe by random chance\n\n:::\n:::\n\n\n::: columns\n::: {.column width=\"25%\"}\n\n$$F = \\frac{MSG}{MSE}$$\n\n:::\n::: {.column width=\"75%\"}\n![](/img_slides/hypothetical_disability_data_v2.png){fig-align=\"center\"}\n:::\n:::\n\n\n## ANOVA in base R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Note that I'm saving the tidy anova table\n# Will be pulling p-value from this on future slide\n\nempl_lm <- lm(score ~ disability, data = employ) %>% \n  anova() %>% \n  tidy()\n\nempl_lm %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mvdoixwwln\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mvdoixwwln table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mvdoixwwln thead, #mvdoixwwln tbody, #mvdoixwwln tfoot, #mvdoixwwln tr, #mvdoixwwln td, #mvdoixwwln th {\n  border-style: none;\n}\n\n#mvdoixwwln p {\n  margin: 0;\n  padding: 0;\n}\n\n#mvdoixwwln .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mvdoixwwln .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mvdoixwwln .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mvdoixwwln .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mvdoixwwln .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mvdoixwwln .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mvdoixwwln .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mvdoixwwln .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mvdoixwwln .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mvdoixwwln .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mvdoixwwln .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mvdoixwwln .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mvdoixwwln .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mvdoixwwln .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mvdoixwwln .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mvdoixwwln .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mvdoixwwln .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mvdoixwwln .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mvdoixwwln .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mvdoixwwln .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mvdoixwwln .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mvdoixwwln .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mvdoixwwln .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mvdoixwwln .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mvdoixwwln .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mvdoixwwln .gt_left {\n  text-align: left;\n}\n\n#mvdoixwwln .gt_center {\n  text-align: center;\n}\n\n#mvdoixwwln .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mvdoixwwln .gt_font_normal {\n  font-weight: normal;\n}\n\n#mvdoixwwln .gt_font_bold {\n  font-weight: bold;\n}\n\n#mvdoixwwln .gt_font_italic {\n  font-style: italic;\n}\n\n#mvdoixwwln .gt_super {\n  font-size: 65%;\n}\n\n#mvdoixwwln .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mvdoixwwln .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mvdoixwwln .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mvdoixwwln .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mvdoixwwln .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mvdoixwwln .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mvdoixwwln .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mvdoixwwln .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mvdoixwwln div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sumsq\">sumsq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"meansq\">meansq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">disability</td>\n<td headers=\"df\" class=\"gt_row gt_right\">4</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">30.52143</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">7.630357</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">2.86158</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.03012686</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"df\" class=\"gt_row gt_right\">65</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">173.32143</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">2.666484</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nHypotheses:\n\n\\begin{align}\nH_0 &: \\mu_{none} = \\mu_{amputation} = \\mu_{crutches} = \\mu_{hearing} =  \\mu_{wheelchair}\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\mu_i \\neq \\mu_j \\text{ for } i \\neq j\n\\end{align}\n\nDo we reject or fail to reject $H_0$?\n\n\n\n## Conclusion to hypothesis test\n\n\\begin{align}\nH_0 &: \\mu_{none} = \\mu_{amputation} = \\mu_{crutches} = \\mu_{hearing} =  \\mu_{wheelchair}\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\mu_i \\neq \\mu_j \\text{ for } i \\neq j\n\\end{align}\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nempl_lm  # tidy anova output\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 6\n  term          df sumsq meansq statistic p.value\n  <chr>      <int> <dbl>  <dbl>     <dbl>   <dbl>\n1 disability     4  30.5   7.63      2.86  0.0301\n2 Residuals     65 173.    2.67     NA    NA     \n```\n:::\n\n```{.r .cell-code}\n# Note that this is a vector:\nempl_lm$p.value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03012686         NA\n```\n:::\n:::\n\n\n\nPull the p-value using base R:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(empl_lm$p.value[1],2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03\n```\n:::\n:::\n\n\n\nPull the p-value using tidyverse:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nempl_lm %>% \n  filter(term == \"disability\") %>% \n  pull(p.value) %>% \n  round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03\n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n* Use $\\alpha$ = 0.05.\n* Do we reject or fail to reject $H_0$?\n\n__Conclusion statement__:\n\n* There is sufficient evidence that at least one of the disability groups has a mean employment score statistically different from the other groups. ( $p$-value = 0.03).\n\n:::\n:::\n\n\n## Conditions for ANOVA \n\n[__IF__ ALL of the following conditions hold:]{style=\"color:green\"}\n\n1. The null hypothesis is true\n2. Sample sizes in each group group are large (each $n \\ge 30$) \n    * OR the data are relatively normally distributed in each group\n\n::: columns\n::: {.column width=\"50%\"}\n3. Variability is \"similar\" in all group groups:\n    * Is the within group variability about the same for each group?\n    * As a rough rule of thumb, this condition is _violated if the standard deviation of one group is more than double the standard deviation of another group_\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"48%\"}\nChecking the __equal variance__ condition:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd_groups # previously defined\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  disability    SD\n  <fct>      <dbl>\n1 none        1.79\n2 amputation  1.59\n3 crutches    1.48\n4 hearing     1.53\n5 wheelchair  1.75\n```\n:::\n\n```{.r .cell-code}\nmax(sd_groups$SD) / min(sd_groups$SD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.210425\n```\n:::\n:::\n\n\n\n:::\n:::\n\n[__THEN__ the sampling distribution of the __F-statistic__ is an __F-distribution__]{style=\"color:green\"}\n\n\n## Testing variances (Condition 3)\n\n__Bartlett’s test for equal variances__\n\n* $H_0:$ population variances of group levels are equal\n* $H_A:$ population variances of group levels are NOT equal\n\n_Note: $H_A$ is same as saying that at least one of the group levels has a different variance_\n\n:::{.callout-caution}\n* Bartlett's test assumes the data in each group are normally distributed. \n* Do not use if data do not satisfy the normality condition. \n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(score ~ disability, data = employ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  score by disability\nBartlett's K-squared = 0.7016, df = 4, p-value = 0.9511\n```\n:::\n:::\n\n\n\n:::{.callout-tip}\nLevene's test for equality of variances is not as restrictive: see <https://www.statology.org/levenes-test-r/> \n:::\n\n\n## The F-distribution\n\n* The F-distribution is skewed right.\n* The F-distribution has __[two different degrees of freedom]{style=\"color:green\"}__:\n    * one for the [numerator]{style=\"color:green\"} of the ratio [(k – 1)]{style=\"color:green\"} and \n    * one for the [denominator (N – k)]{style=\"color:green\"}\n\n* [$p$-__value__]{style=\"color:purple\"}  \n    * is always the __[upper tail]{style=\"color:purple\"}__\n    * (the area as extreme or more extreme)\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-39-1.png){width=480}\n:::\n:::\n\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nempl_lm %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"iqmradiezn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#iqmradiezn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#iqmradiezn thead, #iqmradiezn tbody, #iqmradiezn tfoot, #iqmradiezn tr, #iqmradiezn td, #iqmradiezn th {\n  border-style: none;\n}\n\n#iqmradiezn p {\n  margin: 0;\n  padding: 0;\n}\n\n#iqmradiezn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#iqmradiezn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#iqmradiezn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#iqmradiezn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#iqmradiezn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#iqmradiezn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#iqmradiezn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#iqmradiezn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#iqmradiezn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#iqmradiezn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#iqmradiezn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#iqmradiezn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#iqmradiezn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#iqmradiezn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#iqmradiezn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqmradiezn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#iqmradiezn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#iqmradiezn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#iqmradiezn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqmradiezn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#iqmradiezn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqmradiezn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#iqmradiezn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqmradiezn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iqmradiezn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqmradiezn .gt_left {\n  text-align: left;\n}\n\n#iqmradiezn .gt_center {\n  text-align: center;\n}\n\n#iqmradiezn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#iqmradiezn .gt_font_normal {\n  font-weight: normal;\n}\n\n#iqmradiezn .gt_font_bold {\n  font-weight: bold;\n}\n\n#iqmradiezn .gt_font_italic {\n  font-style: italic;\n}\n\n#iqmradiezn .gt_super {\n  font-size: 65%;\n}\n\n#iqmradiezn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#iqmradiezn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#iqmradiezn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#iqmradiezn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#iqmradiezn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#iqmradiezn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#iqmradiezn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#iqmradiezn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#iqmradiezn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sumsq\">sumsq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"meansq\">meansq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">disability</td>\n<td headers=\"df\" class=\"gt_row gt_right\">4</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">30.52143</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">7.630357</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">2.86158</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.03012686</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"df\" class=\"gt_row gt_right\">65</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">173.32143</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">2.666484</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\n# p-value using F-distribution\n\npf(2.86158, df1=5-1, df2=70-5, \n   lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03012688\n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n## Which groups are statistically different?\n\n::: columns\n::: {.column width=\"40%\"}\n\n<br>\n\n* So far we've only determined that _at least one of the groups is different_ from the others, \n    * but we don't know which.\n\n<br>\n\n* What's your guess?\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-41-1.png){width=768}\n:::\n:::\n\n\n\n:::\n:::\n\n\n# Post-hoc testing for ANOVA\n\n_determining which groups are statistically different_\n\n\n## Post-hoc testing: pairwise t-tests\n\n::: columns\n::: {.column width=\"40%\"}\n* In post-hoc testing we [__run all the pairwise t-tests__]{style=\"color:green\"} comparing the means from each pair of groups.\n* With 5 groups, this involves doing ${5 \\choose 2} = \\frac{5!}{2!3!} = \\frac{5\\cdot 4}{2}= 10$ different pairwise tests.\n\n__Problem:__\n\n* Although the ANOVA test has an $\\alpha$ chance of a Type I error (finding a difference between a pair that aren't different), \n* the [overall Type I error rate will be much higher when running many tests simultaneously]{style=\"color:darkorange\"}.\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"58%\"}\n::: {style=\"font-size: 85%;\"}\n\n\\begin{align}\nP(\\text{making an error}) = & \\alpha\\\\\nP(\\text{not making an error}) = & 1-\\alpha\\\\\nP(\\text{not making an error in m tests}) = & (1-\\alpha)^m\\\\\nP(\\text{making at least 1 error in m tests}) = & 1-(1-\\alpha)^m\n\\end{align}\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\n\n:::\n:::\n\n\n## The Bonferroni Correction (1/2)\n\n::: columns\n::: {.column width=\"50%\"}\nA very conservative (but very popular) approach is to divide the $\\alpha$ level by how many tests $m$ are being done:\n\n$$\\alpha_{Bonf} = \\frac{\\alpha}{m}$$\n\n* This is equivalent to multiplying the  \n_p_-values by m:\n\n$$p\\textrm{-value} < \\alpha_{Bonf} = \\frac{\\alpha}{m}$$ \nis the same as\n$$m \\cdot (p\\textrm{-value}) < \\alpha$$\nThe Bonferroni correction is popular since it's very easy to implement.\n:::\n\n::: {.column width=\"50%\"}\n* The __plot below__ shows the __[likelihood of making at least one Type I error]{style=\"color:green\"}__ depending on how may tests are done.\n* Notice the likelihood decreases very quickly\n    * Unfortunately the likelihood of a Type II error is increasing as well\n    * It becomes \"harder\" and harder to reject $H_0$ if doing many tests.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n## The Bonferroni Correction (2/2)\n\n::: columns\n::: {.column width=\"50%\"}\nPairwise t-tests without any _p_-value adjustments:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairwise.t.test(employ$score, \n                employ$disability, \n                p.adj=\"none\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  employ$score and employ$disability \n\n           none   amputation crutches hearing\namputation 0.4477 -          -        -      \ncrutches   0.1028 0.0184     -        -      \nhearing    0.1732 0.5418     0.0035   -      \nwheelchair 0.4756 0.1433     0.3520   0.0401 \n\nP value adjustment method: none \n```\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\nPairwise t-tests __[with Bonferroni _p_-value adjustments]{style=\"color:green\"}__:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairwise.t.test(employ$score,  \n                employ$disability, \n                p.adj=\"bonferroni\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  employ$score and employ$disability \n\n           none  amputation crutches hearing\namputation 1.000 -          -        -      \ncrutches   1.000 0.184      -        -      \nhearing    1.000 1.000      0.035    -      \nwheelchair 1.000 1.000      1.000    0.401  \n\nP value adjustment method: bonferroni \n```\n:::\n:::\n\n\n\n* Since there were 10 tests, all the _p_-values were multiplied by 10.\n* Are there any significant pairwise differences?\n:::\n:::\n\n\n\n## Tukey's Honest Significance Test (HSD)\n\n* Tukey's Honest Significance Test (HSD) controls the \"family-wise probability\" of making a Type I error using a much less conservative method than Bonferroni\n    * __It is specific to ANOVA__\n* In addition to adjusted _p_-values, it also calculates Tukey adjusted CI's for all pairwise differences\n* The function `TukeyHSD()` creates a __set of confidence intervals__ of the differences between means with the specified __family-wise probability of coverage__.\n\n::: columns\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# need to run the model using `aov` instead of `lm`\nempl_aov <- aov(score ~ disability, data = employ) \n\nTukeyHSD(x=empl_aov, conf.level = 0.95) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = score ~ disability, data = employ)\n\n$disability\n                            diff        lwr        upr     p adj\namputation-none       -0.4714286 -2.2031613  1.2603042 0.9399911\ncrutches-none          1.0214286 -0.7103042  2.7531613 0.4686233\nhearing-none          -0.8500000 -2.5817328  0.8817328 0.6442517\nwheelchair-none        0.4428571 -1.2888756  2.1745899 0.9517374\ncrutches-amputation    1.4928571 -0.2388756  3.2245899 0.1232819\nhearing-amputation    -0.3785714 -2.1103042  1.3531613 0.9724743\nwheelchair-amputation  0.9142857 -0.8174470  2.6460185 0.5781165\nhearing-crutches      -1.8714286 -3.6031613 -0.1396958 0.0277842\nwheelchair-crutches   -0.5785714 -2.3103042  1.1531613 0.8812293\nwheelchair-hearing     1.2928571 -0.4388756  3.0245899 0.2348141\n```\n:::\n:::\n\n\n\n:::\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(TukeyHSD(x=empl_aov, \n        conf.level = 0.95))\n```\n\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\n:::\n:::\n\n\n\n## There are many more multiple testing adjustment procedures\n\n::: columns\n::: {.column width=\"49%\"}\n* Bonferroni is popular because it's so easy to apply\n* Tukey's HSD is usually used for ANOVA\n* Code below used Holm's adjustment\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# default is Holm's adjustments\npairwise.t.test(employ$score, \n                employ$disability) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  employ$score and employ$disability \n\n           none  amputation crutches hearing\namputation 1.000 -          -        -      \ncrutches   0.719 0.165      -        -      \nhearing    0.866 1.000      0.035    -      \nwheelchair 1.000 0.860      1.000    0.321  \n\nP value adjustment method: holm \n```\n:::\n:::\n\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n\n::: {.column width=\"49%\"}\n* __False discovery rate (fdr)__ _p_-value adjustments are popular in omics, or whenever there are _many_ tests being run:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairwise.t.test(employ$score, \n                employ$disability, \n                p.adj=\"fdr\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  employ$score and employ$disability \n\n           none  amputation crutches hearing\namputation 0.528 -          -        -      \ncrutches   0.257 0.092      -        -      \nhearing    0.289 0.542      0.035    -      \nwheelchair 0.528 0.287      0.503    0.134  \n\nP value adjustment method: fdr \n```\n:::\n:::\n\n\n\n:::\n:::\n\n\n# Multiple testing\n\n_post-hoc testing vs. testing many outcomes_\n\n![](/img_slides/xkcd_significant2.png){fig-align=\"center\"}\n\n<https://xkcd.com/882/>\n\n\n\n## Multiple testing: controlling the Type I error rate\n\n::: columns\n::: {.column width=\"40%\"}\n* The multiple testing issue is not unique to ANOVA post-hoc testing.\n* It is also a concern when running separate tests for many related outcomes.\n* __[Beware of _p_-hacking!]{style=\"color:darkorange\"}__\n\n__Problem:__\n\n* Although one test has an $\\alpha$ chance of a Type I error (finding a difference between a pair that aren't different), \n* the [__overall Type I error rate will be much higher when running many tests simultaneously__]{style=\"color:darkorange\"}.\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n::: {.column width=\"58%\"}\n::: {style=\"font-size: 85%;\"}\n\n\\begin{align}\nP(\\text{making an error}) = & \\alpha\\\\\nP(\\text{not making an error}) = & 1-\\alpha\\\\\nP(\\text{not making an error in m tests}) = & (1-\\alpha)^m\\\\\nP(\\text{making at least 1 error in m tests}) = & 1-(1-\\alpha)^m\n\\end{align}\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n\n\n:::\n:::\n\n## ANOVA Summary\n\n::: {style=\"font-size: 90%;\"}\n\n\\begin{align}\nH_0 &: \\mu_1 = \\mu_2 = ... = \\mu_k\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\mu_i \\neq \\mu_j \\text{ for } i \\neq j\n\\end{align}\n\n:::\n\nANOVA table in R:\n\n::: {style=\"font-size: 90%;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(score ~ disability, data = employ) %>% anova()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: score\n           Df  Sum Sq Mean Sq F value  Pr(>F)  \ndisability  4  30.521  7.6304  2.8616 0.03013 *\nResiduals  65 173.321  2.6665                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n\nANOVA table\n\n![](/img_slides/anova_table.png){fig-align=\"center\"}\n\nPost-hoc testing\n:::\n\n::: {.column width=\"50%\"}\nF-distribution & p-value\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](14_ANOVA_files/figure-html/unnamed-chunk-53-1.png){width=480}\n:::\n:::\n\n\n:::\n:::\n\n\n## What's next?\n\n<br>\n<br>\n\n![](/img_slides/flowchart_only_continuous.jpg){fig-align=\"center\"}\n\n\n\n",
    "supporting": [
      "14_ANOVA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}