{
  "hash": "bf75fdb635ce50b930690c097299df2c",
  "result": {
    "markdown": "---\ntitle: \"R06: `ggplot2`, Part 1\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"10/16/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: R06 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n::: {.cell}\n<style type=\"text/css\">\n.reveal code {\n  max-height: 100% !important;\n}\n</style>\n:::\n\n\n\n# Summarizing categorical data and some data wrangling\n\n<!-- ::: {layout-ncol=3} -->\n\n:::::: columns\n::: {.column width=\"33%\"}\n![[dplyr](https://dplyr.tidyverse.org/)](../img_slides/hex-dplyr.png){fig-align=\"center\" height=\"300\"}\n:::\n\n::: {.column width=\"33%\"}\n![[magrittr](https://magrittr.tidyverse.org/)](../img_slides/magrittr.png){fig-align=\"center\" height=\"300\"}\n:::\n\n::: {.column width=\"33%\"}\n![[janitor](https://cran.r-project.org/web/packages/janitor/readme/README.html)](../img_slides/janitor_logo_small.png){fig-align=\"center\" height=\"300\"}\n:::\n::::::\n\n## Frequency tables: `count()`\n\n::::: columns\n::: {.column width=\"50%\"}\n-   `count` is from the `dplyr` package\n-   the output is a long tibble, and not a \"nice\" table\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% count(ethnicity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 2\n  ethnicity              n\n  <fct>              <int>\n1 American Indian        4\n2 Asian                129\n3 Black                 59\n4 Hispanic             376\n5 Multi Race            26\n6 Native Hawaiian        3\n7 Other                  2\n8 White not Hispanic   401\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% \n  count(ethnicity, age.cohort)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 35 × 3\n   ethnicity       age.cohort     n\n   <fct>           <fct>      <int>\n 1 American Indian 13-17          1\n 2 American Indian 22-50          1\n 3 American Indian 51+            2\n 4 Asian           0-5            8\n 5 Asian           6-12          18\n 6 Asian           13-17         20\n 7 Asian           18-21         41\n 8 Asian           22-50         29\n 9 Asian           51+           13\n10 Black           0-5            3\n# ℹ 25 more rows\n```\n:::\n:::\n\n:::\n:::::\n\n## How to use the pipe `%>%`\n\nThe pipe operator `%>%` strings together commands to be performed sequentially\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% head(n=3)      # pronounce %>% as \"then\"\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 6\n     id age.cohort   age gender expenditures ethnicity         \n  <int> <fct>      <int> <fct>         <int> <fct>             \n1 10210 13-17         17 Female         2113 White not Hispanic\n2 10409 22-50         37 Male          41924 White not Hispanic\n3 10486 0-5            3 Male           1454 Hispanic          \n```\n:::\n:::\n\n\n-   Always *first list the tibble* that the commands are being applied to\n-   Can use **multiple pipes** to run multiple commands in sequence\n    -   What does the following code do?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% head(n=3) %>% summary()\n```\n:::\n\n\n## Frequency tables: `janitor` package's `tabyl` function\n\n::::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\n# default table\ndds.discr %>% \n  tabyl(ethnicity)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          ethnicity   n percent\n    American Indian   4   0.004\n              Asian 129   0.129\n              Black  59   0.059\n           Hispanic 376   0.376\n         Multi Race  26   0.026\n    Native Hawaiian   3   0.003\n              Other   2   0.002\n White not Hispanic 401   0.401\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n`adorn_` your table!\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"3-4\"}\ndds.discr %>% \n  tabyl(ethnicity) %>%\n  adorn_totals(\"row\") %>% \n  adorn_pct_formatting(digits=2)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          ethnicity    n percent\n    American Indian    4   0.40%\n              Asian  129  12.90%\n              Black   59   5.90%\n           Hispanic  376  37.60%\n         Multi Race   26   2.60%\n    Native Hawaiian    3   0.30%\n              Other    2   0.20%\n White not Hispanic  401  40.10%\n              Total 1000 100.00%\n```\n:::\n:::\n\n:::\n:::::\n\n## Relative frequency table\n\n::::: columns\n::: {.column width=\"40%\"}\n-   A **relative frequency** table shows **proportions (or percentages)** instead of counts\n\n-   To the right I removed (deselected) the counts column (`n`) to create a relative frequency table\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"4-5\"}\ndds.discr %>% \n  tabyl(ethnicity) %>%\n  adorn_totals(\"row\") %>% \n  adorn_pct_formatting(digits=2) %>%   \n  select(-n) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          ethnicity percent\n    American Indian   0.40%\n              Asian  12.90%\n              Black   5.90%\n           Hispanic  37.60%\n         Multi Race   2.60%\n    Native Hawaiian   0.30%\n              Other   0.20%\n White not Hispanic  40.10%\n              Total 100.00%\n```\n:::\n:::\n\n:::\n:::::\n\n## Contingency tables (two-way tables)\n\n::::: columns\n::: {.column width=\"40%\"}\n-   **Contingency tables** summarize data for two categorical variables\n    -   with each value in the table representing the number of times\\\n        a particular combination of outcomes occurs\n-   **Row & column totals**\\\n    are sometimes called **marginal totals**\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"2-3\"}\ndds.discr %>% \n  tabyl(ethnicity, gender) %>%    \n  adorn_totals(c(\"row\", \"col\"))    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          ethnicity Female Male Total\n    American Indian      3    1     4\n              Asian     61   68   129\n              Black     26   33    59\n           Hispanic    192  184   376\n         Multi Race     13   13    26\n    Native Hawaiian      2    1     3\n              Other      1    1     2\n White not Hispanic    205  196   401\n              Total    503  497  1000\n```\n:::\n:::\n\n:::\n:::::\n\n## Contingency tables with percentages\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"4-6\"}\ndds.discr %>% \n  tabyl(ethnicity, age.cohort) %>%\n  adorn_totals(c(\"row\")) %>%\n  adorn_percentages(\"row\") %>%   \n  adorn_pct_formatting(digits=0) %>%    \n  adorn_ns()    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          ethnicity      0-5      6-12      13-17     18-21     22-50       51+\n    American Indian  0%  (0)  0%   (0)  25%   (1)  0%   (0) 25%   (1) 50%   (2)\n              Asian  6%  (8) 14%  (18)  16%  (20) 32%  (41) 22%  (29) 10%  (13)\n              Black  5%  (3) 19%  (11)  20%  (12) 15%   (9) 29%  (17) 12%   (7)\n           Hispanic 12% (44) 24%  (91)  27% (103) 21%  (78) 11%  (43)  5%  (17)\n         Multi Race 27%  (7) 35%   (9)  27%   (7)  8%   (2)  4%   (1)  0%   (0)\n    Native Hawaiian  0%  (0)  0%   (0)   0%   (0)  0%   (0) 67%   (2) 33%   (1)\n              Other  0%  (0)  0%   (0) 100%   (2)  0%   (0)  0%   (0)  0%   (0)\n White not Hispanic  5% (20) 11%  (46)  17%  (67) 17%  (69) 33% (133) 16%  (66)\n              Total  8% (82) 18% (175)  21% (212) 20% (199) 23% (226) 11% (106)\n```\n:::\n:::\n\n\n# Summarizing numeric data\n\n## Mean annual DDS expenditures by race/ethnicity\n\n::::: columns\n::: {.column width=\"45%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(dds.discr$expenditures)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18065.79\n```\n:::\n\n```{.r .cell-code}\ndds.discr %>% \n  summarize(\n    ave = mean(expenditures),\n    SD = sd(expenditures),\n    med = median(expenditures))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 3\n     ave     SD   med\n   <dbl>  <dbl> <dbl>\n1 18066. 19543.  7026\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"55%\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ndds.discr %>% \n  group_by(ethnicity) %>% \n  summarize(\n    ave = mean(expenditures),\n    SD = sd(expenditures),\n    med = median(expenditures))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 4\n  ethnicity             ave     SD    med\n  <fct>               <dbl>  <dbl>  <dbl>\n1 American Indian    36438. 25694. 41818.\n2 Asian              18392. 19209.  9369 \n3 Black              20885. 20549.  8687 \n4 Hispanic           11066. 15630.  3952 \n5 Multi Race          4457.  7332.  2622 \n6 Native Hawaiian    42782.  6576. 40727 \n7 Other               3316.  1836.  3316.\n8 White not Hispanic 24698. 20604. 15718 \n```\n:::\n:::\n\n:::\n:::::\n\n## `get_summary_stats()` from `rstatix` package\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% get_summary_stats()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 13\n  variable         n   min   max median     q1     q3   iqr    mad   mean     sd\n  <fct>        <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>\n1 id            1000 10210 99898 55384. 31809. 76135. 44326 3.27e4 5.47e4 2.56e4\n2 age           1000     0    95    18     12     26     14 1.04e1 2.28e1 1.85e1\n3 expenditures  1000   222 75098  7026   2899. 37713. 34814 7.76e3 1.81e4 1.95e4\n# ℹ 2 more variables: se <dbl>, ci <dbl>\n```\n:::\n\n```{.r .cell-code}\ndds.discr %>% \n  group_by(ethnicity) %>%\n  get_summary_stats(expenditures, type = \"common\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 11\n  ethnicity variable     n   min   max median    iqr   mean     sd     se     ci\n  <fct>     <fct>    <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1 American… expendi…     4  3726 58392 41818. 34085. 36438. 25694. 12847. 40885.\n2 Asian     expendi…   129   374 75098  9369  30892  18392. 19209.  1691.  3346.\n3 Black     expendi…    59   240 60808  8687  37987  20885. 20549.  2675.  5355.\n4 Hispanic  expendi…   376   222 65581  3952   7961. 11066. 15630.   806.  1585.\n5 Multi Ra… expendi…    26   669 38619  2622   2060.  4457.  7332.  1438.  2962.\n6 Native H… expendi…     3 37479 50141 40727   6331  42782.  6576.  3797. 16337.\n7 Other     expendi…     2  2018  4615  3316.  1298.  3316.  1836.  1298. 16499.\n8 White no… expendi…   401   340 68890 15718  39157  24698. 20604.  1029.  2023.\n```\n:::\n:::\n\n\n## How to force all output to be shown? (1/2)\n\nUse `kable()` from the `knitr` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% get_summary_stats() %>% kable()\n```\n\n::: {.cell-output-display}\n|variable     |    n|   min|   max|  median|       q1|       q3|   iqr|       mad|     mean|        sd|      se|       ci|\n|:------------|----:|-----:|-----:|-------:|--------:|--------:|-----:|---------:|--------:|---------:|-------:|--------:|\n|id           | 1000| 10210| 99898| 55384.5| 31808.75| 76134.75| 44326| 32734.325| 54662.85| 25643.673| 810.924| 1591.310|\n|age          | 1000|     0|    95|    18.0|    12.00|    26.00|    14|    10.378|    22.80|    18.462|   0.584|    1.146|\n|expenditures | 1000|   222| 75098|  7026.0|  2898.75| 37712.75| 34814|  7760.670| 18065.79| 19542.831| 617.999| 1212.724|\n:::\n:::\n\n\n## How to force all output to be shown? `knitr` (2/2)\n\nUse `kable()` from the `knitr` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr %>% \n  group_by(ethnicity) %>%\n  get_summary_stats(expenditures, type = \"common\") %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|ethnicity          |variable     |   n|   min|   max|  median|      iqr|      mean|        sd|        se|        ci|\n|:------------------|:------------|---:|-----:|-----:|-------:|--------:|---------:|---------:|---------:|---------:|\n|American Indian    |expenditures |   4|  3726| 58392| 41817.5| 34085.25| 36438.250| 25693.912| 12846.956| 40884.748|\n|Asian              |expenditures | 129|   374| 75098|  9369.0| 30892.00| 18392.372| 19209.225|  1691.278|  3346.482|\n|Black              |expenditures |  59|   240| 60808|  8687.0| 37987.00| 20884.593| 20549.274|  2675.288|  5355.170|\n|Hispanic           |expenditures | 376|   222| 65581|  3952.0|  7961.25| 11065.569| 15629.847|   806.048|  1584.940|\n|Multi Race         |expenditures |  26|   669| 38619|  2622.0|  2059.75|  4456.731|  7332.135|  1437.950|  2961.514|\n|Native Hawaiian    |expenditures |   3| 37479| 50141| 40727.0|  6331.00| 42782.333|  6576.462|  3796.922| 16336.838|\n|Other              |expenditures |   2|  2018|  4615|  3316.5|  1298.50|  3316.500|  1836.356|  1298.500| 16499.007|\n|White not Hispanic |expenditures | 401|   340| 68890| 15718.0| 39157.00| 24697.549| 20604.376|  1028.933|  2022.793|\n:::\n:::\n\n\n# Back to research question\n\n## Case study: discrimination in developmental disability support (1.7.1)\n\n-   **Previous research**\n    -   Researchers examined DDS expenditures for developmentally disabled residents by ethnicity\n    -   Found that the mean annual expenditures on Hispanics was less than that on White non-Hispanics.\n-   **Result**: an allegation of ethnic discrimination was brought against the California DDS.\n-   **Question: Are the data sufficient evidence of ethnic discrimination?**\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}