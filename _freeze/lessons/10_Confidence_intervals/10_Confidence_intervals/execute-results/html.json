{
  "hash": "f6bb3a2fa1e1d8d2cea5fcbb955d492d",
  "result": {
    "markdown": "---\ntitle: \"Lesson 10: Confidence intervals\"\nsubtitle: \"TB sections 4.2\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"11/04/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 10 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n# Learning Objectives\n1. Calculate a confidence interval when we know the population standard deviation\n2. Interpret a confidence interval when we know the population standard deviation\n3. Calculate and interpret a confidence interval *using the t-distribution* when we do not know the population standard deviation\n\n# Learning Objectives\n\n::: lob\n1. Calculate a confidence interval when we know the population standard deviation\n:::\n\n2. Interpret a confidence interval when we know the population standard deviation\n3. Calculate and interpret a confidence interval *using the t-distribution* when we do not know the population standard deviation\n\n\n## Last time: Central Limit Theorem applied to sampling distribution\n\n- CLT tells us that we can model the sampling distribution of mean heights using a normal distribution\n\n::::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-2-1.png){width=864}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-3-1.png){width=864}\n:::\n:::\n\n\n::: blue\n$$\\overline{X} \\sim \\text{Normal}\\big(\\mu_{\\overline{X}}=65, SE = 0.424 \\big)$$\n:::\n\n:::\n:::::\n\n## Last time: Sampling Distribution of Sample Means (with the CLT)\n\n:::::::: columns\n:::::: {.column width=\"65%\"}\n-   The [**sampling distribution**]{style=\"color:#E75B5C\"} is the distribution of sample means calculated from repeated random samples of *the same size* from the same population\n\n-   It is useful to think of a **particular sample statistic** as being **drawn from a** [**sampling distribution**]{style=\"color:#E75B5C\"}\n\n    -   So the red sample with $\\overline{x} = 65.1$ is **just one sample mean** in the **sampling distribution**\n\n::::: blue\n::: blue-ttl\nWith CLT and $\\overline{X}$ as the RV for the [**sampling distribution**]{style=\"color:#E75B5C\"}\n:::\n\n::: blue-cont\n-   **Theoretically** (using only population values): $\\overline{X} \\sim \\text{Normal} \\big(\\mu_{\\overline{X}} = \\mu, \\sigma_{\\overline{X}}= SE = \\frac{\\sigma}{\\sqrt{n}} \\big)$\n-   **In real use** (using sample values for SE): $\\overline{X} \\sim \\text{Normal} \\big(\\mu_{\\overline{X}} = \\mu, \\sigma_{\\overline{X}}= SE = \\frac{s}{\\sqrt{n}} \\big)$\n:::\n:::::\n::::::\n\n::: {.column width=\"35%\"}\n \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-4-1.png){width=624}\n:::\n:::\n\n\n$$ \\mu_{\\overline{X}} = 65 \\text{ inches}$$ $$ SE = 0.424 \\text{ inches}$$\n:::\n::::::::\n\n## Last time: point estimates\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=1728}\n:::\n:::\n\n\n![](../img_slides/sample_point_est.png){fig-align=\"center\"}\n\n## This time: Interval estimates of population parameter\n\n-   A **point estimate** consists of a single value\n\n-   An **interval estimate** provides a **plausible range of values for a parameter**\n\n    -   Remember: parameters are from the population and estimates are from our sample\n\n-   We can create a plausible range of values for a population mean ($\\mu$) from a sample's mean $\\overline{x}$\n\n-   A **confidence interval** gives us a plausible range for $\\mu$\n\n-   Confidence intervals take the general form: $$\\big(\\overline{x} - m, \\overline{x} + m \\big) = \\overline{x} \\pm m$$\n\n    -   Where $m$ is the margin of error\n\n## Point estimates with their confidence intervals for $\\mu$\n\n:::::: columns\n::: {.column width=\"22%\"}\n \n\n![](../img_slides/samp_point_est_vert.png){fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=864}\n:::\n:::\n\n:::\n\n::: {.column width=\"28%\"}\nDo these confidence intervals include $\\mu$?\n:::\n::::::\n\n## Poll Everywhere Question 1\n\n## Confidence interval (CI) for the mean $\\mu$\n\n::::::::: columns\n:::::: {.column width=\"45%\"}\n::::: green\n::: green-ttl\nConfidence interval for $\\mu$\n:::\n\n::: green-cont\n$$\\overline{x}\\ \\pm\\ z^*\\times \\text{SE}$$\n\n- with $\\text{SE} = \\frac{\\sigma}{\\sqrt{n}}$ if population sd is known\n:::\n:::::\n::::::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"50%\"}\n \n\n[When can this be applied?]{style=\"color:#459B99\"}\n\n-   When CLT can be applied!\n-   When we know the population standard deviation!\n:::\n:::::::::\n\n-   $z^*$ depends on the confidence level\n-   For a 95% CI, $z^*$ is chosen such that 95% of the standard normal curve is between $-z^*$ and $z^*$\n    -   This corresponds to $z^* = 1.96$ for a 95% CI\n-   We can use `R` to calculate $z^*$ for any desired CI\n-   Below is how we calculate $z^*$ for the 95% CI\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqnorm(p = 0.975)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.959964\n```\n:::\n:::\n\n\n## Example: CI for mean height $\\mu$ with $\\sigma$\n\n::::: example\n::: ex-ttl\nExample 1: Using our green sample from previous plots\n:::\n\n::: ex-cont\nFor a random sample of 50 people, the mean height is 66.1 inches. Assume the population standard deviation is 3 inches. Find the 95% confidence interval for the population mean.\n:::\n:::::\n\n$$\n\\begin{aligned}\n\\overline{x} \\pm \\ & z^* \\times \\text{SE} \\\\\n\\overline{x} \\pm \\ & z^* \\times \\dfrac{\\sigma}{\\sqrt{n}} \\\\\n66.1 \\pm \\ & 1.96 \\times \\dfrac{3}{\\sqrt{50}} \\\\\n66.1 \\pm \\ & 0.8315576 \\\\\n(66.1 - 0.8315576, & \\ 66.1 + 0.8315576)\\\\\n(65.268, & \\ 66.932)\\\\\n\\end{aligned}\n$$\n\nWe are 95% confident that the mean height is between 65.268 and 66.932 inches.\n\n# Learning Objectives\n1. Calculate a confidence interval when we know the population standard deviation\n\n::: lob\n2. Interpret a confidence interval when we know the population standard deviation\n:::\n\n3. Calculate and interpret a confidence interval *using the t-distribution* when we do not know the population standard deviation\n\n## How do we interpret confidence intervals? (1/2)\n\n::::::: columns\n:::: {.column width=\"55%\"}\nSimulating Confidence Intervals: <http://www.rossmanchance.com/applets/ConfSim.html>\n\nThe figure shows CI's from 100 simulations:\n\n-   The true value of $\\mu =65$ is the vertical black line\n-   The horizontal lines are 95% CI's from 100 samples\n    -   [**Blue**]{style=\"color:#3070BF\"}: the CI \"captured\" the true value of $\\mu$\n    -   [**Red**]{style=\"color:#C83532\"}: the CI *did not* \"capture\" the true value of $\\mu$\n\n<br>\n\n::: lob\nWhat percent of CI's captured the true value of $\\mu$?\n:::\n::::\n\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"25%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Confidence_intervals_files/figure-revealjs/unnamed-chunk-8-1.png){width=480}\n:::\n:::\n\n:::\n:::::::\n\n## How do we interpret confidence intervals? (2/2)\n\n[Actual interpretation:]{style=\"color:#459B99\"}\n\n-   If we were to\n    -   **repeatedly take random samples** from a population and\n    -   calculate a 95% CI for each random sample,\n-   then we would **expect 95% of our CI's to contain the true population parameter** $\\mu$.\n\n<!-- \"Real life\": -->\n\n<!-- * We typically only take 1 random sample.   -->\n\n<!-- * How do we know if our CI is a lucky or unlucky one? -->\n\n[What we typically write as \"shorthand\":]{style=\"color:#459B99\"}\n\n-   In general form: We are 95% *confident* that (the 95% confidence interval) captures the value of the population parameter.\n\n[WRONG interpretation:]{style=\"color:#BF396F\"}\n\n-   There is a 95% *chance* that (the 95% confidence interval) captures the value of the population parameter.\n    -   For one CI on its own, it either does or doesn't contain the population parameter with probability 0 or 1. We just don't know which!\n\n## Poll Everywhere Question 2\n\n::::: columns\n::: {.column width=\"28%\"}\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n:::\n\n::: {.column width=\"70%\"}\n\n \n\n:::\n:::::\n\n# Learning Objectives\n1. Calculate a confidence interval when we know the population standard deviation\n2. Interpret a confidence interval when we know the population standard deviation\n\n::: lob\n3. Calculate and interpret a confidence interval *using the t-distribution* when we do not know the population standard deviation\n:::\n\n## What if we don't know $\\sigma$ ? (1/2)\n\nSimulating Confidence Intervals: <http://www.rossmanchance.com/applets/ConfSim.html>\n\n![](../img_slides/simulating_CI_RossmanChance.png){fig-align=\"center\"}\n\n- The normal distribution doesn't have a 95% \"coverage rate\" when using $s$ instead of $\\sigma$ \n- There's another distribution, called the t-distribution, that does have a 95% \"coverage rate\" when we use $s$\n\n## Poll Everywhere Question 3\n\n## What if we don't know $\\sigma$ ? (2/2)\n\n-   In real life, we don't know what the population sd is ( $\\sigma$ )\n\n-   If we replace $\\sigma$ with $s$ in the SE formula, we add in additional variability to the SE! $$\\frac{\\sigma}{\\sqrt{n}} ~~~~\\textrm{vs.} ~~~~ \\frac{s}{\\sqrt{n}}$$\n\n-   Thus when using $s$ instead of $\\sigma$ when calculating the SE, we **need a different probability distribution** with thicker tails than the normal distribution.\n\n    -   [In practice this will mean using a different value than 1.96 when calculating the CI]{style=\"color:#C83532\"}\n    \n- Instead, we use the **Student's t-distribution**\n\n## Student's t-distribution\n\n::::: columns\n::: {.column width=\"53%\"}\n\n-   Is bell shaped and symmetric\n-   A \"generalized\" version of the normal distribution\n\n \n\n-   Its tails are a thicker than that of a normal distribution\n    -   The \"thickness\" depends on its **degrees of freedom**: $df = n–1$ , where n = sample size\n    \n \n\n-   As the degrees of freedom (sample size) increase,\n    -   the tails are less thick, and\n    -   the t-distribution is more like a normal distribution\n    -   in theory, with an infinite sample size the *t*-distribution is a normal distribution.\n:::\n\n::: {.column width=\"47%\"}\n<br> <br>\n\n![](../img_slides/t_dist.png){fig-align=\"center\"}\n:::\n:::::\n\n## Confidence interval (CI) for the mean $\\mu$\n\n::::::::: columns\n:::::: {.column width=\"45%\"}\n::::: green\n::: green-ttl\nConfidence interval for $\\mu$\n:::\n\n::: green-cont\n$$\\overline{x}\\ \\pm\\ t^*\\times \\text{SE}$$\n\n- with $\\text{SE} = \\frac{s}{\\sqrt{n}}$ if population sd is not known\n\n:::\n:::::\n::::::\n\n::: {.column width=\"5%\"}\n:::\n\n::: {.column width=\"50%\"}\n \n\n[When can this be applied?]{style=\"color:#459B99\"}\n\n-   When CLT can be applied!\n-   When we **do not** know the population standard deviation!\n:::\n:::::::::\n\n::: columns\n::: {.column width=\"57%\"}\n-   $t^*$ depends on the confidence level and degrees of freedom    \n    - degrees of freedom (df) is: $df=n-1$ (n is number of observations in sample)\n-   `qt` gives the quartiles for a t-distribution. Need to specify\n    -   the percent under the curve to the left of the quartile\n    -   the degrees of freedom = $n-1$\n-   Note in the R output to the right that $t^*$ gets closer to 1.96 as the sample size increases\n:::\n\n::: {.column width=\"43%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nqt(p = 0.975, df=9)  #df = n-1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.262157\n```\n:::\n\n```{.r .cell-code}\nqt(p = 0.975, df=49)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.009575\n```\n:::\n\n```{.r .cell-code}\nqt(p = 0.975, df=99)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.984217\n```\n:::\n\n```{.r .cell-code}\nqt(p = 0.975, df=999)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.962341\n```\n:::\n:::\n\n:::\n:::\n\n## Example:  CI for mean height $\\mu$ with $s$\n\n::::: example\n::: ex-ttl\nExample 2: Using our green sample from previous plots\n:::\n\n::: ex-cont\n\nFor a random sample of 50 people, the mean height is 66.1 inches and the standard deviation is 3.5 inches. Find the 95% confidence interval for the population mean.\n:::\n:::::\n\n::: columns\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\overline{x} \\pm \\ & t^* \\times \\text{SE} \\\\\n\\overline{x} \\pm \\ & t^* \\times \\dfrac{s}{\\sqrt{n}} \\\\\n66.1 \\pm \\ & 2.0096 \\times \\dfrac{3.5}{\\sqrt{50}} \\\\\n66.1 \\pm \\ & 0.994689 \\\\\n(66.1 - 0.994689, & \\ 66.1 + 0.994689)\\\\\n(65.105, & \\ 67.095)\\\\\n\\end{aligned}\n$$\n:::\n\n::: {.column width=\"50%\"}\n\n \n\nWhat is $t^*$?\n$$df = n-1 = 50-1=49$$\n$t^* =$ `qt(p = 0.975, df = 49)` $= 2.0096$\n\n:::\n:::\nWe are 95% confident that the mean height is between 65.105 and 67.095 inches.\n\n## Confidence interval (CI) for the mean $\\mu$ ($z$ vs. $t$)\n\n- In summary, we have two cases that lead to different ways to calculate the confidence interval\n\n::::: columns\n::: {.column width=\"50%\"}\n::: blue2\n::: blue2-ttl\nCase 1: We know the population standard deviation\n:::\n::: blue2-cont\n$$\\overline{x}\\ \\pm\\ z^*\\times \\text{SE}$$\n\n- with $\\text{SE} = \\frac{\\sigma}{\\sqrt{n}}$ and $\\sigma$ is the population standard deviation\n\n \n\n- For 95% CI, we use:\n  - $z^* =$ `qnorm(p = 0.975)` $=1.96$\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n::: red\n::: red-ttl\nCase 2: We **do not** know the population sd\n:::\n::: red-cont\n$$\\overline{x}\\ \\pm\\ t^*\\times \\text{SE}$$\n\n- with $\\text{SE} = \\frac{s}{\\sqrt{n}}$ and $s$ is the sample standard deviation\n\n \n\n- For 95% CI, we use:\n  - $t^* =$ `qt(p = 0.975, df = n-1)`\n:::\n:::\n:::\n:::::\n\n## Some final words (said slightly differently?)\n\n- Rule of thumb:\n    - Use [normal distribution ONLY if you know the population standard deviation $\\sigma$]{style=\"color:#3070BF\"}\n    - If [using $s$ for the $SE$, then use the Student's t-distribution]{style=\"color:#C83532\"}\n\n \n\n- For either case, we need to remember when we can calculate the confidence interval:\n  - $n \\geq 30$ and population distribution not strongly skewed (using Central Limit Theorem)\n      - If there is skew or some large outliers, then $n \\geq 50$ gives better estimates\n  - $n < 30$ and data approximately symmetric with no large outliers\n\n \n\n- *If do not know population distribution, then check the distribution of the data.*\n  - Aka, use what we learned in datavisualization to see what the data look like\n\n",
    "supporting": [
      "10_Confidence_intervals_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}