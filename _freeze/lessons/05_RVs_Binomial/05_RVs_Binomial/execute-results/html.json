{
  "hash": "d8a9bb0c375e77205aba97e70cf5b3c9",
  "result": {
    "markdown": "---\ntitle: \"Lesson 5: Random variables and Binomial distribution\"\nsubtitle: \"TB sections 3.1-3.2\"\nauthor: \"Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"10/14/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 5 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Learning Objectives\n\n1.  Define random variables and how they map to probability distributions\n2.  Calculate the expected value and variance of discrete random variables\n3.  Calculate the expected value and variance of linear combinations of discrete random variables\n4.  Calculate probabilities for different events using a Binomial distribution\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n# Learning Objectives\n\n::: lob\n1.  Define random variables and how they map to probability distributions\n:::\n\n2.  Calculate the expected value and variance of discrete random variables\n3.  Calculate the expected value and variance of linear combinations of discrete random variables\n4.  Calculate probabilities for different events using a Binomial distribution\n\n## Random variables\n\n::::: definition\n::: def-ttl\nRandom variable (RV or r.v.)\n:::\n\n::: def-cont\nA **random variable (r.v.)** assigns numerical values (probability) to the outcome of a random phenomenon\n:::\n:::::\n\nNotation: A random variable is usually denoted with a capital letter such as $X$, $Y$, or $Z$.\n\n## From Lesson 3: Probability distributions\n\n::::::::::: columns\n::::::::: {.column width=\"65%\"}\n::::: definition\n::: def-ttl\nProbability distribution\n:::\n\n::: def-cont\nA **probability distribution** consists of all disjoint outcomes and their associated probabilities.\n:::\n:::::\n\n-   We've already seen one [in our heads and tails example](https://seeing-theory.brown.edu/basic-probability/index.html)\n\n::::: green\n::: green-ttl\nRules for a probability distribution\n:::\n\n::: green-cont\nA probability distribution is a list of all possible outcomes and their associated probabilities that satisfies three rules:\n\n1.  The outcomes listed must be disjoint\n2.  Each probability must be between 0 and 1\n3.  The probabilities must total to 1\n:::\n:::::\n:::::::::\n\n::: {.column width=\"35%\"}\n![](/lessons/img_slides/prob_dist_HT.png){fig-align=\"right\" width=\"498\"}\n:::\n:::::::::::\n\n## In the coin toss example...\n\n-   We can start to define the probability distribution\n\n-   Let's define the coin flip with the random variable $X$\n\n    -   Where $X=1$ if we get a heads and $X=0$ if we get a tails\n\n \n\n-   We can create a table for the random variable and probabilities of each outcome:\n\n    | Coin flip ($x$)        | $x=1$ | $x=0$ |\n    |------------------------|-------|-------|\n    | Probability ($P(X=x)$) | 0.5   | 0.5   |\n\n    -   **Note:** I use $X$ to refer to the random variable and $x$ to refer to the realized value it takes\n    -   Then we write $P(X=x)$ to discuss the probability for each realized value ($x$) of the random variable ($X$)\n\n \n\n-   Also note that the sum of the probabilities equal 1: $\\sum_{x=0}^1 P(X=x) = 1$\n\n## Poll Everywhere Question 1\n\n\n\n## Let's extend this to rolling a die\n\n::::: example\n::: ex-ttl\nExample 1: Rolling a die\n:::\n\n::: ex-cont\nSuppose you roll a fair die. Let the random variable (r.v.) $X$ be the outcome of the roll, i.e. the value of the face showing on the die.\n\n1.  What is the probability distribution of the r.v. $X$?\n:::\n:::::\n\n \n\n![](/lessons/img_slides/die_prob_dist.png)\n\n# Learning Objectives\n\n1.  Define random variables and how they map to probability distributions\n\n::: lob\n2.  Calculate the expected value and variance of discrete random variables\n:::\n\n3.  Calculate the expected value and variance of linear combinations of discrete random variables\n4.  Calculate probabilities for different events using a Binomial distribution\n\n## Discrete vs. continuous random variables\n\n-   Probability distributions are usually either **discrete** or **continuous**, depending on whether the random variable is discrete or continuous.\n\n:::::::::::: columns\n:::::: {.column width=\"47%\"}\n::::: red\n::: red-ttl\nDiscrete random variable\n:::\n\n::: red-cont\nA **discrete** r.v. $X$ takes on a finite number of values or countably infinite number of possible values.\n:::\n:::::\n\nThink:\n\n-   Number of heads in a set of coin tosses\n-   Number of people who have had chicken pox in a random sample\n::::::\n\n::: {.column width=\"2%\"}\n:::\n\n:::::: {.column width=\"49%\"}\n::::: pink2\n::: pink2-ttl\nContinuous random variable\n:::\n\n::: pink2-cont\nA **continuous** r.v. $X$ can take on any real value in an interval of values or unions of intervals.\n:::\n:::::\n\nThink:\n\n-   Height in a population\n-   Blood pressure in a population\n::::::\n::::::::::::\n\n## Expectation of random variables\n\n-   We call the mean of a random variable its **expected value**\n\n-   The expected value is calculated as a **weighted average**\n\n::::: definition\n::: def-ttl\nExpected value of a *discrete* random variable\n:::\n\n::: def-cont\nIf $X$ takes on outcomes $x_1$, ..., $x_k$ with probabilities $P(X=x_1)$, ..., $P(X=x_k)$, the expected value of $X$ is the sum of each outcome multiplied by its corresponding probability: $$\\begin{aligned}\\mu = E[X] = & x_1 P(X=x_1) + x_2 P(X=x_2) + \\ldots + x_k P(X=x_k) \\\\ = & \\sum_{i=1}^k x_iP(X=x_i) \\end{aligned}$$\n:::\n:::::\n\n## Back to rolling a die\n\n:::::: {.column width=\"44%\"}\n::::: example\n::: ex-ttl\nExample 1: Rolling a die\n:::\n\n::: ex-cont\nLet's go back to our fair fie with RV $X$ as the value of the face showing on the die.\n\n2.  What is the expected outcome of the RV $X$?\n\n3.  Now suppose the 6-sided die is not fair. How would we calculate the expected outcome?\n\n| $x$ | $\\mathbb{P}(X=x)$ |\n|-----|-------------------|\n| 1   | 0.10              |\n| 2   | 0.20              |\n| 3   | 0.05              |\n| 4   | 0.05              |\n| 5   | 0.25              |\n| 6   | 0.35              |\n:::\n:::::\n::::::\n\n## Variability of random variables\n\nJust like with data, the variability of a r.v. is described with its variance or standard deviation\n\n::::: definition\n::: def-ttl\nVariance of a discrete random variable\n:::\n\n::: def-cont\nIf $X$ takes on outcomes $x_1$, ..., $x_k$ with probabilities $P(X=x_1)$, ..., $P(X=x_k)$ and expected value  $\\mu=E(X)$, then the variance of $X$, denoted by $\\text{Var}(X)$ or $\\sigma^2$, is\n\n$$\\begin{align*}\n\\text{Var}(X) &= (x_1-\\mu)^2 P(X=x_1) + \\cdots+ (x_k-\\mu)^2 P(X=x_k) \\\\\n    &= \\sum_{i=1}^{k} (x_i - \\mu)^2 P(X=x_i)\n\\end{align*}$$\n:::\n:::::\n\n::::: definition\n::: def-ttl\nStandard deviation of a discrete random variable\n:::\n\n::: def-cont\nThe standard deviation of $X$, labeled $SD(X)$ or $\\sigma$, is $$\\sigma = SD(X) = \\sqrt{\\text{Var}(X)} $$\n:::\n:::::\n\n## Back to rolling a die\n\n:::::: {.column width=\"44%\"}\n::::: example\n::: ex-ttl\nExample 1: Rolling a die\n:::\n\n::: ex-cont\nSuppose you roll a fair 6-sided die. Let the random variable (r.v.)\\* $X$ be the outcome of the roll, i.e. the value of the face showing on the die.\n\n4.  Find the variance and standard deviation of $X$.\n\n| $x$ | $\\mathbb{P}(X=x)$ |\n|-----|-------------------|\n| 1   | 1/6               |\n| 2   | 1/6               |\n| 3   | 1/6               |\n| 4   | 1/6               |\n| 5   | 1/6               |\n| 6   | 1/6               |\n:::\n:::::\n::::::\n\n# Learning Objectives\n\n1.  Define random variables and how they map to probability distributions\n2.  Calculate the expected value and variance of discrete random variables\n\n::: lob\n3.  Calculate the expected value and variance of linear combinations of discrete random variables\n:::\n\n4.  Calculate probabilities for different events using a Binomial distribution\n\n## Linear combinations of random variables\n\n::::: definition\n::: def-ttl\nLinear combinations of random variables\n:::\n\n::: def-cont\nIf $X$ and $Y$ are random variables and $a$ and $b$ are constants, then $$aX + bY$$ is a linear combination of the random variables.\n:::\n:::::\n\n::::: orange\n::: orange-ttl\nTheorem: Expected value of a linear combination of random variables\n:::\n\n::: orange-cont\nIf $X$ and $Y$ are random variables and $a$ and $b$ are constants, then $$E(aX + bY) = aE(X) + bE(Y)$$ and $$E(aX + b) = aE(X) + b$$\n:::\n:::::\n\n## Poll Everywhere Question2\n\n## Keep rolling dice!\n\n::::: example\n::: ex-ttl\nExample: Expected money for rolling 3 dice\n:::\n\n::: ex-cont\nLet the random variables $X_1, X_2, X_3$ be the values shown on rolls for 2 fair 6-sided dice and 1 unfair die (as described in our previous example). Suppose you are given in dollars the amount of the first roll, plus twice the value of the second roll, plus 4 times the value of the unfair die roll. How much money do you expect to get?\n:::\n:::::\n\n## Variance of a linear combination\n\n::::: orange\n::: orange-ttl\nTheorem: Variance of a linear combination of random variables\n:::\n\n::: orange-cont\nIf $X$ and $Y$ are **independent** random variables and $a$ and $b$ are constants, then $$\\text{Var}(aX +bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y)$$\n:::\n:::::\n\n## Keep keep rolling dice!\n\n::::: example\n::: ex-ttl\nExample: Expected money for rolling 3 dice\n:::\n\n::: ex-cont\nLet the random variables $X_1, X_2, X_3$ be the values shown on rolls for 2 fair 6-sided dice and 1 unfair die (as described in our previous example). Suppose you are given in dollars the amount of the first roll, plus twice the value of the second roll, plus 4 times the value of the unfair die roll. What are the variance and standard deviation of the amount you get from the 3 rolls?\n:::\n:::::\n\n# Learning Objectives\n\n1.  Define random variables and how they map to probability distributions\n2.  Calculate the expected value and variance of discrete random variables\n3.  Calculate the expected value and variance of linear combinations of discrete random variables\n\n::: lob\n4.  Calculate probabilities for different events using a Binomial distribution\n:::\n\n## Binomial random variable\n\n-   **One specific type of discrete random variable** is a binomial random variable\n\n::::: definition\n::: def-ttl\nBinomial random variable\n:::\n\n::: def-cont\n-   $X$ is a binomial random variable if it represents the number of successes in $n$ independent replications (or trials) of an experiment where\n\n    -   Each replicate has two possible outcomes: either **success** or **failure**\n    -   The probability of success is $p$\n    -   The probability of failure is $q=1-p$\n:::\n:::::\n\n-   A binomial random variable takes on values $0, 1, 2, \\dots, n$.\n\n-   If a r.v. $X$ is modeled by a Binomial distribution, then we write in shorthand $X \\sim \\text{Binom}(n,p)$\n\n-   Quick example: The number of heads in 3 tosses of a fair coin is a binomial random variable with parameters $n = 3$ and $p = 0.5$.\n\n## Poll Everywhere Question 3\n\n## Bernoulli distribution\n\n-   When $n=1$, aka we have a single trial, we give a different name to the random variable: Bernoulli\n\n::::: definition\n::: def-ttl\nBernoulli random variable\n:::\n\n::: def-cont\n**Bernoulli** random variable. If $X$ is a random variable that takes value 1 with probability of success $p$ and 0 with probability $1-p$ (or $q$), then $X$ is a Bernoulli random variable.\n:::\n:::::\n\n-   We call the probability of success $p$ the **parameter** of the Bernoulli distribution.\n\n-   If a r.v. $X$ is modeled by a Bernoulli distribution, then we write in shorthand $X \\sim \\text{Bernoulli}(p)$ or $X \\sim \\text{Bern}(p)$\n\n::::: orange\n::: orange-ttl\nMean and SD of a Bernoulli r.v.\n:::\n\n::: orange-cont\nIf\\* $X$ is a Bernoulli r.v. with probability of success $p$, then $E(X) = p$ and $\\text{Var}(X) = p(1-p)$\n:::\n:::::\n\n## Relationship between Bernoulli and Binomial[^1]\n\n[^1]: Information on slide heavily borrowed from ChatGPT with prompt: \"can you explain how we go from a bernoulli distribution to a binomial\"\n\n-   The **Bernoulli distribution** is a special case of the Binomial distribution where $n=1$\n\n    -   Specifically: $$\\text{Binomial}(1, p) = \\text{Bernoulli}(p) $$\n\n-   To get a **Binomial distribution**, we simply extend the scenario from a **single** trial to **multiple** independent trials. \n    - If we conduct $n$ independent Bernoulli trials with the same success probability $p$, the total number of successes across these $n$ trials will follow a Binomial distribution\n\n \n\n-   Quick example:\n\n    -   **Bernoulli**: If you flip a coin once, with probability $p=0.5$ of landing heads, that is a Bernoulli trial.\n    -   **Binomial**: If you flip the coin 5 times, and you want to know how many times it will land heads, the number of heads will follow a Binomial distribution with parameters $n=5$ and $p=0.5$\n\n\n## Binomial distribution\n\n::::: definition\n::: def-ttl\nDistribution of a **Binomial** random variable\n:::\n\n::: def-cont\nLet $X$ be the total number of successes in $n$ independent trials, each with probability $p$ of a success. Then probability of observing exactly $k$ successes in $n$ independent trials is \n\n$$P(X = x) = \\binom{n}{x} p^x (1-p)^{n-x},  x= 0, 1, 2, \\dots, n $$\n\n:::\n:::::\n\n-   The parameters of a binomial distribution are $p$ and $n$.\n\n-   If a r.v. $X$ is modeled by a binomial distribution, then we write in shorthand\n\n::: orange\n::: orange-ttl\nMean and variance of a Binomial r.v\n:::\n::: orange-cont\nIf $X$ is a binomial r.v. with probability of success $p$, then $E(X) = np$ and $\\text{Var}(X)=np(1-p)$\n:::\n:::\n\n## Binomial distribution: R commands\n\nR commands with their [input]{style=\"color:#BF396F\"} and [output]{style=\"color:#367B79\"}:\n\n| R code     | What does it return?                                                                                                         |\n|--------------------|----------------------------------------------------|\n| `rbinom()` | returns [sample of random variables]{style=\"color:#367B79\"} with [specified binomial distribution]{style=\"color:#BF396F\"}    |\n| `dbinom()` | returns [probability]{style=\"color:#367B79\"} of getting [certain number of successes]{style=\"color:#BF396F\"}                 |\n| `pbinom()` | returns [cumulative probability]{style=\"color:#367B79\"} of getting [certain number or less]{style=\"color:#BF396F\"} successes |\n| `qbinom()` | returns [number of successes]{style=\"color:#367B79\"} corresponding to [desired quantile]{style=\"color:#BF396F\"}              |\n\n## Binomial distribution example (1/5)\n\n::: example\n::: ex-ttl\nVaccinated people testing positive for Covid-19\n:::\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for Covid-19. Suppose 10 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 10 that tested positive.\n\n1.  What is the expected value of $X$?\n\n2.  What is the SD of $X$?\n\n3.  What is the probability that exactly 4 of the 10 people that tested positive are vaccinated?\n\n4.  What is the probability that at most 3 of the 10 people that tested positive are vaccinated?\n\n5.  What is the probability that at least 5 of the 10 people that tested positive are vaccinated?\n:::\n:::\n\n## Binomial distribution example (2/5)\n\n::: example\n::: ex-ttl\nVaccinated people testing positive for Covid-19\n:::\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for Covid-19. Suppose 10 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 10 that tested positive.\n\n1.  What is the expected value of $X$?\n\n2.  What is the SD of $X$?\n:::\n:::\n\n## Binomial distribution example (3/5)\n\n::: example\n::: ex-ttl\nVaccinated people testing positive for Covid-19\n:::\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for Covid-19. Suppose 10 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 10 that tested positive.\n\n3.  What is the probability that *exactly 4* of the 10 people that tested positive are vaccinated?\n:::\n:::\n\n$$P(X=4) = {10 \\choose 4} 0.25^2 (1-0.25)^{10-4}  = 0.146$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbinom(x = 4, size = 10, prob = 0.25) # d for distribution\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.145998\n```\n:::\n:::\n\n\n- In general, for $P(X=k)$ we code: `dbinom(x = k, size = n, prob = p)`\n\n## Binomial distribution example (4/5)\n\n::: example\n::: ex-ttl\nVaccinated people testing positive for Covid-19\n:::\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for Covid-19. Suppose 10 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 10 that tested positive.\n\n4.  What is the probability that *at most 3* of the 10 people that tested positive are vaccinated?\n:::\n:::\n\n$$\\begin{aligned}\nP(X \\leq 3) = & P(X =0) + P(X = 1) + P(X =2) + P(X = 3) \\\\ = &{10 \\choose 0} 0.25^0 (0.75)^{10} + {10 \\choose 1} 0.25^1 (0.75)^{9} + {10 \\choose 2} 0.25^2 (0.75)^{8}+ {10 \\choose 3} 0.25^3 (0.75)^{7} \\\\\n= & 0.7758\n\\end{aligned}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\npbinom(q = 3, size = 10, prob = 0.25, lower.tail = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7758751\n```\n:::\n:::\n\n\n- In general, for $P(X \\leq k)$ we code: `pbinom(q = k, size = n, prob = p)` with `lower.tail = T` as a default option\n\n## Binomial distribution example (5/5)\n\n::: example\n::: ex-ttl\nVaccinated people testing positive for Covid-19\n:::\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for Covid-19. Suppose 10 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 10 that tested positive.\n\n5.  What is the probability that *at least 5* of the 10 people that tested positive are vaccinated?\n:::\n:::\n\n$$\\begin{aligned}\nP(X \\geq 5) = & P(X =5) + P(X = 6) + P(X =7) + P(X = 8) + P(X = 9)+ P(X = 10) \\\\ = &{10 \\choose 5} 0.25^5 (0.75)^{5} + {10 \\choose 6} 0.25^6 (0.75)^{4} + \\ldots + {10 \\choose 10} 0.25^10 (0.75)^{0}\\\\\n= & 0.7758\n\\end{aligned}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\npbinom(q = 4, size = 10, prob = 0.25, lower.tail = F) # switch to greater than!\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.07812691\n```\n:::\n\n```{.r .cell-code}\n1 - pbinom(q = 4, size = 10, prob = 0.25, lower.tail = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.07812691\n```\n:::\n:::\n\n\n- In general, for $P(X > k)$ we code: `pbinom(q = k, size = n, prob = p, lower.tail = F)` \n\n\n## Resources!\n\n-   [Seeing theory: random variables](https://seeing-theory.brown.edu/probability-distributions/index.html#section1)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}