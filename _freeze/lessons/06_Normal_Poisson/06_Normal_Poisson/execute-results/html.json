{
  "hash": "d7322cce29c959007bbd6bad678bd117",
  "result": {
    "markdown": "---\ntitle: \"Lesson 6: Normal and Poisson distributions\"\nsubtitle: \"TB sections 3.3-3.4\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"10/16/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 6 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n# Learning Objectives\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n# Learning Objectives\n\n## Last time: Discrete vs. continuous random variables\n\n-   Probability distributions are usually either **discrete** or\n    **continuous**, depending on whether the random variable is discrete\n    or continuous.\n\n:::::::::::: columns\n:::::: {.column width=\"47%\"}\n::::: red\n::: red-ttl\nDiscrete random variable\n:::\n\n::: red-cont\nA **discrete** r.v. $X$ takes on a finite number of values or countably\ninfinite number of possible values.\n:::\n:::::\n\nThink:\n\n-   Number of heads in a set of coin tosses\n-   Number of people who have had chicken pox in a random sample\n::::::\n\n::: {.column width=\"2%\"}\n:::\n\n:::::: {.column width=\"49%\"}\n::::: pink2\n::: pink2-ttl\nContinuous random variable\n:::\n\n::: pink2-cont\nA **continuous** r.v. $X$ can take on any real value in an interval of\nvalues or unions of intervals.\n:::\n:::::\n\nThink:\n\n-   Height in a population\n-   Blood pressure in a population\n::::::\n::::::::::::\n\n## Probabilities for continuous distributions\n\nTwo important features of continuous distributions:\n\n-   The total area under the density curve is 1.\n\n-   The probability that a variable has a value within a specified\n    interval is the area under the curve over that interval.\n\n![](../img_slides/fdicHeightContDistFilled.png){fig-align=\"center\"}\n\n## Probabilities for continuous distributions...\n\nWhen working with continuous random variables, probability is found for\nintervals of values rather than individual values.\n\n-   The probability that a continuous r.v. $X$ takes on any single\n    individual value is 0. That is, $P(X = x) = 0$.\n\n-   Thus, $P(a < X < b)$ is equivalent to $P(a \\leq X \\leq b)$.\n\n## Standard Normal Distribution\n\n![Transformation from general normal $X$ to standard normal\n$Z$](../img_slides/X_to_Z_transformation_Brase.png){width=\"5in\"}\n\n## Standard Normal Distribution\n\n-   A *standard normal* distribution is defined as a normal distribution\n    with mean 0 and variance 1. It is often denoted as $Z \\sim N(0, 1)$.\n\n-   Any normal random variable $X$ can be transformed into a standard\n    normal random variable $Z$.\n\n$$Z = \\dfrac{X - \\mu}{\\sigma} \\qquad X = \\mu + Z\\sigma$$\n\n-   The $Z$-score of an observation quantifies how far the observation is from the mean, in units of standard deviation(s).\n\n-   For example, if an observation has $Z$-score $z = 3.4$, then the observation is 3.4 standard deviations above the mean.\n\n## Normal distribution\n\n- Shorthand\n\n\n## Normal distribution: R commands\n\nR commands with their [input]{style=\"color:#BF396F\"} and\n[output]{style=\"color:#367B79\"}:\n\n+------------------+--------------------------------------------------+\n| R code           | What does it return?                             |\n+==================+==================================================+\n| `rnorm()`        | returns [sample of random                        |\n|                  | variables]{style=\"color:#367B79\"} with           |\n|                  | [specified normal                                |\n|                  | distribution]{style=\"color:#BF396F\"}             |\n+------------------+--------------------------------------------------+\n| `dnorm()`        | returns [value of probability                    |\n|                  | density]{style=\"color:#367B79\"} at [certain      |\n|                  | point of the normal                              |\n|                  | distribution]{style=\"color:#BF396F\"}             |\n|                  |                                                  |\n|                  | -   Not typically used                           |\n+------------------+--------------------------------------------------+\n| `pnorm()`        | returns [cumulative                              |\n|                  | probability]{style=\"color:#367B79\"} of getting   |\n|                  | [certain point (or less) of the normal           |\n|                  | distribution]{style=\"color:#BF396F\"}             |\n+------------------+--------------------------------------------------+\n| `qnorm()`        | returns [z-score]{style=\"color:#367B79\"}        |\n|                  | corresponding to [desired                        |\n|                  | quantile]{style=\"color:#BF396F\"}                 |\n+------------------+--------------------------------------------------+\n\n## Example calculating \n\n::: example\n**Example 1**. ***Calculating standard normal probabilities practice**\nLet* $Z$ be a standard normal random variable,\n$Z\\sim N(\\mu=0,\\sigma=1)$. Calculate the following probabilities.\nInclude sketches of the normal curves with the probability areas shaded\nin.\n\n1.  $\\mathbb{P}( Z < 2.67 )$\n\n2.  $\\mathbb{P}( Z > -0.37 )$\n\n3.  $\\mathbb{P}( -2.18 < Z < 2.46 )$\n\n4.  $\\mathbb{P}(Z = 1.53 )$\n:::\n\n## example 1\n\n::: example\n**Example 3**. ***DBP** Suppose the distribution of diastolic blood\npressure (DBP) in 35- to 44-year old men is normally distributed with\nmean 80 mm Hg and variance 144 mm Hg.*\n\n1.  *Mild hypertension is when the DBP is between 90 and 99 mm Hg. What\n    proportion of this population has mild hypertension?*\n\n2.  *What is the* $10^{th}$ percentile of the DBP distribution?\n\n3.  *What is the* $95^{th}$ percentile of the DBP distribution?\n:::\n\n## Normal approximation of the binomial distribution\n\n-   Recall that a binomial random variable $X$ counts the total number\n    of successes in $n$ independent trials, each with probability $p$ of\n    a success.\n\n-   Probability function for $x = 0, 1, ..., n$ :\n    $$P(X = k) = {n\\choose k}p^k(1-p)^{n-k} = \\frac{n!}{k!(n-k)!}p^k(1-p)^{n-k}$$\n\n-   Tedious to compute for large number of trails ($n$), although doable\n    with software like R\n\n-   As $n$ gets big though, the distribution shape of a binomial r.v.\n    gets more and more symmetric, and can be *approximated by a normal\n    distribution*.\n\n![Binomial distribution histograms for varying $n$ when\n$p=0.10$](../img_slides/fourBinomialModelsShowingApproxToNormal.pdf){width=\"5in\"}\n\n## Normal Approximation of the Binomial Distribution\n\n-   Also known as: **Sampling distribution of** $\\widehat{p}$\n\n-   IF $X\\sim \\text{Binomial}(n,p)$ and $np>10$ and $nq = n(1-p) > 10$\n\n    -   Ensures sample size ($n$) is moderately large and the $p$ is not too close to 0 or 1\n    -   Other resources use other criteria (like $npq>5$ or $np>5$)\n    -   When looking at a sample, we use $\\widehat{p}$ instead of $p$ to check this!!\n\n¬†\n\n-   THEN approximately $ùëã\\sim \\text{Normal}\\big(\\mu_X = np, \\sigma_X = \\sqrt{np(1-p)} \\big)$\n\n    -   Or we often write this as the sampling distribution of $\\widehat{p}$: $$\\widehat{p} \\sim \\text{Normal}\\bigg(\\mu_{\\widehat{p}} = p, \\sigma_{\\widehat{p}} = \\sqrt{\\dfrac{p(1-p)}{n}}\\bigg)$$\n\n-   [Pretty good video behind the intuition of this](https://www.youtube.com/watch?v=CCqWkJ_pqNU&ab_channel=jbstatistics) (Watch 00:00 - 05:40)\n\n## Example using Normal approximation\n\n::: example\n**Example 5**. ***Vaccinated people testing positive for Covid-19\n(revisited)** About 25% of people that test positive for Covid-19 are\nvaccinated for Covid-19. Suppose 100 people have tested positive for\nCovid-19 (independently of each other). Let* $X$ denote the number of\npeople that are vaccinated amongst the 100 that tested positive. What is\nthe probability that fewer than 20 of the people that tested positive\nare vaccinated?\n\n![image](../img_slides/binom_n100_p25_crop.png){width=\"4in\"}\n\n1.  *Calculate exact probability.*\n\n2.  *Calculate approximate probability.*\n:::\n\n# Learning objectives\n\n## Introduction to the Poisson distribution\n\n- The Poisson distribution is often used to calculate probabilities for rare\nevents that accumulate over time.\n\n  - It is a discrete distribution!\n\n- It used most often in settings where events happen at a rate $\\lambda$\nper unit of population and per unit time, such as the annual incidence\nof a disease in a population.\n\n-   **Typical example:** for children ages 0 - 14, the incidence rate of\n    acute lymphocytic leukemia (ALL) was approximately 30 diagnosed\n    cases per million children per year in 2010.\n\n-   Always take care to note and understand the units.\n\n## Example: Outbreaks of childhood leukemia\n\nFortunately, childhood cancers are rare.\n\nFor children ages 0 - 14, the incidence rate of acute lymphocytic\nleukemia (ALL) was approximately 30 diagnosed cases per million children\nper year in the decade from 2000 - 2010. Approximately 20% of the US\npopulation are in this age range.\n\n-   What is the incidence rate over a 5 year period?\n-   In a small city of 75,000 people, what is the probability of\n    observing exactly 8 cases of ALL over a 5 year period?\n-   In the small city, what is the probability of observing 8 or more\n    cases over a 5 year period?\n\n## Poisson Distribution\n\nSuppose events occur over time in such a way that\n\n1.  The probability an event occurs in an interval is proportional to\n    the length of the interval.\n\n2.  Events occur independently at a rate $\\lambda$ per unit of time.\n\nThen the probability of exactly $x$ events in one unit of time is $$\nP(X = x) = \\frac{e^{-\\lambda}\\lambda^{x}}{x!}, \\,\\, x = 0, 1, 2,\n\\ldots\n$$\n\nThe probability of exactly $x$ events $t$ units of time is $$\nP(X = x) = \\frac{e^{-\\lambda t}(\\lambda t)^{x}}{x!}, \\,\\, x = 0, 1,\n2, \\ldots\n$$\n\nDerivation given in more theoretical courses, such as Stat 110.\n\n## Poisson distribution with $\\lambda = 2.25$\n\n![poisson rate 2.25](./figures/pois_2_25.pdf)\n\n## Poisson mean and standard deviation\n\nFor the Poisson distribution modeling the number of events in one unit\nof time:\n\n-   The mean is $\\lambda$.\n\n-   The standard deviation is $\\sqrt{\\lambda}$.\n\nIn $t$ units of time, the mean and standard deviation are, respectively,\n$\\lambda t$ and $\\sqrt{\\lambda t}$.\n\n## Childhood leukemia cases (*OI Biostat*, Example 3.37)\n\nThe incidence rate of ALL in a year is 30 per 1,000,000 children:\n\n-   $\\dfrac{30}{1,000,000}= 0.00003 = 3\\times 10^{-5}$.\n\nThe incidence rate over a 5-year period is (5)(30) per 1,000,000\nchildren:\n\n-   $\\dfrac{150}{1,000,000} = 0.00015 = 1.5 \\times 10^{-4}$.\n\n## What about a city of size 75,000?\n\nIn a city of 75,000 people, approximately $(75,000)(0.20) = 15,000$\nchildren will be age 0 - 14 (from slide 31).\n\nThe five-year rate of new cases for the city would be:\n\n\\[(1.5 \\times 10\\^{-4})(15,000) = 2.25\\]\n\n## What is the probability of 8 cases over 5 years?\n\n\\[P(X=8) = \\frac{e^{-\\lambda}\\lambda^{x}}{x!} =\n\\frac{e^{(-2.25)}(2.25)^{8}}{8!}\\]\n\nEasiest to calculate this in \\textsf{R} ...\n\nSuppose $X$ has a Poisson distribution with parameter $\\lambda$.\n\n-   \\texttt{dpois(k, lambda)}: $P(X = k)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(8, lambda = 2.25)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.001717027\n```\n:::\n:::\n\n\n## What is the probability of 8 or more cases?\n\nWould 8 or more cases be a rare event?\n\n-   Calculate $P(X \\geq 8) = 1 - P(X \\leq 7)$.\n\nSuppose $X$ has a Poisson distribution with parameter $\\lambda$.\n\n\\footnotesize\n\n-   \\texttt{ppois(k, lambda)}: $P(X \\leq k)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - ppois(7, lambda = 2.25)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.002267088\n```\n:::\n:::\n\n\n-   \\texttt{ppois(k, lambda, lower.tail = FALSE)}: $P(X > k)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppois(7, lambda = 2.25, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.002267088\n```\n:::\n:::\n\n\n# Meike\n\n## Poisson distribution\n\n-   Discrete distribution\n\n-   Used to model count data (# of successes), especially for rare\n    events\n\n-   Used to approximate binomial distribution when $n$ is large and $p$\n    is small\n\n## \n\n::: definition\n**Definition 6**. *Distribution of a **Poisson** random variable. Let*\n$X$ be the total number of successes in an interval (such as time) with\nan average success rate $\\lambda$. Then probability of observing exactly\n$k$ successes in a unit interval is\n:::\n\n-   The parameter of a Poisson distribution is $\\lambda$.\n\n-   If a r.v. $X$ is modeled by a Poisson distribution, then we write in\n    shorthand\n\n## \n\n::: theorem\n**Theorem 7**. *Mean and SD of a Poisson r.v. If* $X$ is a Poisson r.v.\nwith parameter $\\lambda$, then\n:::\n\n## Example\n\n::: example\n**Example 8**. ***Typhoid fever** Suppose there are on average 5 deaths\nper year from typhoid fever over a 1-year period.*\n\n![image](../img_slides/Poisson_L5.png){width=\"5in\"}\n\n1.  *What is the probability of 3 deaths in a year?*\n\n2.  *What is the probability of 2 deaths in 0.5 years?*\n\n3.  *What is the probability of more than 12 deaths in 2 years?*\n:::\n\n## Example\n\n::: example\n**Example 9**. ***Cleft palate** About 1 in every 1,700 babies is born\nwith cleft palate in the United States. Find the probability that there\nare 2 babies born with cleft palates amongst the next 3000 births at\nOHSU.*\n\n1.  *Calculate exact probability.*\n\n2.  *Calculate approximate probability.*\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}