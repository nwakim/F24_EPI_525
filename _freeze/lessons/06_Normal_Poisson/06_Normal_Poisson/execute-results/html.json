{
  "hash": "73801d98a3c2c0f53519727004f84cd4",
  "result": {
    "markdown": "---\ntitle: \"Lesson 6: Normal and Poisson distributions\"\nsubtitle: \"TB sections 3.3-3.4\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"10/16/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 6 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n# Learning Objectives\n\n1.  Understand how probabilities can extend to continuous distributions\n2.  Calculate probabilities for different events using a Normal\n    distribution\n3.  Normal apprximation of the binomial distribution\n4.  Calculate probabilities for different events using a Poisson\n    distribution\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n# Learning Objectives\n\n## Last time: Discrete vs. continuous random variables\n\n-   Probability distributions are usually either **discrete** or\n    **continuous**, depending on whether the random variable is discrete\n    or continuous.\n\n:::::::::::: columns\n:::::: {.column width=\"47%\"}\n::::: red\n::: red-ttl\nDiscrete random variable\n:::\n\n::: red-cont\nA **discrete** r.v. $X$ takes on a finite number of values or countably\ninfinite number of possible values.\n:::\n:::::\n\nThink:\n\n-   Number of heads in a set of coin tosses\n-   Number of people who have had chicken pox in a random sample\n\n \n\n-   Binomial and Bernoulli distributions are discrete\n::::::\n\n::: {.column width=\"2%\"}\n:::\n\n:::::: {.column width=\"49%\"}\n::::: pink2\n::: pink2-ttl\nContinuous random variable\n:::\n\n::: pink2-cont\nA **continuous** r.v. $X$ can take on any real value in an interval of\nvalues or unions of intervals.\n:::\n:::::\n\nThink:\n\n-   Height in a population\n-   Blood pressure in a population\n::::::\n::::::::::::\n\n## Probabilities for continuous distributions (1/2)\n\nTwo important features of continuous distributions:\n\n-   The total area under the density curve is 1.\n\n-   The probability that a variable has a value within a specified\n    interval is the area under the curve over that interval.\n\n![](../img_slides/fdicHeightContDistFilled.png){fig-align=\"center\"}\n\n## Probabilities for continuous distributions (2/2)\n\nWhen working with continuous random variables, probability is found for\n**intervals of values** rather than **individual values**.\n\n-   The probability that a continuous r.v. $X$ takes on any single\n    individual value is 0\n\n    -   That is, $P(X = x) = 0$.\n\n-   Thus, $P(a < X < b)$ is equivalent to $P(a \\leq X \\leq b)$\n\n## Poll Everywhere Question 1\n\n# Learning Objectives\n\n## Normal distribution\n\n::::: columns\n::: {.column width=\"40%\"}\n-   A random variable X is modeled with a normal distribution if:\n\n    -   **Shape:** symmetric, unimodal bell curve\n    -   **Center:** mean $\\mu$\n    -   **Spread (variability):** standard deviation $\\sigma$\n\n \n\n-   Shorthand for a random variable, $X$, that has a Normal\n    distribution: $$X \\sim \\text{Normal}(\\mu, \\sigma)$$\n:::\n\n::: {.column width=\"60%\"}\n![](../img_slides/Normal_examples.png)\n:::\n:::::\n\n## Standard Normal Distribution\n\n![Transformation from general normal $X$ to standard normal\n$Z$](../img_slides/X_to_Z_transformation_Brase.png){width=\"5in\"}\n\n## Standard Normal Distribution\n\n-   A *standard normal* distribution is defined as a normal distribution\n    with mean 0 and variance 1. It is often denoted as $Z \\sim N(0, 1)$.\n\n-   Any normal random variable $X$ can be transformed into a standard\n    normal random variable $Z$.\n\n$$Z = \\dfrac{X - \\mu}{\\sigma} \\qquad X = \\mu + Z\\sigma$$\n\n-   The $Z$-score of an observation quantifies how far the observation\n    is from the mean, in units of standard deviation(s).\n\n-   For example, if an observation has $Z$-score $z = 3.4$, then the\n    observation is 3.4 standard deviations above the mean.\n\n## Normal distribution: R commands\n\nR commands with their [input]{style=\"color:#BF396F\"} and\n[output]{style=\"color:#367B79\"}:\n\n+----------------+------------------------------------------------+\n| R code         | What does it return?                           |\n+================+================================================+\n| `rnorm()`      | returns [sample of random                      |\n|                | variables]{style=\"color:#367B79\"} with         |\n|                | [specified normal                              |\n|                | distribution]{style=\"color:#BF396F\"}           |\n+----------------+------------------------------------------------+\n| `dnorm()`      | returns [value of probability                  |\n|                | density]{style=\"color:#367B79\"} at [certain    |\n|                | point of the normal                            |\n|                | distribution]{style=\"color:#BF396F\"}           |\n|                |                                                |\n|                | -   Not typically used                         |\n+----------------+------------------------------------------------+\n| `pnorm()`      | returns [cumulative                            |\n|                | probability]{style=\"color:#367B79\"} of getting |\n|                | [certain point (or less) of the normal         |\n|                | distribution]{style=\"color:#BF396F\"}           |\n+----------------+------------------------------------------------+\n| `qnorm()`      | returns [z-score]{style=\"color:#367B79\"}       |\n|                | corresponding to [desired                      |\n|                | quantile]{style=\"color:#BF396F\"}               |\n+----------------+------------------------------------------------+\n\n## Calculating probabilities from a Normal distribution\n\nThree ways to calculate probabilities from a normal distribution:\n\n1.  Calculus **(not for us!)**\n\n \n\n2.  Normal probability table\n\n    -   The textbook has a normal probability table in Appendix B.1,\n        which is included as the next two pages\n    -   Not required for this class\n\n \n\n3.  R commands\n\n    -   $P(Z \\leq q) =$ `pnorm(q, mean = 0, sd = 1, lower.tail = TRUE)`\n\n \n\n4.  Random online calculators\n\n    -   Like this one:\n        <https://onlinestatbook.com/2/calculators/normal_dist.html>\n\n## Example: Calculating probabilities from a Normal distribution (1/5)\n\n::::: example\n::: ex-ttl\nExample: Calculating standard normal probabilities practice\n:::\n\n::: ex-cont\nLet $Z$ be a standard normal random variable, $Z\\sim N(\\mu=0,\\sigma=1)$.\nCalculate the following probabilities. Include sketches of the normal\ncurves with the probability areas shaded in.\n\n1.  $\\mathbb{P}( Z < 2.67 )$\n\n2.  $\\mathbb{P}( Z > -0.37 )$\n\n3.  $\\mathbb{P}( -2.18 < Z < 2.46 )$\n\n4.  $\\mathbb{P}(Z = 1.53 )$\n:::\n:::::\n\n## Example: Calculating probabilities from a Normal distribution (2/5)\n\n::::: example\n::: ex-ttl\nExample: Calculating standard normal probabilities practice\n:::\n\n::: ex-cont\nLet $Z$ be a standard normal random variable, $Z\\sim N(\\mu=0,\\sigma=1)$.\nCalculate the following probabilities. Include sketches of the normal\ncurves with the probability areas shaded in.\n\n1.  $\\mathbb{P}( Z < 2.67 )$\n:::\n:::::\n\n::::: columns\n::: column\n![](../img_slides/standard_normal.png){width=\"800\"}\n:::\n\n::: column\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 2.67, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9962074\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 2.67)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9962074\n```\n:::\n:::\n\n:::\n:::::\n\n## Example: Calculating probabilities from a Normal distribution (3/5)\n\n::::: example\n::: ex-ttl\nExample: Calculating standard normal probabilities practice\n:::\n\n::: ex-cont\nLet $Z$ be a standard normal random variable, $Z\\sim N(\\mu=0,\\sigma=1)$.\nCalculate the following probabilities. Include sketches of the normal\ncurves with the probability areas shaded in.\n\n2.  $\\mathbb{P}( Z > -0.37 )$\n:::\n:::::\n\n::::: columns\n::: column\n![](../img_slides/standard_normal.png){width=\"800\"}\n:::\n\n::: column\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pnorm(q = -0.37, \n          mean = 0, \n          sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6443088\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = -0.37, mean = 0, sd = 1, \n      lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6443088\n```\n:::\n:::\n\n:::\n:::::\n\n## Example: Calculating probabilities from a Normal distribution (4/5)\n\n::::: example\n::: ex-ttl\nExample: Calculating standard normal probabilities practice\n:::\n\n::: ex-cont\nLet $Z$ be a standard normal random variable, $Z\\sim N(\\mu=0,\\sigma=1)$.\nCalculate the following probabilities. Include sketches of the normal\ncurves with the probability areas shaded in.\n\n3.  $\\mathbb{P}( -2.18 < Z < 2.46 )$\n:::\n:::::\n\n::::: columns\n::: column\n![](../img_slides/standard_normal.png){width=\"800\"}\n:::\n\n::: column\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 2.46, mean = 0, sd = 1) - \n  pnorm(q = -2.18, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9784244\n```\n:::\n:::\n\n:::\n:::::\n\n## Example: Calculating probabilities from a Normal distribution (5/5)\n\n::::: example\n::: ex-ttl\nExample: Calculating standard normal probabilities practice\n:::\n\n::: ex-cont\nLet $Z$ be a standard normal random variable, $Z\\sim N(\\mu=0,\\sigma=1)$.\nCalculate the following probabilities. Include sketches of the normal\ncurves with the probability areas shaded in.\n\n4.  $\\mathbb{P}(Z = 1.53 )$\n:::\n:::::\n\n::::: columns\n::: column\n![](../img_slides/standard_normal.png){width=\"800\"}\n:::\n\n::: column\n\n:::\n:::::\n\n## Using Normal distribution in word problems\n\n::::: example\n::: ex-ttl\nExample: Diastolic blood pressure (DBP)\n:::\n\n::: ex-cont\nSuppose the distribution of diastolic blood pressure (DBP) in 35- to\n44-year old men is normally distributed with mean 80 mm Hg and variance\n144 mm Hg.\n\n1.  Mild hypertension is when the DBP is between 90 and 99 mm Hg. What\n    proportion of this population has mild hypertension?\n\n2.  What is the $10^{th}$ percentile of the DBP distribution?\n\n3.  What is the $95^{th}$ percentile of the DBP distribution?\n:::\n:::::\n\n## Using Normal distribution in word problems\n\n::::: example\n::: ex-ttl\nExample: Diastolic blood pressure (DBP)\n:::\n\n::: ex-cont\nSuppose the distribution of diastolic blood pressure (DBP) in 35- to\n44-year old men is normally distributed with mean 80 mm Hg and variance\n144 mm Hg.\n\n1.  Mild hypertension is when the DBP is between 90 and 99 mm Hg. What\n    proportion of this population has mild hypertension?\n:::\n:::::\n\n::: columns\n::: column\n- Draw on a normal curve:\n:::\n::: column\n- Compute in R:\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 99, mean = 80, \n      sd = sqrt(144)) - \n  pnorm(q = 90, mean = 80, \n        sd = sqrt(144))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1456556\n```\n:::\n:::\n\n:::\n:::\n\n## Using Normal distribution in word problems\n\n::::: example\n::: ex-ttl\nExample: Diastolic blood pressure (DBP)\n:::\n\n::: ex-cont\nSuppose the distribution of diastolic blood pressure (DBP) in 35- to\n44-year old men is normally distributed with mean 80 mm Hg and variance\n144 mm Hg.\n\n2.  What is the $10^{th}$ percentile of the DBP distribution?\n:::\n:::::\n\n::: columns\n::: column\n- Draw on a normal curve:\n:::\n::: column\n- Compute in R:\n\n::: {.cell}\n\n```{.r .cell-code}\nqnorm(p = 0.10, \n      mean = 80, \n      sd = sqrt(144))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 64.62138\n```\n:::\n:::\n\n:::\n:::\n\n## Using Normal distribution in word problems\n\n::::: example\n::: ex-ttl\nExample: Diastolic blood pressure (DBP)\n:::\n\n::: ex-cont\nSuppose the distribution of diastolic blood pressure (DBP) in 35- to\n44-year old men is normally distributed with mean 80 mm Hg and variance\n144 mm Hg.\n\n3.  What is the $95^{th}$ percentile of the DBP distribution?\n:::\n:::::\n\n::: columns\n::: column\n- Draw on a normal curve:\n:::\n::: column\n- Compute in R:\n\n::: {.cell}\n\n```{.r .cell-code}\nqnorm(p = 0.95, \n      mean = 80, \n      sd = sqrt(144))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 99.73824\n```\n:::\n:::\n\n:::\n:::\n\n# Learning Objectives\n\n## Normal Approximation of the Binomial Distribution\n\n-   Recall that a binomial random variable $X$ counts the total number\n    of successes in $n$ independent trials, each with probability $p$ of\n    a success.\n    \n \n\n-   Probability function for $x = 0, 1, ..., n$ :\n    $$P(X = k) = {n\\choose k}p^k(1-p)^{n-k} = \\frac{n!}{k!(n-k)!}p^k(1-p)^{n-k}$$\n\n \n\n-   Tedious to compute for large number of trails ($n$), although doable\n    with software like R\n\n \n\n-   As $n$ gets big though, the distribution shape of a binomial r.v.\n    gets more and more symmetric, and can be approximated by a normal distribution\n\n## Normal Approximation of the Binomial Distribution\n\n-   Also known as: **Sampling distribution of** $\\widehat{p}$\n\n-   IF $X\\sim \\text{Binomial}(n,p)$ and $np>10$ and $nq = n(1-p) > 10$\n\n    -   Ensures sample size ($n$) is moderately large and the $p$ is not\n        too close to 0 or 1\n    -   Other resources use other criteria (like $npq>5$ or $np>5$)\n    -   When looking at a sample, we use $\\widehat{p}$ instead of $p$ to\n        check this!!\n\n \n\n-   THEN approximately\n    $𝑋\\sim \\text{Normal}\\big(\\mu_X = np, \\sigma_X = \\sqrt{np(1-p)} \\big)$\n\n    -   Or we often write this as the sampling distribution of\n        $\\widehat{p}$:\n        $$\\widehat{p} \\sim \\text{Normal}\\bigg(\\mu_{\\widehat{p}} = p, \\sigma_{\\widehat{p}} = \\sqrt{\\dfrac{p(1-p)}{n}}\\bigg)$$\n\n-   [Pretty good video behind the intuition of\n    this](https://www.youtube.com/watch?v=CCqWkJ_pqNU&ab_channel=jbstatistics)\n    (Watch 00:00 - 05:40)\n\n## Example: Normal approximation or Binomial distribution\n\n::: columns\n::: {.column width=\"40%\"}\n\n::::: example\n::: ex-ttl\nExample: Vaccinated people testing positive for Covid-19 (revisited)\n:::\n\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for it. Suppose 100 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 100 that tested positive. What is the probability that fewer than 20 of the people that tested positive are vaccinated?\n\n1.  Calculate exact probability.\n\n2.  Calculate approximate probability.\n:::\n:::::\n:::\n::: {.column width=\"60%\"}\n$p=0.25$, $n=100$, we want $P(X < 20)$\n\n \n\n1. Exact probability = Binomial distribution\n\n$$X \\sim \\text{Binomial}(n=100, p=0.25)$$\n\n$$P(X < 20) = P(X \\leq 19) = \\sum_{j=0}^{19}P(X = j)$$\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\npbinom(q = 19, size = 100, prob = 0.25)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.09953041\n```\n:::\n:::\n\n\n:::\n:::\n\n\n## Example: Normal approximation or Binomial distribution\n\n::: columns\n::: {.column width=\"40%\"}\n\n::::: example\n::: ex-ttl\nExample: Vaccinated people testing positive for Covid-19 (revisited)\n:::\n\n::: ex-cont\nAbout 25% of people that test positive for Covid-19 are vaccinated for it. Suppose 100 people have tested positive for Covid-19 (independently of each other). Let $X$ denote the number of people that are vaccinated among the 100 that tested positive. What is the probability that fewer than 20 of the people that tested positive are vaccinated?\n\n1.  Calculate exact probability.\n\n2.  Calculate approximate probability.\n:::\n:::::\n:::\n::: {.column width=\"60%\"}\n$p=0.25$, $n=100$, we want $P(X < 20)$\n\n2. Approximate probability = Normal distribution\n\n    - Mean = $\\mu = np = 0.25\\cdot 100 = 25$\n    - SD = $\\sigma = \\sqrt{np(1-p)}=\\sqrt{100\\cdot 0.25 \\cdot (1-0.25)}$\n    \n$$X \\sim \\text{Normal}\\bigg(\\mu=25, \\sigma = \\sqrt{100\\cdot 0.25 \\cdot (1-0.25)}\\bigg)$$\n\n- For these probabilities, we use something called a **continuity correction**. Instead of calculating $P(X < 20)$, we calculate $P(X \\leq 19.5)$\n    \n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 19.5, mean = 25, \n      sd = sqrt( 100*0.25*0.75 ))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1020119\n```\n:::\n:::\n\n:::\n:::\n\n\n## Some resources for the normal distribution\n\n-   [Page on R commands](https://seankross.com/notes/dpqr/)\n\n# Learning objectives\n\n## Introduction to the Poisson distribution\n\n-   The Poisson distribution is often used to model **count data (# of\n    successes)**, especially for **rare events**\n\n    -   It is a **discrete distribution!**\n\n-   It used most often in settings where events happen at a rate\n    $\\lambda$ per unit of population and per unit time, such as the\n    annual incidence of a disease in a population.\n\n \n\n-   **Quick example:** for children ages 0 - 14, the incidence rate of\n    acute lymphocytic leukemia (ALL) was approximately 30 diagnosed\n    cases per million children per year in 2010.\n\n \n\n-   Also used to approximate binomial distribution when $n$ is large and\n    $p$ is small\n    -   When Normal approximation does not work\n\n## Poisson Distribution\n\nSuppose events occur over time in such a way that\n\n1.  The probability an event occurs in an interval is proportional to\n    the length of the interval.\n\n2.  Events occur independently at a rate $\\lambda$ per unit of time.\n\nThen the probability of exactly $x$ events in one unit of time is $$\nP(X = x) = \\frac{e^{-\\lambda}\\lambda^{x}}{x!}, \\,\\, x = 0, 1, 2,\n\\ldots\n$$\n\nThe probability of exactly $x$ events $t$ units of time is $$\nP(X = x) = \\frac{e^{-\\lambda t}(\\lambda t)^{x}}{x!}, \\,\\, x = 0, 1,\n2, \\ldots\n$$\n\nFor the Poisson distribution modeling the number of events in one unit\nof time:\n\n-   The mean is $\\lambda$.\n\n-   The standard deviation is $\\sqrt{\\lambda}$.\n\nIn $t$ units of time, the mean and standard deviation are, respectively,\n$\\lambda t$ and $\\sqrt{\\lambda t}$.\n\n## Poisson distribution\n\n-   Discrete distribution\n\n-   Used to model count data (# of successes), especially for rare\n    events\n\n-   Used to approximate binomial distribution when $n$ is large and $p$\n    is small\n\n## \n\n::: definition\n**Definition 6**. *Distribution of a **Poisson** random variable. Let*\n$X$ be the total number of successes in an interval (such as time) with\nan average success rate $\\lambda$. Then probability of observing exactly\n$k$ successes in a unit interval is\n:::\n\n-   The parameter of a Poisson distribution is $\\lambda$.\n\n-   If a r.v. $X$ is modeled by a Poisson distribution, then we write in\n    shorthand\n\n## Mean and SD\n\n::: theorem\n**Theorem 7**. *Mean and SD of a Poisson r.v. If* $X$ is a Poisson r.v.\nwith parameter $\\lambda$, then\n:::\n\n## Example\n\n::: example\n**Example 8**. ***Typhoid fever** Suppose there are on average 5 deaths\nper year from typhoid fever over a 1-year period.*\n\n![image](../img_slides/Poisson_L5.png){width=\"5in\"}\n\n1.  *What is the probability of 3 deaths in a year?*\n\n2.  *What is the probability of 2 deaths in 0.5 years?*\n\n3.  *What is the probability of more than 12 deaths in 2 years?*\n:::\n\n# Learning Objective?\n\n## Example: Poisson approximation of binomial distribution\n\n::: example\n**Example 9**. ***Cleft palate** About 1 in every 1,700 babies is born\nwith cleft palate in the United States. Find the probability that there\nare 2 babies born with cleft palates amongst the next 3000 births at\nOHSU.*\n\n1.  *Calculate exact probability.*\n\n2.  *Calculate approximate probability.*\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}