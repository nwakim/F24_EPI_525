{
  "hash": "39aa06953538e669385848891b60839f",
  "result": {
    "markdown": "---\ntitle: \"Day 17: Nonparametric tests - Supplemental material\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"09/25/2024\"\ncategories: [\"Week 6\"]\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    toc: true\n    toc-depth: 1\n    toc-title: Class Overview\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1600\n    height: 1100\n    footer: Lesson 8 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n\n## Load packages\n\n* Packages need to be loaded _every time_ you restart R or render an Qmd file\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run these every time you open Rstudio\nlibrary(tidyverse)    \nlibrary(oibiostat)\nlibrary(janitor)\nlibrary(rstatix)\nlibrary(knitr)\nlibrary(gtsummary)\nlibrary(moderndive)\nlibrary(gt)\nlibrary(broom) \nlibrary(here) \nlibrary(pwr) \nlibrary(BSDA)  # NEW package!!!\n```\n:::\n\n\n\n\n- You can check whether a package has been loaded or not \n  - by looking at the Packages tab and \n  - seeing whether it has been checked off or not\n  \n  \n\n# MoRitz's tip: write \"nice\" R code\n\nCheck out the tidyverse style guide: https://style.tidyverse.org/index.html\n\nEspecially, Chapter 4: [Pipes](https://style.tidyverse.org/pipes.html#pipes) and  Chapter 5: [ggplot2](https://style.tidyverse.org/ggplot2.html#ggplot2)\n\n\n\n# Goals for today (Supplemental material)\n\n\n* Why us a nonparametric approach?\n* What the following tests are & when to use them\n\n* __Sign test__ \n    * for paired data or single samples\n* __(Wilcoxon) sign-rank test__ \n    * for paired data or single samples\n    * accounts for sizes of differences\n* __Wilcoxon Rank-sum test__ \n    * for two independent samples\n    * a.k.a __Mann-Whitney U test__\n* __Kruskal-Wallis test__\n    * nonparametric ANOVA test\n\n\n* How to use R for each test & interpret the results\n\n## Additional resource\n\n* Chapter 13: Nonparametric tests of Pagano's _Principles of Biostatistics_, 2022 edition\n* Can download chapter from OHSU library eBook at <https://ebookcentral.proquest.com/lib/ohsu/detail.action?docID=6950388&pq-origsite=primo>\n\n\n# Nonparametric tests\n\n## Background: parametric vs nonparametric\n\n* Prior inference of means methods had conditions assuming the underlying population(s) was (were) normal (or at least approximately normal).\n* Normal distribution is completely described (parameterized) by two parameters: $\\mu$ and $\\sigma$. \n* The first was often the parameter of interest, while the latter was assumed known ( $Z$-test) or estimated ( $t$-tests).\n* The above are therefore described as __parametric__ procedures.\n\n* __Nonparametric__ procedures \n    * Make fewer assumptions about the structure of the underlying  population from which the samples were collected.\n    * Work well when distributional assumptions are in doubt.\n   \n\n\n## The good and the bad about nonparametric tests\n\n__Good__  \n\n* Fewer assumptions \n* Tests are based on ranks\n    * Therefore outliers have no greater influence than non-outliers.\n    * Since tests are based on ranks we can apply these procedures to\nordinal data \n        * (where means and standard deviations are not meaningful).\n\n__Drawbacks__\n\n* Less powerful than parametric tests (due to loss of information when data are converted to ranks)\n* While the test is easy, it may require substantial (computer) work to develop a confidence interval [by \"inverting\" the test].\n* Theory was developed for continuous data (where ties are not possible); if population or data contain many ties, then a correction to the procedures must be implemented.\n* Some procedures have \"large\" and \"small\" sample versions; the small sample versions require special tables or a computer.\n\n\n\n# Sign test\n\nFor paired data or single samples\n\n\n\n## Example: Intraocular pressure of glaucoma patients\n\n\n* Intraocular pressure of glaucoma patients is often reduced by treatment with adrenaline. \n* A __new synthetic drug__ is being considered, but it is more expensive than the __current adrenaline alternative__. \n* 7 glaucoma patients were treated with both drugs: \n    * one eye with adrenaline and \n    * the other with the synthetic drug\n* __Reduction in pressure__ was recorded in each eye after following treatment (larger numbers indicate greater reduction)\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_table <- tibble(\n  Patient = 1:7,\n  Adren = c(3.5, 2.6, 3, 1.9, 2.9, 2.4, 2),\n  Synth = c(3.2, 3.1, 3.3, 2.4, 2.9, 2.8, 2.6)\n  ) %>% \n  mutate(\n    d = Synth - Adren,\n    Sign = case_when(\n      d < 0 ~ \"-\",\n      d > 0 ~ \"+\"\n      )\n    )\nIOP_table %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwiroqcyok\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwiroqcyok table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwiroqcyok thead, #xwiroqcyok tbody, #xwiroqcyok tfoot, #xwiroqcyok tr, #xwiroqcyok td, #xwiroqcyok th {\n  border-style: none;\n}\n\n#xwiroqcyok p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwiroqcyok .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwiroqcyok .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwiroqcyok .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwiroqcyok .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwiroqcyok .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwiroqcyok .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwiroqcyok .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwiroqcyok .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwiroqcyok .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwiroqcyok .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwiroqcyok .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwiroqcyok .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwiroqcyok .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwiroqcyok .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwiroqcyok .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwiroqcyok .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwiroqcyok .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwiroqcyok .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwiroqcyok .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwiroqcyok .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwiroqcyok .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwiroqcyok .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwiroqcyok .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwiroqcyok .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwiroqcyok .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwiroqcyok .gt_left {\n  text-align: left;\n}\n\n#xwiroqcyok .gt_center {\n  text-align: center;\n}\n\n#xwiroqcyok .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwiroqcyok .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwiroqcyok .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwiroqcyok .gt_font_italic {\n  font-style: italic;\n}\n\n#xwiroqcyok .gt_super {\n  font-size: 65%;\n}\n\n#xwiroqcyok .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwiroqcyok .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwiroqcyok .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwiroqcyok .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwiroqcyok .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwiroqcyok .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwiroqcyok .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#xwiroqcyok .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#xwiroqcyok div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n* __d__ is the difference in reduction of pressure: __Synth - Adren__\n* __Sign__ is `+` if the difference is positive and `-` if the difference is negative\n\n\n\n\n### Visualize the differences\n\nVisualize the differences in reduction of pressure $d$ : __Synth - Adren__\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IOP_table, aes(x = d)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-4-1.png){width=384}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IOP_table, aes(x = d)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-5-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n\n## Hypotheses & \"statistic\" (Sign test)\n\n\n__Hypotheses__\n\n$H_0:$ The median difference in the population is 0  \n$H_a:$ The median difference in the population is NOT 0\n\n<hr>\n\n__\"Statistic\"__  \n\n$D^+$ = number of positive differences  \n$D^-$ = number of negative differences\n\n<hr>\n\nWhat are $D^+$ and $D^-$ for our example?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_table %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xgchvxmdoj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xgchvxmdoj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xgchvxmdoj thead, #xgchvxmdoj tbody, #xgchvxmdoj tfoot, #xgchvxmdoj tr, #xgchvxmdoj td, #xgchvxmdoj th {\n  border-style: none;\n}\n\n#xgchvxmdoj p {\n  margin: 0;\n  padding: 0;\n}\n\n#xgchvxmdoj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xgchvxmdoj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xgchvxmdoj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xgchvxmdoj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xgchvxmdoj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xgchvxmdoj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xgchvxmdoj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xgchvxmdoj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xgchvxmdoj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xgchvxmdoj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xgchvxmdoj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xgchvxmdoj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xgchvxmdoj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xgchvxmdoj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xgchvxmdoj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xgchvxmdoj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xgchvxmdoj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xgchvxmdoj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xgchvxmdoj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xgchvxmdoj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xgchvxmdoj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xgchvxmdoj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xgchvxmdoj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xgchvxmdoj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xgchvxmdoj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xgchvxmdoj .gt_left {\n  text-align: left;\n}\n\n#xgchvxmdoj .gt_center {\n  text-align: center;\n}\n\n#xgchvxmdoj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xgchvxmdoj .gt_font_normal {\n  font-weight: normal;\n}\n\n#xgchvxmdoj .gt_font_bold {\n  font-weight: bold;\n}\n\n#xgchvxmdoj .gt_font_italic {\n  font-style: italic;\n}\n\n#xgchvxmdoj .gt_super {\n  font-size: 65%;\n}\n\n#xgchvxmdoj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xgchvxmdoj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xgchvxmdoj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xgchvxmdoj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xgchvxmdoj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xgchvxmdoj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xgchvxmdoj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#xgchvxmdoj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#xgchvxmdoj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n\n## Exact p-value (Sign test)\n\n* If the median difference is 0 ( $H_0$ is true) , then \n      * half the population consists of positive differences \n      * while half have negative differences.\n\n* Let $p=P(\\textrm{neg. diff.})=P(\\textrm{pos. diff.})= 0.5$\n\n<hr>\n\n* If the median difference is 0 ( $H_0$ is true), \n      * then a sample of $n$ differences \n          * behaves like $n$ trials in a binomial experiment \n          * where \"success\" is analogous to seeing a positive difference.\n      * By symmetry ( $p=0.5$ ), the same distribution applies to negative differences, i.e.,\n\n$$D^+ \\textrm{ and } D^- \\sim \\textrm{Bin}(n,p=0.5)$$ \n<hr>\n\n* Thus the (exact) p-value is calculated using the Binomial distribution\n\n\n\n\n## Glaucoma example (exact) p-value\n\n\n* 7 differences: \n  * 1 negative ( $D^-$ )\n  * 5 were positive ( $D^+$ )\n  * 1 difference is 0 and is discarded\n* Thus the effective sample size is $n=6$.\n\n<hr>\n__One-sided p-value__ = probability that we would see 1 or fewer negative signs among the $n=6$ differences, if the median difference is really 0\n\n<hr>\n\n__Two-sided p-value__ = 2 $\\times$ One-sided p-value\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2-sided p-value: 2*P(D^- <= 1)\n2*pbinom(1, size = 6, p = 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.21875\n```\n:::\n:::\n\n\n\n\n\n$$D^- \\sim \\textrm{Bin}(n=6,p=0.5)$$ \n\n<br>\n\n<hr>\n\n$$p-value = P(D^- \\leq 1) \\\\\n= P(D^-=0) + P(D^-=1) \\\\\n= \\frac{6!}{0!6!} (0.5)^6 + \\frac{6!}{1!5!} (0.5)^6 \\\\\n\\approx 0.1094$$\n\n<hr>\n\n$$p-value \\times 2 \\approx 0.2188$$\n\n\n\n## Sign test in R: Glaucoma example\n\nBelow we create the dataset as a tibble (and add the signs):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP <- tibble(\n  Patient = 1:7,\n  Adren = c(3.5, 2.6, 3, 1.9, 2.9, 2.4, 2),\n  Synth = c(3.2, 3.1, 3.3, 2.4, 2.9, 2.8, 2.6)\n  ) %>% \n  mutate(d = Synth - Adren,\n    Sign = case_when(\n      d < 0 ~ \"-\",\n      d > 0 ~ \"+\"))\n\nIOP %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"voxzuiybev\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#voxzuiybev table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#voxzuiybev thead, #voxzuiybev tbody, #voxzuiybev tfoot, #voxzuiybev tr, #voxzuiybev td, #voxzuiybev th {\n  border-style: none;\n}\n\n#voxzuiybev p {\n  margin: 0;\n  padding: 0;\n}\n\n#voxzuiybev .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#voxzuiybev .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#voxzuiybev .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#voxzuiybev .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#voxzuiybev .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#voxzuiybev .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#voxzuiybev .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#voxzuiybev .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#voxzuiybev .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#voxzuiybev .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#voxzuiybev .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#voxzuiybev .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#voxzuiybev .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#voxzuiybev .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#voxzuiybev .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#voxzuiybev .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#voxzuiybev .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#voxzuiybev .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#voxzuiybev .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#voxzuiybev .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#voxzuiybev .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#voxzuiybev .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#voxzuiybev .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#voxzuiybev .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#voxzuiybev .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#voxzuiybev .gt_left {\n  text-align: left;\n}\n\n#voxzuiybev .gt_center {\n  text-align: center;\n}\n\n#voxzuiybev .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#voxzuiybev .gt_font_normal {\n  font-weight: normal;\n}\n\n#voxzuiybev .gt_font_bold {\n  font-weight: bold;\n}\n\n#voxzuiybev .gt_font_italic {\n  font-style: italic;\n}\n\n#voxzuiybev .gt_super {\n  font-size: 65%;\n}\n\n#voxzuiybev .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#voxzuiybev .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#voxzuiybev .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#voxzuiybev .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#voxzuiybev .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#voxzuiybev .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#voxzuiybev .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#voxzuiybev .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#voxzuiybev div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nRecall we're testing the population median.  \nHere's the sample median:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian(IOP$d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4\n```\n:::\n:::\n\n\n\n\n\n## Sign test in R: Glaucoma example (specifying both columns)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(BSDA)  # new package!! Make sure to first install it\n# Can't \"tidy\" the output\nSIGN.test(x = IOP$Synth, y = IOP$Adren, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDependent-samples Sign-Test\n\ndata:  IOP$Synth and IOP$Adren\nS = 5, p-value = 0.2187\nalternative hypothesis: true median difference is not equal to 0\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x-y \n          0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n\n### Sign test in R: Glaucoma example (specifying differences)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Note output calls this a \"One-sample Sign-Test\"\nSIGN.test(x = IOP$d, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-sample Sign-Test\n\ndata:  IOP$d\ns = 5, p-value = 0.2187\nalternative hypothesis: true median is not equal to 0\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x \n        0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n\n## Conclusion\n\n\nRecall the hypotheses to the sign test:\n\n$H_0:$ The median population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is 0.\n\n$H_a:$ The median population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is NOT 0.\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.2188\n\n\n__Conclusion__:\n\nThe median difference in reduction of intraocular pressure between eyes being treated with the synthetic drug and adrenaline for seven glaucoma patients was 0.4 (95% CI: -0.2, 0.6).  \nThere is insufficient evidence the reduction in intraocular pressure differs when using the synthetic drug and adrenaline (2-sided sign test $p$-value = 0.219). \n\n\n\n## Sign test with large samples: p-value normal approximation\n\n* If the sample size is large, say greater than 20, \n    * then binomial probabilities can be approximated using normal probabilities\n\n* Normal approximation: \n\n$$\\mu = np =n(0.5)=n/2\\\\\n\\sigma=\\sqrt{np(1-p)}=\\sqrt{n(0.5)(0.5)}= \\sqrt{n}/2$$\n\n* Thus we have the test statistic:\n\n$$z=\\frac{D^- âˆ’n/2}{\\sqrt{n}/2}$$\n\n* With access to a computer, it's better to use the exact binomial probabilities instead of the normal approximation.\n\n\n\n## Sign test with one sample\n\n* One can use the sign test when testing just one sample.\n* Note that we did this when in R, when running the sign test using just the differences.\n* For one sample, we can specify the null population median value:\n\n$H_0:$ The population median is $m$  \n$H_a:$ The population median is NOT $m$\n\nExample: Run sign test for paired data with null $m = 0.7$: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIGN.test(x = IOP$d, md = 0.7, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-sample Sign-Test\n\ndata:  IOP$d\ns = 0, p-value = 0.01562\nalternative hypothesis: true median is not equal to 0.7\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x \n        0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n\n# (Wilcoxon) Signed-rank test\n\nFor paired data or single samples;  \naccounts for sizes of differences\n\n\n## (Wilcoxon) Signed-rank test\n\n* Like the sign test, the (Wilcoxon) signed-rank test is used for\n    * paired samples (i.e., a single set of differences) or \n    * a one-sample comparison against a specified value\n\n* However, this test _does_ make use of information concerning the size\n of the differences.\n \n<hr>\n \n __Hypotheses__\n\n$H_0:$ the population is __symmetric around some value__ $\\tilde{\\mu}_0$  \n$H_a:$ the population is __not symmetric around some value__ $\\tilde{\\mu}_0$\n\n* Even if the population has a mean/median equal to $\\tilde{\\mu}_0$, the\n test may reject the null if the population isn't symmetric, thus only use if the data (differences) are symmetric. \n* If the population is symmetric \n    * then the mean and median coincide, \n    * thus often the null hypothesis is phrased in terms of the median difference being 0\n \n\n\n\n## Example: calculate signed ranks\n\n* Rank the absolute values of the differences from smallest to largest\n* For ties, take the average of the highest and lowest tied ranks\n    * I.e. if ranks 3-7 are tied, then assign (3+7)/2 = 5 as the rank\n* Then calculate the signed ranks as +/- the rank depending on whether the sign is +/-\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_ranks <- IOP %>% \n  mutate(\n    Rank = c(1.5, 4.5, 1.5, 4.5, NA, 3, 6),\n    Signed_rank = case_when(\n      d < 0 ~ -Rank,\n      d > 0 ~ Rank\n      )\n    )\nIOP_ranks %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"fqlmdlicfc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fqlmdlicfc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fqlmdlicfc thead, #fqlmdlicfc tbody, #fqlmdlicfc tfoot, #fqlmdlicfc tr, #fqlmdlicfc td, #fqlmdlicfc th {\n  border-style: none;\n}\n\n#fqlmdlicfc p {\n  margin: 0;\n  padding: 0;\n}\n\n#fqlmdlicfc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fqlmdlicfc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fqlmdlicfc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fqlmdlicfc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fqlmdlicfc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fqlmdlicfc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fqlmdlicfc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fqlmdlicfc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fqlmdlicfc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fqlmdlicfc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fqlmdlicfc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fqlmdlicfc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fqlmdlicfc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fqlmdlicfc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fqlmdlicfc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fqlmdlicfc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fqlmdlicfc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fqlmdlicfc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fqlmdlicfc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fqlmdlicfc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fqlmdlicfc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fqlmdlicfc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fqlmdlicfc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fqlmdlicfc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fqlmdlicfc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fqlmdlicfc .gt_left {\n  text-align: left;\n}\n\n#fqlmdlicfc .gt_center {\n  text-align: center;\n}\n\n#fqlmdlicfc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fqlmdlicfc .gt_font_normal {\n  font-weight: normal;\n}\n\n#fqlmdlicfc .gt_font_bold {\n  font-weight: bold;\n}\n\n#fqlmdlicfc .gt_font_italic {\n  font-style: italic;\n}\n\n#fqlmdlicfc .gt_super {\n  font-size: 65%;\n}\n\n#fqlmdlicfc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fqlmdlicfc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fqlmdlicfc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fqlmdlicfc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fqlmdlicfc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fqlmdlicfc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fqlmdlicfc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fqlmdlicfc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fqlmdlicfc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n### New: Calculate ranks using R's `rank()` function\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* However, it includes a difference of 0 in the ranking, and thus below I first remove the row with $d=0$ from the data.\n* In the output below, I called this column `Rank_R`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_Ranks_R <- IOP_ranks %>% \n  filter(d != 0) %>% \n  mutate(\n    # create column with absolute values of differences\n    # it's the absolute values that get ranked\n    abs_d = abs(d), \n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(abs_d, ties.method = \"average\"),\n    Signed_Rank_R = case_when(\n      d < 0 ~ -Rank_R,\n      d > 0 ~ Rank_R\n      )\n    ) \n\nIOP_Ranks_R %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"dvykdcbmnz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dvykdcbmnz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dvykdcbmnz thead, #dvykdcbmnz tbody, #dvykdcbmnz tfoot, #dvykdcbmnz tr, #dvykdcbmnz td, #dvykdcbmnz th {\n  border-style: none;\n}\n\n#dvykdcbmnz p {\n  margin: 0;\n  padding: 0;\n}\n\n#dvykdcbmnz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dvykdcbmnz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dvykdcbmnz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dvykdcbmnz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dvykdcbmnz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dvykdcbmnz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dvykdcbmnz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dvykdcbmnz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dvykdcbmnz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dvykdcbmnz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dvykdcbmnz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dvykdcbmnz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dvykdcbmnz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dvykdcbmnz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dvykdcbmnz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvykdcbmnz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dvykdcbmnz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dvykdcbmnz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dvykdcbmnz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvykdcbmnz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dvykdcbmnz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvykdcbmnz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dvykdcbmnz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvykdcbmnz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dvykdcbmnz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvykdcbmnz .gt_left {\n  text-align: left;\n}\n\n#dvykdcbmnz .gt_center {\n  text-align: center;\n}\n\n#dvykdcbmnz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dvykdcbmnz .gt_font_normal {\n  font-weight: normal;\n}\n\n#dvykdcbmnz .gt_font_bold {\n  font-weight: bold;\n}\n\n#dvykdcbmnz .gt_font_italic {\n  font-style: italic;\n}\n\n#dvykdcbmnz .gt_super {\n  font-size: 65%;\n}\n\n#dvykdcbmnz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dvykdcbmnz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dvykdcbmnz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dvykdcbmnz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dvykdcbmnz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dvykdcbmnz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dvykdcbmnz .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#dvykdcbmnz .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#dvykdcbmnz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"abs_d\">abs_d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank_R\">Rank_R</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_Rank_R\">Signed_Rank_R</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n## Test statistic (Wilcoxon) Signed-rank test\n\n__If the null is true:__\n\n* The population is symmetric around some point ( $\\tilde{\\mu}_0 = 0$ ,\n  typically), and \n\n* The __overall size of the positive ranks should be about the same\n  as the overall size of negative ranks__.\n\nNote: \n\n* The sum of the ranks $1,2,\\dotsc, n$ is always $n(n+1)/2$,\n* which can be broken down as the \n    * sum of the positive ranks ( $T^+$ )\n    * plus the sum of the negative ranks ( $T^-$ )\n\nThus, any of the following can be used as a test statistic and will lead to the same conclusion:\n     \n* $T^+$\n* $T^-$\n* $T^+$ - $T^-$\n* $\\min(T^+,T^âˆ’) = T_0$\n\n\n\n## Example: calculate sums of signed ranks\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_ranks %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kitknorura\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kitknorura table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kitknorura thead, #kitknorura tbody, #kitknorura tfoot, #kitknorura tr, #kitknorura td, #kitknorura th {\n  border-style: none;\n}\n\n#kitknorura p {\n  margin: 0;\n  padding: 0;\n}\n\n#kitknorura .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kitknorura .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kitknorura .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kitknorura .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kitknorura .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kitknorura .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kitknorura .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kitknorura .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kitknorura .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kitknorura .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kitknorura .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kitknorura .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kitknorura .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kitknorura .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kitknorura .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kitknorura .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kitknorura .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kitknorura .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kitknorura .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kitknorura .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kitknorura .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kitknorura .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kitknorura .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kitknorura .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kitknorura .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kitknorura .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kitknorura .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kitknorura .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kitknorura .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kitknorura .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kitknorura .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kitknorura .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kitknorura .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kitknorura .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kitknorura .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kitknorura .gt_left {\n  text-align: left;\n}\n\n#kitknorura .gt_center {\n  text-align: center;\n}\n\n#kitknorura .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kitknorura .gt_font_normal {\n  font-weight: normal;\n}\n\n#kitknorura .gt_font_bold {\n  font-weight: bold;\n}\n\n#kitknorura .gt_font_italic {\n  font-style: italic;\n}\n\n#kitknorura .gt_super {\n  font-size: 65%;\n}\n\n#kitknorura .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kitknorura .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kitknorura .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kitknorura .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kitknorura .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kitknorura .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kitknorura .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#kitknorura .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#kitknorura div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n* Sum of the positive ranks \n    * $T^+$ = 1.5 + 3 + 4.5 + 4.5 + 6 = 19.5\n\n* Sum of the negative ranks\n    * $T^-$ = -1.5\n\n* The sum of the ranks $1,2,\\dotsc, n$ is always $n(n+1)/2$:\n    * $n(n+1)/2 = 6(7)/2 = 21$\n    * $T^+ + |T^-| = 19.5 + |-1.5| = 21$\n\n\n\n## Exact p-value (Wilcoxon) Signed-rank test (fyi) (1/2)\n\n* __Exact p-value__ is preferable\n    * This is the default method in R's `wilcox.test()`\n        * if the samples contain less than 50 finite values \n        * and __there are no ties__\n          * _R will automatically use normal approximation method if there are ties_\n\n* _We will not be calculating the exact p-value \"by hand.\" We will be using R for this._\n\n<hr>\n\n<br>\n\n$$p-value = 2 * P(\\min(T^+,T^âˆ’) \\leq t)$$\n\n* $t$ is the smaller of the calculated sums of the positive and negative ranks\n* To calculate the exact p-value, we need the probability of each possible sum of ranks.\n\n### Exact p-value (Wilcoxon) Signed-rank test (fyi) (2/2)\n\n\n* To calculate the exact p-value, we need the probability of each possible sum of ranks:\n    * list all possible combinations of positive and negative ranks for the sample size,\n    * calculate the sum of the positive ranks ( $T^+$ ) for each possible combination (or $T^-$ ), and\n    * then figure out the probability of each possible $T^+$ (assuming all combinations are equally likely)\n\nExample when $n=3$ : (from https://online.stat.psu.edu/stat415/lesson/20/20.2)\n\n<center><img src=\"img/ExactW_n3.gif\" width=\"50%\">\n<img src=\"img/ExactW_n3_prob.png\" width=\"40%\">\n</center>    \n\nSee https://online.stat.psu.edu/stat415/lesson/20/20.2 for more details.\n\n\n\n## Normal approximation p-value (Wilcoxon) Signed-rank test (fyi)\n\n* __Normal approximation__ method:\n    * If the number of non-zero differences is at least 16, then a normal approximation can be used.\n    * Have the option to apply a continuity correct (default) or not \n* _We will not be calculating the p-value \"by hand.\" We will be using R for this._\n\n<hr>\n\nTest statistic:\n\n$$Z_{T_{min}} = \\frac{T_{min} - \\frac{n(n+1)}{4}}{\\sqrt{\\frac{n(n+1)(2n+1)}{24}}}$$\n\n* $T_{min} = \\min(T^+,T^âˆ’)$\n* $n$ = sample size\n* Test statistic $Z_{T_{min}}$ follows a standard normal distribution $N(0,1)$\n* Use normal distribution to calculate p-value\n\n\nSee https://online.stat.psu.edu/stat415/lesson/20/20.2 for more details.\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with exact p-value & specifying columns for paired data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exact p-value\nwilcox.test(x = IOP$Synth, y = IOP$Adren, paired = TRUE, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$Synth, y = IOP$Adren, paired = TRUE, :\ncannot compute exact p-value with ties\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$Synth, y = IOP$Adren, paired = TRUE, :\ncannot compute exact p-value with zeroes\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$Synth and IOP$Adren\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with exact p-value & running one sample test with differences\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exact p-value\nwilcox.test(x = IOP$d, \n\t\talternative = c(\"two.sided\"), mu = 0, \n\t\texact = TRUE, correct = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$d, alternative = c(\"two.sided\"), :\ncannot compute exact p-value with ties\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$d, alternative = c(\"two.sided\"), :\ncannot compute exact p-value with zeroes\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$d\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location is not equal to 0\n```\n:::\n:::\n\n\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with approximate p-value & specifying columns for paired data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Normal approximation with continuity correction\nwilcox.test(x = IOP$Synth, y = IOP$Adren, paired = TRUE, \n\t\talternative = c(\"two.sided\"), mu = 0, \n\t\texact = FALSE, correct = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$Synth and IOP$Adren\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\nNo more warnings!! However,... should we be using the normal approximation here?\n\n\n\n## Conclusion\n\nRecall the hypotheses to the (Wilcoxon) Signed-rank test:\n\n$H_0:$ the population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is __symmetric around__ $\\tilde{\\mu}_0 =0$  \n$H_a:$ the population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is __not symmetric around__ $\\tilde{\\mu}_0 =0$\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.07314\n\n\n__Conclusion__:\n\nThere is insufficient evidence the differences in reduction in intraocular pressure differs between the synthetic drug and adrenaline are symmetric about 0 (2-sided Wilcoxon signed rank test $p$-value = 0.07314)\n\nHowever,... \n\n\n\n\n# Wilcoxon rank-sum test\n\nFor two independent samples  \na.k.a Mann-Whitney U test\n\n\n## Wilcoxon rank-sum test\n\n* The nonparametric alternative to the two-sample $t$-test\n    * used to analyze two samples selected from separate (independent)\npopulations\n* Also called the Mann-Whitney U test.\n* Unlike the signed-rank test, there is no need to assume symmetry\n\n* Necessary __condition__ is that the two populations being compared \n    * have the same shape (both right skewed, both left skewed, or both symmetric), \n    * so any noted difference is due to a shift in the median\n\n* Since they have the same shape, when summarizing the test, we can describe the results in terms of a difference in medians.  \n\n\n__Hypotheses__:\n\n$H_0:$ the two populations have the same median  \n$H_a:$ the two populations do NOT have the same median\n\n\n\n## Example\n\nDr. Priya Chaudhary (OHSU) examined the evoked membrane current of dental sensory neurons (in rats) under control conditions and a mixture of capsaicin plus capsazepine (CPZ). [J. Dental Research} 80:1518--23, 2001.](https://journals.sagepub.com/doi/10.1177/00220345010800060801)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata <- tibble(\n  control = c(3024, 2164, 864, 780, 125, 110),\n  cap_CPZ = c(426, 232, 130, 94, 75, 55)\n  ) \n\nCPZdata %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"yfdvahlocy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yfdvahlocy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yfdvahlocy thead, #yfdvahlocy tbody, #yfdvahlocy tfoot, #yfdvahlocy tr, #yfdvahlocy td, #yfdvahlocy th {\n  border-style: none;\n}\n\n#yfdvahlocy p {\n  margin: 0;\n  padding: 0;\n}\n\n#yfdvahlocy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yfdvahlocy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yfdvahlocy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yfdvahlocy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yfdvahlocy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yfdvahlocy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yfdvahlocy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yfdvahlocy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yfdvahlocy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yfdvahlocy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yfdvahlocy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yfdvahlocy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yfdvahlocy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yfdvahlocy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yfdvahlocy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yfdvahlocy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yfdvahlocy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yfdvahlocy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yfdvahlocy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yfdvahlocy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yfdvahlocy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yfdvahlocy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yfdvahlocy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yfdvahlocy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yfdvahlocy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yfdvahlocy .gt_left {\n  text-align: left;\n}\n\n#yfdvahlocy .gt_center {\n  text-align: center;\n}\n\n#yfdvahlocy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yfdvahlocy .gt_font_normal {\n  font-weight: normal;\n}\n\n#yfdvahlocy .gt_font_bold {\n  font-weight: bold;\n}\n\n#yfdvahlocy .gt_font_italic {\n  font-style: italic;\n}\n\n#yfdvahlocy .gt_super {\n  font-size: 65%;\n}\n\n#yfdvahlocy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yfdvahlocy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yfdvahlocy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yfdvahlocy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yfdvahlocy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yfdvahlocy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yfdvahlocy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yfdvahlocy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yfdvahlocy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"control\">control</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cap_CPZ\">cap_CPZ</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">426</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">232</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">864</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">130</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">780</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">94</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">125</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">75</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">110</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">55</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\nCPZdata %>% get_summary_stats(type = \"median\") %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"upjlgtcxyk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#upjlgtcxyk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#upjlgtcxyk thead, #upjlgtcxyk tbody, #upjlgtcxyk tfoot, #upjlgtcxyk tr, #upjlgtcxyk td, #upjlgtcxyk th {\n  border-style: none;\n}\n\n#upjlgtcxyk p {\n  margin: 0;\n  padding: 0;\n}\n\n#upjlgtcxyk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#upjlgtcxyk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#upjlgtcxyk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#upjlgtcxyk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#upjlgtcxyk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#upjlgtcxyk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#upjlgtcxyk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#upjlgtcxyk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#upjlgtcxyk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#upjlgtcxyk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#upjlgtcxyk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#upjlgtcxyk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#upjlgtcxyk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#upjlgtcxyk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#upjlgtcxyk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#upjlgtcxyk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#upjlgtcxyk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#upjlgtcxyk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#upjlgtcxyk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#upjlgtcxyk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#upjlgtcxyk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#upjlgtcxyk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#upjlgtcxyk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#upjlgtcxyk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#upjlgtcxyk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#upjlgtcxyk .gt_left {\n  text-align: left;\n}\n\n#upjlgtcxyk .gt_center {\n  text-align: center;\n}\n\n#upjlgtcxyk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#upjlgtcxyk .gt_font_normal {\n  font-weight: normal;\n}\n\n#upjlgtcxyk .gt_font_bold {\n  font-weight: bold;\n}\n\n#upjlgtcxyk .gt_font_italic {\n  font-style: italic;\n}\n\n#upjlgtcxyk .gt_super {\n  font-size: 65%;\n}\n\n#upjlgtcxyk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#upjlgtcxyk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#upjlgtcxyk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#upjlgtcxyk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#upjlgtcxyk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#upjlgtcxyk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#upjlgtcxyk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#upjlgtcxyk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#upjlgtcxyk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_center\">control</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"median\" class=\"gt_row gt_right\">822</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_center\">cap_CPZ</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"median\" class=\"gt_row gt_right\">112</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n## Visualize the data\n\n__Do the independent samples have the same distribution?__\n\nControl group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-20-1.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-20-2.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-20-3.png){width=384}\n:::\n:::\n\n\n\nCap + CPZ group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-21-1.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-21-2.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-21-3.png){width=384}\n:::\n:::\n\n\n\n\n\n## Calculating ranks and test statistic $W$\n\n1. Combine the two samples together (keep track of which observations came from each sample).\n\n2. Rank the full set of $N=n_1 + n_2$ observations. \n    * If ties exist, assign average ranks to the tied values (as with the signed-rank test).\n\n3. Sum the ranks corresponding to those observations from the smaller\nsample. \n    * This is a time-saving step; you could also have used the larger sample.\n    * Call this sum $W$.\n\n4. If $n_1, n_2$ are both less than 10, then use an exact test (can only be done if no ties are present)\n    * otherwise use the  large-sample normal approximation.\n\nIn our example, both groups have equal n; choose either for computing W.\n\n$$W_{CPZ}=1+2+3+6+7+8 = 27$$\n\n$$W_{control}=4+5+9+10+11+12 = 51$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata %>% \n  pivot_longer(cols = c(control,cap_CPZ), \n               names_to = \"Group\",\n               values_to = \"Current\") %>% \n  arrange(Current) %>% \n  mutate(Rank = 1:12)\n\nCPZdata_long %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ljnzxwgucl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ljnzxwgucl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ljnzxwgucl thead, #ljnzxwgucl tbody, #ljnzxwgucl tfoot, #ljnzxwgucl tr, #ljnzxwgucl td, #ljnzxwgucl th {\n  border-style: none;\n}\n\n#ljnzxwgucl p {\n  margin: 0;\n  padding: 0;\n}\n\n#ljnzxwgucl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ljnzxwgucl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ljnzxwgucl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ljnzxwgucl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ljnzxwgucl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ljnzxwgucl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ljnzxwgucl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ljnzxwgucl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ljnzxwgucl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ljnzxwgucl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ljnzxwgucl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ljnzxwgucl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ljnzxwgucl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ljnzxwgucl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ljnzxwgucl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljnzxwgucl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ljnzxwgucl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ljnzxwgucl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ljnzxwgucl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljnzxwgucl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ljnzxwgucl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljnzxwgucl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ljnzxwgucl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljnzxwgucl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ljnzxwgucl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljnzxwgucl .gt_left {\n  text-align: left;\n}\n\n#ljnzxwgucl .gt_center {\n  text-align: center;\n}\n\n#ljnzxwgucl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ljnzxwgucl .gt_font_normal {\n  font-weight: normal;\n}\n\n#ljnzxwgucl .gt_font_bold {\n  font-weight: bold;\n}\n\n#ljnzxwgucl .gt_font_italic {\n  font-style: italic;\n}\n\n#ljnzxwgucl .gt_super {\n  font-size: 65%;\n}\n\n#ljnzxwgucl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ljnzxwgucl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ljnzxwgucl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ljnzxwgucl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ljnzxwgucl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ljnzxwgucl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ljnzxwgucl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ljnzxwgucl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ljnzxwgucl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Current\">Current</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">55</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">75</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">94</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">110</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">125</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">130</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">232</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">426</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">780</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">864</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">12</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n### New: calculate ranks's using `rank()`\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* In the output below, I called this column `Rank_R`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata_long %>% \n  mutate(\n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(Current, ties.method = \"average\")\n    ) \n\nCPZdata_long %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"wkxfnxmhff\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wkxfnxmhff table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wkxfnxmhff thead, #wkxfnxmhff tbody, #wkxfnxmhff tfoot, #wkxfnxmhff tr, #wkxfnxmhff td, #wkxfnxmhff th {\n  border-style: none;\n}\n\n#wkxfnxmhff p {\n  margin: 0;\n  padding: 0;\n}\n\n#wkxfnxmhff .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wkxfnxmhff .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wkxfnxmhff .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wkxfnxmhff .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wkxfnxmhff .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wkxfnxmhff .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wkxfnxmhff .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wkxfnxmhff .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wkxfnxmhff .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wkxfnxmhff .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wkxfnxmhff .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wkxfnxmhff .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wkxfnxmhff .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wkxfnxmhff .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wkxfnxmhff .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wkxfnxmhff .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wkxfnxmhff .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wkxfnxmhff .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wkxfnxmhff .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wkxfnxmhff .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wkxfnxmhff .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wkxfnxmhff .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wkxfnxmhff .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wkxfnxmhff .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wkxfnxmhff .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wkxfnxmhff .gt_left {\n  text-align: left;\n}\n\n#wkxfnxmhff .gt_center {\n  text-align: center;\n}\n\n#wkxfnxmhff .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wkxfnxmhff .gt_font_normal {\n  font-weight: normal;\n}\n\n#wkxfnxmhff .gt_font_bold {\n  font-weight: bold;\n}\n\n#wkxfnxmhff .gt_font_italic {\n  font-style: italic;\n}\n\n#wkxfnxmhff .gt_super {\n  font-size: 65%;\n}\n\n#wkxfnxmhff .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wkxfnxmhff .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wkxfnxmhff .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wkxfnxmhff .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wkxfnxmhff .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wkxfnxmhff .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wkxfnxmhff .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wkxfnxmhff .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wkxfnxmhff div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Current\">Current</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank_R\">Rank_R</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">55</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">75</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">94</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">110</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">125</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">130</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">232</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">426</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">780</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">864</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">11</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">12</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">12</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n \n \n## Exact p-value approach\n\n* __If $n_1, n_2$ are both less than 10, then use an exact test__, \n    * otherwise use the large-sample normal approximation.\n    * However, exact method can only be done if __no ties__ are present\n\n* p-value is the probability of getting a rank sum $W$ as extreme or more extreme than the observed one.\n    * Multiply the 1-tail probability by 2 for the 2-tailed probability\n\n$$p-value = 2 \\cdot P(W_{CPZ} \\leq 27)$$\n\n* To calculate $P(W_{CPZ} \\leq 27)$, \n    * we need to enumerate all possible sets ranks for the sample size,  \n    * calculate the sum of ranks for each set of possible ranks,\n    * and then the probability for each sum (assuming each set of ranks is equally likely).\n\n<hr>\n\n* _We will not be calculating the p-value \"by hand.\" We will be using R for this._\n\n\n\n## Normal approximation approach\n\nIf the null hypothesis is true, then the mean of the sum of the ranks from the smaller-sized group will be\n\n$$\\mu_W = \\dfrac{n_s \\cdot (n_s + n_l + 1)}{2},$$\nwith a standard deviation of\n\n$$\\sigma_W = \\sqrt{ \\dfrac{n_s\\cdot n_l \\cdot (n_s + n_l + 1)}{12} }.$$\nProvided both groups are large ( $\\geq 10$ ),\n\n$$Z = \\frac{W - \\mu_W}{\\sigma_W}  \\approx Normal(0,1)$$\n\n\n\n### Example:\n\nWe have $W=27$ and $n_l = n_s = 6$:\n\n$$\\mu_W = \\dfrac{6 \\cdot (6 + 6 +1 )}{2} = 39 \\\\\n\\sigma_W  = \\sqrt{\\dfrac{6\\cdot 6 \\cdot (6+6+1)}{12}} = \\sqrt{39} \\approx 6.2450 \\\\\nz \\approx \\frac{27-39}{6.2450} = -1.921538$$\n\n\nThe two-sided $p$-value is \n$$p=2 \\cdot P(Z < -1.921538)=0.05466394$$ \n\n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\n2 * pnorm((27-39) / sqrt(39))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05466394\n```\n:::\n:::\n\n\n\n\n\n## Wilcoxon rank-sum test in R: with wide data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(CPZdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 6\nColumns: 2\n$ control <dbl> 3024, 2164, 864, 780, 125, 110\n$ cap_CPZ <dbl> 426, 232, 130, 94, 75, 55\n```\n:::\n:::\n\n\n\n\nExact p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n            alternative = c(\"two.sided\"), mu = 0, \n            exact = TRUE) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  CPZdata$cap_CPZ and CPZdata$control\nW = 6, p-value = 0.06494\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n\n\n## Wilcoxon rank-sum test in R: with wide data\n\nNormal approximation p-value without CC\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = FALSE, correct = FALSE) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"zfuamxjmco\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zfuamxjmco table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zfuamxjmco thead, #zfuamxjmco tbody, #zfuamxjmco tfoot, #zfuamxjmco tr, #zfuamxjmco td, #zfuamxjmco th {\n  border-style: none;\n}\n\n#zfuamxjmco p {\n  margin: 0;\n  padding: 0;\n}\n\n#zfuamxjmco .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zfuamxjmco .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zfuamxjmco .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zfuamxjmco .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zfuamxjmco .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zfuamxjmco .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zfuamxjmco .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zfuamxjmco .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zfuamxjmco .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zfuamxjmco .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zfuamxjmco .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zfuamxjmco .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zfuamxjmco .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zfuamxjmco .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zfuamxjmco .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zfuamxjmco .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zfuamxjmco .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zfuamxjmco .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zfuamxjmco .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zfuamxjmco .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zfuamxjmco .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zfuamxjmco .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zfuamxjmco .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zfuamxjmco .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zfuamxjmco .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zfuamxjmco .gt_left {\n  text-align: left;\n}\n\n#zfuamxjmco .gt_center {\n  text-align: center;\n}\n\n#zfuamxjmco .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zfuamxjmco .gt_font_normal {\n  font-weight: normal;\n}\n\n#zfuamxjmco .gt_font_bold {\n  font-weight: bold;\n}\n\n#zfuamxjmco .gt_font_italic {\n  font-style: italic;\n}\n\n#zfuamxjmco .gt_super {\n  font-size: 65%;\n}\n\n#zfuamxjmco .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zfuamxjmco .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zfuamxjmco .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zfuamxjmco .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zfuamxjmco .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zfuamxjmco .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zfuamxjmco .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zfuamxjmco .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zfuamxjmco div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.05466394</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nNormal approximation p-value with CC\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = FALSE, correct = TRUE) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mfifjblpha\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mfifjblpha table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mfifjblpha thead, #mfifjblpha tbody, #mfifjblpha tfoot, #mfifjblpha tr, #mfifjblpha td, #mfifjblpha th {\n  border-style: none;\n}\n\n#mfifjblpha p {\n  margin: 0;\n  padding: 0;\n}\n\n#mfifjblpha .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mfifjblpha .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mfifjblpha .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mfifjblpha .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mfifjblpha .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mfifjblpha .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mfifjblpha .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mfifjblpha .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mfifjblpha .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mfifjblpha .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mfifjblpha .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mfifjblpha .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mfifjblpha .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mfifjblpha .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mfifjblpha .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mfifjblpha .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mfifjblpha .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mfifjblpha .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mfifjblpha .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mfifjblpha .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mfifjblpha .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mfifjblpha .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mfifjblpha .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mfifjblpha .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mfifjblpha .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mfifjblpha .gt_left {\n  text-align: left;\n}\n\n#mfifjblpha .gt_center {\n  text-align: center;\n}\n\n#mfifjblpha .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mfifjblpha .gt_font_normal {\n  font-weight: normal;\n}\n\n#mfifjblpha .gt_font_bold {\n  font-weight: bold;\n}\n\n#mfifjblpha .gt_font_italic {\n  font-style: italic;\n}\n\n#mfifjblpha .gt_super {\n  font-size: 65%;\n}\n\n#mfifjblpha .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mfifjblpha .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mfifjblpha .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mfifjblpha .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mfifjblpha .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mfifjblpha .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mfifjblpha .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mfifjblpha .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mfifjblpha div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.06555216</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum test with continuity correction</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n## Wilcoxon rank-sum test in R: with long data\n\nMake data long (if it's not already long):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata %>% \n  pivot_longer(cols = c(control,cap_CPZ), \n               names_to = \"Group\",\n               values_to = \"Current\")\n\nhead(CPZdata_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 2\n  Group   Current\n  <chr>     <dbl>\n1 control    3024\n2 cap_CPZ     426\n3 control    2164\n4 cap_CPZ     232\n5 control     864\n6 cap_CPZ     130\n```\n:::\n:::\n\n\n\n\n\n\nExact p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(Current ~ Group, \n            data = CPZdata_long, \n            alternative = c(\"two.sided\"), \n            mu = 0, \n            exact = TRUE) %>% \n  tidy() %>% gt() \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"jabtqqzsav\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jabtqqzsav table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jabtqqzsav thead, #jabtqqzsav tbody, #jabtqqzsav tfoot, #jabtqqzsav tr, #jabtqqzsav td, #jabtqqzsav th {\n  border-style: none;\n}\n\n#jabtqqzsav p {\n  margin: 0;\n  padding: 0;\n}\n\n#jabtqqzsav .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jabtqqzsav .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jabtqqzsav .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jabtqqzsav .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jabtqqzsav .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jabtqqzsav .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jabtqqzsav .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jabtqqzsav .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jabtqqzsav .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jabtqqzsav .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jabtqqzsav .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jabtqqzsav .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jabtqqzsav .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jabtqqzsav .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jabtqqzsav .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jabtqqzsav .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jabtqqzsav .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jabtqqzsav .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jabtqqzsav .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jabtqqzsav .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jabtqqzsav .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jabtqqzsav .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jabtqqzsav .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jabtqqzsav .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jabtqqzsav .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jabtqqzsav .gt_left {\n  text-align: left;\n}\n\n#jabtqqzsav .gt_center {\n  text-align: center;\n}\n\n#jabtqqzsav .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jabtqqzsav .gt_font_normal {\n  font-weight: normal;\n}\n\n#jabtqqzsav .gt_font_bold {\n  font-weight: bold;\n}\n\n#jabtqqzsav .gt_font_italic {\n  font-style: italic;\n}\n\n#jabtqqzsav .gt_super {\n  font-size: 65%;\n}\n\n#jabtqqzsav .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jabtqqzsav .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jabtqqzsav .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jabtqqzsav .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jabtqqzsav .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jabtqqzsav .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jabtqqzsav .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jabtqqzsav .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jabtqqzsav div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.06493506</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum exact test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n\n\n\n## Conclusion\n\n\n\nRecall the hypotheses to the (Wilcoxon) Signed-rank test:\n\n$H_0:$ the control and treated populations have the same median  \n$H_a:$ the control and treated populations do NOT have the same median\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.06494\n\n\n__Conclusion__:\n\nThere is suggestive but inconclusive evidence that the evoked membrane current of dental sensory neurons (in rats) differs between the control group and the group exposed to a mixture of capsaicin plus capsazepine (2-sided Wilcoxon rank-sum test $p$-value = 0.06494).\n\n\n\n# Kruskal-Wallis test\n\nNonparametric ANOVA test\n\n\n## Kruskal-Wallis test: nonparametric ANOVA test\n\n* Recall that an ANOVA tests means from more than 2 groups\n* Conditions for ANOVA include\n    * Sample sizes in each group group are large (each $n \\ge 30$),  \n        * OR the data are relatively normally distributed in each group\n    * Variability is \"similar\" in all group groups\n\n* If these conditions are in doubt, or if the response is ordinal, then the Kruskal-Wallis test is an alternative.\n\n\\begin{align}\nH_0 &: \\text{pop median}_1 = \\text{pop median}_2 = ... = \\text{pop median}_k\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\text{pop median}_i \\neq \\text{pop median}_j \\text{ for } i \\neq j\n\\end{align}\n\n* K-W test is an extension of the (Wilcoxon) rank-sum test to more than 2 groups\n    * With $k=2$ groups, the K-W test is the same as the rank-sum test\n\n\n\n## K-W test statistic: $H$ (fyi)\n\n$$H = \\frac{12}{{N(N + 1)}} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N + 1)$$\n\n* $k$ is the number of groups,\n* $n_i$ is the number of observations in group  $i$\n* $N = n_1 + \\ldots + n_k$ is the total number of observations across all groups,\n* $R_i$ is the sum of ranks for group $i$\n\nThe test statistic $H$ has a Chi-squared distribution with $k-1$ degrees of freedom:\n\n$$H \\sim \\chi^2_{k-1}$$\n\nRanks are calculated similarly to the (Wilcoxon) rank-sum test.\n\n\n\n## Ranks for the K-W test\n\n1. Combine the $k$ samples together (keep track of which observations came from each sample).\n2. Rank the full set of $N = n_1 + \\ldots + n_k$ observations. \n    * If ties exist, assign average ranks to the tied values (as with the signed-rank test).\n3. Then sum the ranks within each of the $k$ groups\n    * Label the sums of the ranks for each group as $R_1, \\ldots + R_k$.\n\nIf $H_0$ is true, we expect the populations to have the same medians, and thus the ranks to be similar as well.\n\n\n\n## Example: Ozone levels by month \n\n* `airquality` data included in base R - no need to load it\n* Daily air quality measurements in New York, May to September 1973.\n* Question: do ozone levels differ by month?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 153\nColumns: 6\n$ Ozone   <int> 41, 36, 12, 18, NA, 28, 23, 19, 8, NA, 7, 16, 11, 14, 18, 14, â€¦\n$ Solar.R <int> 190, 118, 149, 313, NA, NA, 299, 99, 19, 194, NA, 256, 290, 27â€¦\n$ Wind    <dbl> 7.4, 8.0, 12.6, 11.5, 14.3, 14.9, 8.6, 13.8, 20.1, 8.6, 6.9, 9â€¦\n$ Temp    <int> 67, 72, 74, 62, 56, 66, 65, 59, 61, 69, 74, 69, 66, 68, 58, 64â€¦\n$ Month   <int> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,â€¦\n$ Day     <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,â€¦\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nOz_mnth <- airquality %>% \n  group_by(Month) %>% \n  get_summary_stats(Ozone, \n    show = c(\"n\", \"mean\", \"median\", \"sd\"))\nOz_mnth %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hlolsncvxx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hlolsncvxx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hlolsncvxx thead, #hlolsncvxx tbody, #hlolsncvxx tfoot, #hlolsncvxx tr, #hlolsncvxx td, #hlolsncvxx th {\n  border-style: none;\n}\n\n#hlolsncvxx p {\n  margin: 0;\n  padding: 0;\n}\n\n#hlolsncvxx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hlolsncvxx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hlolsncvxx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hlolsncvxx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hlolsncvxx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hlolsncvxx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hlolsncvxx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hlolsncvxx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hlolsncvxx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hlolsncvxx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hlolsncvxx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hlolsncvxx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hlolsncvxx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hlolsncvxx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hlolsncvxx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hlolsncvxx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hlolsncvxx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hlolsncvxx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hlolsncvxx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hlolsncvxx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hlolsncvxx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hlolsncvxx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hlolsncvxx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hlolsncvxx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hlolsncvxx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hlolsncvxx .gt_left {\n  text-align: left;\n}\n\n#hlolsncvxx .gt_center {\n  text-align: center;\n}\n\n#hlolsncvxx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hlolsncvxx .gt_font_normal {\n  font-weight: normal;\n}\n\n#hlolsncvxx .gt_font_bold {\n  font-weight: bold;\n}\n\n#hlolsncvxx .gt_font_italic {\n  font-style: italic;\n}\n\n#hlolsncvxx .gt_super {\n  font-size: 65%;\n}\n\n#hlolsncvxx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hlolsncvxx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hlolsncvxx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hlolsncvxx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hlolsncvxx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hlolsncvxx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hlolsncvxx .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hlolsncvxx .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hlolsncvxx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Month\">Month</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">5</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">23.615</td>\n<td headers=\"median\" class=\"gt_row gt_right\">18</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">22.224</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">6</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">9</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">29.444</td>\n<td headers=\"median\" class=\"gt_row gt_right\">23</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">18.208</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">7</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">59.115</td>\n<td headers=\"median\" class=\"gt_row gt_right\">60</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">31.636</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">8</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">59.962</td>\n<td headers=\"median\" class=\"gt_row gt_right\">52</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">39.681</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">9</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">29</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">31.448</td>\n<td headers=\"median\" class=\"gt_row gt_right\">23</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">24.142</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\nmax(Oz_mnth$sd) / min(Oz_mnth$sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.179317\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(airquality,\n       aes(x = Ozone, y = factor(Month))) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](17_Non_parametric_files/figure-html/unnamed-chunk-33-1.png){width=384}\n:::\n:::\n\n\n\n\n\n## Example: calculate ranks (fyi) \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth <- airquality %>% \n  select(Ozone, Month) \n\nsummary(ranks_Oz_mnth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Ozone            Month      \n Min.   :  1.00   Min.   :5.000  \n 1st Qu.: 18.00   1st Qu.:6.000  \n Median : 31.50   Median :7.000  \n Mean   : 42.13   Mean   :6.993  \n 3rd Qu.: 63.25   3rd Qu.:8.000  \n Max.   :168.00   Max.   :9.000  \n NA's   :37                      \n```\n:::\n\n```{.r .cell-code}\nranks_Oz_mnth <- ranks_Oz_mnth %>% \n  drop_na(Ozone) %>% \n  arrange(Ozone) %>% \n  mutate(Rank = 1:nrow(.))\n```\n:::\n\n\n\nRanks below do not take into account ties!!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ranks_Oz_mnth, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Ozone Month Rank\n1      1     5    1\n2      4     5    2\n3      6     5    3\n4      7     5    4\n5      7     7    5\n6      7     9    6\n7      8     5    7\n8      9     8    8\n9      9     8    9\n10     9     9   10\n11    10     7   11\n12    11     5   12\n13    11     5   13\n14    11     5   14\n15    12     5   15\n16    12     6   16\n17    13     6   17\n18    13     9   18\n19    13     9   19\n20    13     9   20\n```\n:::\n:::\n\n\n\n\nSum of ranks for each group: (not taking into account ties!!)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth %>% \n  group_by(Month) %>% \n  summarise(sumRank = sum(Rank))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 Ã— 2\n  Month sumRank\n  <int>   <int>\n1     5     939\n2     6     434\n3     7    2023\n4     8    1956\n5     9    1434\n```\n:::\n:::\n\n\n\n\n\n### New: calculate ranks's using `rank()`\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* In the output below, I called this column `Rank_R`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth <- ranks_Oz_mnth %>% \n  mutate(\n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(Ozone, ties.method = \"average\")\n    ) \n\n# Compare \"simple\" ranks not including ties with tie-corrected ranks\nhead(ranks_Oz_mnth, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Ozone Month Rank Rank_R\n1      1     5    1    1.0\n2      4     5    2    2.0\n3      6     5    3    3.0\n4      7     5    4    5.0\n5      7     7    5    5.0\n6      7     9    6    5.0\n7      8     5    7    7.0\n8      9     8    8    9.0\n9      9     8    9    9.0\n10     9     9   10    9.0\n11    10     7   11   11.0\n12    11     5   12   13.0\n13    11     5   13   13.0\n14    11     5   14   13.0\n15    12     5   15   15.5\n16    12     6   16   15.5\n17    13     6   17   18.5\n18    13     9   18   18.5\n19    13     9   19   18.5\n20    13     9   20   18.5\n```\n:::\n:::\n\n\n\n\n## K-W test in R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(Ozone ~ Month, data = airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Ozone by Month\nKruskal-Wallis chi-squared = 29.267, df = 4, p-value = 6.901e-06\n```\n:::\n\n```{.r .cell-code}\nkruskal.test(Ozone ~ Month, data = airquality) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"rjnmgcdrvl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rjnmgcdrvl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rjnmgcdrvl thead, #rjnmgcdrvl tbody, #rjnmgcdrvl tfoot, #rjnmgcdrvl tr, #rjnmgcdrvl td, #rjnmgcdrvl th {\n  border-style: none;\n}\n\n#rjnmgcdrvl p {\n  margin: 0;\n  padding: 0;\n}\n\n#rjnmgcdrvl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rjnmgcdrvl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rjnmgcdrvl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rjnmgcdrvl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rjnmgcdrvl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rjnmgcdrvl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rjnmgcdrvl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rjnmgcdrvl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rjnmgcdrvl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rjnmgcdrvl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rjnmgcdrvl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rjnmgcdrvl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rjnmgcdrvl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rjnmgcdrvl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rjnmgcdrvl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjnmgcdrvl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rjnmgcdrvl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rjnmgcdrvl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rjnmgcdrvl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjnmgcdrvl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rjnmgcdrvl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjnmgcdrvl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rjnmgcdrvl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjnmgcdrvl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjnmgcdrvl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjnmgcdrvl .gt_left {\n  text-align: left;\n}\n\n#rjnmgcdrvl .gt_center {\n  text-align: center;\n}\n\n#rjnmgcdrvl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rjnmgcdrvl .gt_font_normal {\n  font-weight: normal;\n}\n\n#rjnmgcdrvl .gt_font_bold {\n  font-weight: bold;\n}\n\n#rjnmgcdrvl .gt_font_italic {\n  font-style: italic;\n}\n\n#rjnmgcdrvl .gt_super {\n  font-size: 65%;\n}\n\n#rjnmgcdrvl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rjnmgcdrvl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rjnmgcdrvl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rjnmgcdrvl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rjnmgcdrvl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rjnmgcdrvl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rjnmgcdrvl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rjnmgcdrvl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rjnmgcdrvl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">29.26658</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">6.900714e-06</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">4</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Kruskal-Wallis rank sum test</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nThere is sufficient evidence that the median ozone levels are different in at least two months from May - September, 1973 in New York City (p < 0.001; Kruskal-Wallis test).\n\n\n* (fyi) Since the K-W test is significant, follow-up with pairwise (Wilcoxon) rank-sum tests using a multiple comparison procedure to identify which months have different medians.\n\n\n\n\n# Permutation tests & bootstrapping\n\nanother option to consider\n\n\n\n## Permutation tests & bootstrapping\n\n* In some cases we saw that the conditions failed or the sample size was too small for a normal approximation and there were ties in ranks preventing us from using an exact method.\n\n* Another nonparametric option to consider is a permutation test or bootstrapping.\n\n* If you're interested in learning more about this approach, check out the [ModernDive Statistical Inference via Data Science](https://moderndive.com/index.html) book by Chester Ismay and Albert Kim.\n    * Ch 7: [Sampling](https://moderndive.com/7-sampling.html)\n    * Ch 8: [Bootstrapping and Confidence Intervals](https://moderndive.com/8-confidence-intervals.html)\n    * Ch 9: [Hypothesis Testing](https://moderndive.com/9-hypothesis-testing.html)\n\n\n\n\n\n\n\n  \n",
    "supporting": [
      "17_Non_parametric_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}