{
  "hash": "04806f94223a1d95fe4caed26ae1ec3f",
  "result": {
    "markdown": "---\ntitle: \"Lesson 19: Nonparametric tests\"\nsubtitle: \"Other TB\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#3070BF\"\ndate: \"12/4/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 19 Slides\n    html-math-method: mathjax\n    highlight-style: arrow\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n# Learning Objectives\n\n## Time for final course evals!\n\n## Load packages\n\n* Packages need to be loaded _every time_ you restart R or render an Qmd file\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run these every time you open Rstudio\nlibrary(tidyverse)    \nlibrary(oibiostat)\nlibrary(janitor)\nlibrary(rstatix)\nlibrary(knitr)\nlibrary(gtsummary)\nlibrary(moderndive)\nlibrary(gt)\nlibrary(broom) \nlibrary(here) \nlibrary(pwr) \nlibrary(BSDA)  # NEW package!!!\nlibrary(epitools)\n```\n:::\n\n\n\n- You can check whether a package has been loaded or not \n  - by looking at the Packages tab and \n  - seeing whether it has been checked off or not\n  \n  \n\n# MoRitz's tip: write \"nice\" R code\n\nCheck out the tidyverse style guide: https://style.tidyverse.org/index.html\n\nEspecially, Chapter 4: [Pipes](https://style.tidyverse.org/pipes.html#pipes) and  Chapter 5: [ggplot2](https://style.tidyverse.org/ggplot2.html#ggplot2)\n\n\n\n# Goals for today (Supplemental material)\n\n\n* Why us a nonparametric approach?\n* What the following tests are & when to use them\n\n* __Sign test__ \n    * for paired data or single samples\n* __(Wilcoxon) sign-rank test__ \n    * for paired data or single samples\n    * accounts for sizes of differences\n* __Wilcoxon Rank-sum test__ \n    * for two independent samples\n    * a.k.a __Mann-Whitney U test__\n* __Kruskal-Wallis test__\n    * nonparametric ANOVA test\n\n\n* How to use R for each test & interpret the results\n\n## Additional resource\n\n* Chapter 13: Nonparametric tests of Pagano's _Principles of Biostatistics_, 2022 edition\n* Can download chapter from OHSU library eBook at <https://ebookcentral.proquest.com/lib/ohsu/detail.action?docID=6950388&pq-origsite=primo>\n\n\n# Nonparametric tests\n\n## Background: parametric vs nonparametric\n\n* Prior inference of means methods had conditions assuming the underlying population(s) was (were) normal (or at least approximately normal).\n* Normal distribution is completely described (parameterized) by two parameters: $\\mu$ and $\\sigma$. \n* The first was often the parameter of interest, while the latter was assumed known ( $Z$-test) or estimated ( $t$-tests).\n* The above are therefore described as __parametric__ procedures.\n\n* __Nonparametric__ procedures \n    * Make fewer assumptions about the structure of the underlying  population from which the samples were collected.\n    * Work well when distributional assumptions are in doubt.\n   \n\n\n## The good and the bad about nonparametric tests\n\n__Good__  \n\n* Fewer assumptions \n* Tests are based on ranks\n    * Therefore outliers have no greater influence than non-outliers.\n    * Since tests are based on ranks we can apply these procedures to\nordinal data \n        * (where means and standard deviations are not meaningful).\n\n__Drawbacks__\n\n* Less powerful than parametric tests (due to loss of information when data are converted to ranks)\n* While the test is easy, it may require substantial (computer) work to develop a confidence interval [by \"inverting\" the test].\n* Theory was developed for continuous data (where ties are not possible); if population or data contain many ties, then a correction to the procedures must be implemented.\n* Some procedures have \"large\" and \"small\" sample versions; the small sample versions require special tables or a computer.\n\n\n\n# Sign test\n\nFor paired data or single samples\n\n\n\n## Example: Intraocular pressure of glaucoma patients\n\n\n* Intraocular pressure of glaucoma patients is often reduced by treatment with adrenaline. \n* A __new synthetic drug__ is being considered, but it is more expensive than the __current adrenaline alternative__. \n* 7 glaucoma patients were treated with both drugs: \n    * one eye with adrenaline and \n    * the other with the synthetic drug\n* __Reduction in pressure__ was recorded in each eye after following treatment (larger numbers indicate greater reduction)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_table <- tibble(\n  Patient = 1:7,\n  Adren = c(3.5, 2.6, 3, 1.9, 2.9, 2.4, 2),\n  Synth = c(3.2, 3.1, 3.3, 2.4, 2.9, 2.8, 2.6)\n  ) %>% \n  mutate(\n    d = Synth - Adren,\n    Sign = case_when(\n      d < 0 ~ \"-\",\n      d > 0 ~ \"+\"\n      )\n    )\nIOP_table %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"wmvhufoqzr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wmvhufoqzr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wmvhufoqzr thead, #wmvhufoqzr tbody, #wmvhufoqzr tfoot, #wmvhufoqzr tr, #wmvhufoqzr td, #wmvhufoqzr th {\n  border-style: none;\n}\n\n#wmvhufoqzr p {\n  margin: 0;\n  padding: 0;\n}\n\n#wmvhufoqzr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wmvhufoqzr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wmvhufoqzr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wmvhufoqzr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wmvhufoqzr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wmvhufoqzr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wmvhufoqzr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wmvhufoqzr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wmvhufoqzr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wmvhufoqzr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wmvhufoqzr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wmvhufoqzr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wmvhufoqzr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wmvhufoqzr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wmvhufoqzr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wmvhufoqzr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wmvhufoqzr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wmvhufoqzr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wmvhufoqzr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wmvhufoqzr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wmvhufoqzr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wmvhufoqzr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wmvhufoqzr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wmvhufoqzr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wmvhufoqzr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wmvhufoqzr .gt_left {\n  text-align: left;\n}\n\n#wmvhufoqzr .gt_center {\n  text-align: center;\n}\n\n#wmvhufoqzr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wmvhufoqzr .gt_font_normal {\n  font-weight: normal;\n}\n\n#wmvhufoqzr .gt_font_bold {\n  font-weight: bold;\n}\n\n#wmvhufoqzr .gt_font_italic {\n  font-style: italic;\n}\n\n#wmvhufoqzr .gt_super {\n  font-size: 65%;\n}\n\n#wmvhufoqzr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wmvhufoqzr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wmvhufoqzr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wmvhufoqzr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wmvhufoqzr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wmvhufoqzr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wmvhufoqzr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wmvhufoqzr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wmvhufoqzr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n* __d__ is the difference in reduction of pressure: __Synth - Adren__\n* __Sign__ is `+` if the difference is positive and `-` if the difference is negative\n\n\n\n\n### Visualize the differences\n\nVisualize the differences in reduction of pressure $d$ : __Synth - Adren__\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IOP_table, aes(x = d)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-4-1.png){width=384}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IOP_table, aes(x = d)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-5-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n## Hypotheses & \"statistic\" (Sign test)\n\n\n__Hypotheses__\n\n$H_0:$ The median difference in the population is 0  \n$H_a:$ The median difference in the population is NOT 0\n\n<hr>\n\n__\"Statistic\"__  \n\n$D^+$ = number of positive differences  \n$D^-$ = number of negative differences\n\n<hr>\n\nWhat are $D^+$ and $D^-$ for our example?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_table %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hwcrxiwsbb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hwcrxiwsbb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hwcrxiwsbb thead, #hwcrxiwsbb tbody, #hwcrxiwsbb tfoot, #hwcrxiwsbb tr, #hwcrxiwsbb td, #hwcrxiwsbb th {\n  border-style: none;\n}\n\n#hwcrxiwsbb p {\n  margin: 0;\n  padding: 0;\n}\n\n#hwcrxiwsbb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hwcrxiwsbb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hwcrxiwsbb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hwcrxiwsbb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hwcrxiwsbb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hwcrxiwsbb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hwcrxiwsbb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hwcrxiwsbb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hwcrxiwsbb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hwcrxiwsbb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hwcrxiwsbb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hwcrxiwsbb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hwcrxiwsbb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hwcrxiwsbb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hwcrxiwsbb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hwcrxiwsbb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hwcrxiwsbb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hwcrxiwsbb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hwcrxiwsbb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hwcrxiwsbb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hwcrxiwsbb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hwcrxiwsbb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hwcrxiwsbb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hwcrxiwsbb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hwcrxiwsbb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hwcrxiwsbb .gt_left {\n  text-align: left;\n}\n\n#hwcrxiwsbb .gt_center {\n  text-align: center;\n}\n\n#hwcrxiwsbb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hwcrxiwsbb .gt_font_normal {\n  font-weight: normal;\n}\n\n#hwcrxiwsbb .gt_font_bold {\n  font-weight: bold;\n}\n\n#hwcrxiwsbb .gt_font_italic {\n  font-style: italic;\n}\n\n#hwcrxiwsbb .gt_super {\n  font-size: 65%;\n}\n\n#hwcrxiwsbb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hwcrxiwsbb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hwcrxiwsbb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hwcrxiwsbb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hwcrxiwsbb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hwcrxiwsbb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hwcrxiwsbb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hwcrxiwsbb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hwcrxiwsbb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n## Exact p-value (Sign test)\n\n* If the median difference is 0 ( $H_0$ is true) , then \n      * half the population consists of positive differences \n      * while half have negative differences.\n\n* Let $p=P(\\textrm{neg. diff.})=P(\\textrm{pos. diff.})= 0.5$\n\n<hr>\n\n* If the median difference is 0 ( $H_0$ is true), \n      * then a sample of $n$ differences \n          * behaves like $n$ trials in a binomial experiment \n          * where \"success\" is analogous to seeing a positive difference.\n      * By symmetry ( $p=0.5$ ), the same distribution applies to negative differences, i.e.,\n\n$$D^+ \\textrm{ and } D^- \\sim \\textrm{Bin}(n,p=0.5)$$ \n<hr>\n\n* Thus the (exact) p-value is calculated using the Binomial distribution\n\n\n\n\n## Glaucoma example (exact) p-value\n\n\n* 7 differences: \n  * 1 negative ( $D^-$ )\n  * 5 were positive ( $D^+$ )\n  * 1 difference is 0 and is discarded\n* Thus the effective sample size is $n=6$.\n\n<hr>\n__One-sided p-value__ = probability that we would see 1 or fewer negative signs among the $n=6$ differences, if the median difference is really 0\n\n<hr>\n\n__Two-sided p-value__ = 2 $\\times$ One-sided p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2-sided p-value: 2*P(D^- <= 1)\n2*pbinom(1, size = 6, p = 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.21875\n```\n:::\n:::\n\n\n\n\n$$D^- \\sim \\textrm{Bin}(n=6,p=0.5)$$ \n\n<br>\n\n<hr>\n\n$$p-value = P(D^- \\leq 1) \\\\\n= P(D^-=0) + P(D^-=1) \\\\\n= \\frac{6!}{0!6!} (0.5)^6 + \\frac{6!}{1!5!} (0.5)^6 \\\\\n\\approx 0.1094$$\n\n<hr>\n\n$$p-value \\times 2 \\approx 0.2188$$\n\n\n\n## Sign test in R: Glaucoma example\n\nBelow we create the dataset as a tibble (and add the signs):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP <- tibble(\n  Patient = 1:7,\n  Adren = c(3.5, 2.6, 3, 1.9, 2.9, 2.4, 2),\n  Synth = c(3.2, 3.1, 3.3, 2.4, 2.9, 2.8, 2.6)\n  ) %>% \n  mutate(d = Synth - Adren,\n    Sign = case_when(\n      d < 0 ~ \"-\",\n      d > 0 ~ \"+\"))\n\nIOP %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"uelpqaevyq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uelpqaevyq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uelpqaevyq thead, #uelpqaevyq tbody, #uelpqaevyq tfoot, #uelpqaevyq tr, #uelpqaevyq td, #uelpqaevyq th {\n  border-style: none;\n}\n\n#uelpqaevyq p {\n  margin: 0;\n  padding: 0;\n}\n\n#uelpqaevyq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uelpqaevyq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uelpqaevyq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uelpqaevyq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uelpqaevyq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uelpqaevyq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uelpqaevyq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uelpqaevyq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uelpqaevyq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uelpqaevyq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uelpqaevyq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uelpqaevyq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uelpqaevyq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uelpqaevyq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uelpqaevyq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uelpqaevyq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uelpqaevyq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uelpqaevyq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uelpqaevyq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uelpqaevyq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uelpqaevyq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uelpqaevyq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uelpqaevyq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uelpqaevyq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uelpqaevyq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uelpqaevyq .gt_left {\n  text-align: left;\n}\n\n#uelpqaevyq .gt_center {\n  text-align: center;\n}\n\n#uelpqaevyq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uelpqaevyq .gt_font_normal {\n  font-weight: normal;\n}\n\n#uelpqaevyq .gt_font_bold {\n  font-weight: bold;\n}\n\n#uelpqaevyq .gt_font_italic {\n  font-style: italic;\n}\n\n#uelpqaevyq .gt_super {\n  font-size: 65%;\n}\n\n#uelpqaevyq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uelpqaevyq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uelpqaevyq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uelpqaevyq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uelpqaevyq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uelpqaevyq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uelpqaevyq .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#uelpqaevyq .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#uelpqaevyq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nRecall we're testing the population median.  \nHere's the sample median:\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian(IOP$d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4\n```\n:::\n:::\n\n\n\n\n## Sign test in R: Glaucoma example (specifying both columns)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(BSDA)  # new package!! Make sure to first install it\n# Can't \"tidy\" the output\nSIGN.test(x = IOP$Synth, y = IOP$Adren, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDependent-samples Sign-Test\n\ndata:  IOP$Synth and IOP$Adren\nS = 5, p-value = 0.2187\nalternative hypothesis: true median difference is not equal to 0\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x-y \n          0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n### Sign test in R: Glaucoma example (specifying differences)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Note output calls this a \"One-sample Sign-Test\"\nSIGN.test(x = IOP$d, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-sample Sign-Test\n\ndata:  IOP$d\ns = 5, p-value = 0.2187\nalternative hypothesis: true median is not equal to 0\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x \n        0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n## Conclusion\n\n\nRecall the hypotheses to the sign test:\n\n$H_0:$ The median population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is 0.\n\n$H_a:$ The median population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is NOT 0.\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.2188\n\n\n__Conclusion__:\n\nThe median difference in reduction of intraocular pressure between eyes being treated with the synthetic drug and adrenaline for seven glaucoma patients was 0.4 (95% CI: -0.2, 0.6).  \nThere is insufficient evidence the reduction in intraocular pressure differs when using the synthetic drug and adrenaline (2-sided sign test $p$-value = 0.219). \n\n\n\n## Sign test with large samples: p-value normal approximation\n\n* If the sample size is large, say greater than 20, \n    * then binomial probabilities can be approximated using normal probabilities\n\n* Normal approximation: \n\n$$\\mu = np =n(0.5)=n/2\\\\\n\\sigma=\\sqrt{np(1-p)}=\\sqrt{n(0.5)(0.5)}= \\sqrt{n}/2$$\n\n* Thus we have the test statistic:\n\n$$z=\\frac{D^- −n/2}{\\sqrt{n}/2}$$\n\n* With access to a computer, it's better to use the exact binomial probabilities instead of the normal approximation.\n\n\n\n## Sign test with one sample\n\n* One can use the sign test when testing just one sample.\n* Note that we did this when in R, when running the sign test using just the differences.\n* For one sample, we can specify the null population median value:\n\n$H_0:$ The population median is $m$  \n$H_a:$ The population median is NOT $m$\n\nExample: Run sign test for paired data with null $m = 0.7$: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIGN.test(x = IOP$d, md = 0.7, alternative = \"two.sided\", conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-sample Sign-Test\n\ndata:  IOP$d\ns = 0, p-value = 0.01562\nalternative hypothesis: true median is not equal to 0.7\n95 percent confidence interval:\n -0.2057143  0.5685714\nsample estimates:\nmedian of x \n        0.4 \n\nAchieved and Interpolated Confidence Intervals: \n\n                  Conf.Level  L.E.pt U.E.pt\nLower Achieved CI     0.8750  0.0000 0.5000\nInterpolated CI       0.9500 -0.2057 0.5686\nUpper Achieved CI     0.9844 -0.3000 0.6000\n```\n:::\n:::\n\n\n\n\n\n# (Wilcoxon) Signed-rank test\n\nFor paired data or single samples;  \naccounts for sizes of differences\n\n\n## (Wilcoxon) Signed-rank test\n\n* Like the sign test, the (Wilcoxon) signed-rank test is used for\n    * paired samples (i.e., a single set of differences) or \n    * a one-sample comparison against a specified value\n\n* However, this test _does_ make use of information concerning the size\n of the differences.\n \n<hr>\n \n __Hypotheses__\n\n$H_0:$ the population is __symmetric around some value__ $\\tilde{\\mu}_0$  \n$H_a:$ the population is __not symmetric around some value__ $\\tilde{\\mu}_0$\n\n* Even if the population has a mean/median equal to $\\tilde{\\mu}_0$, the\n test may reject the null if the population isn't symmetric, thus only use if the data (differences) are symmetric. \n* If the population is symmetric \n    * then the mean and median coincide, \n    * thus often the null hypothesis is phrased in terms of the median difference being 0\n \n\n\n\n## Example: calculate signed ranks\n\n* Rank the absolute values of the differences from smallest to largest\n* For ties, take the average of the highest and lowest tied ranks\n    * I.e. if ranks 3-7 are tied, then assign (3+7)/2 = 5 as the rank\n* Then calculate the signed ranks as +/- the rank depending on whether the sign is +/-\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_ranks <- IOP %>% \n  mutate(\n    Rank = c(1.5, 4.5, 1.5, 4.5, NA, 3, 6),\n    Signed_rank = case_when(\n      d < 0 ~ -Rank,\n      d > 0 ~ Rank\n      )\n    )\nIOP_ranks %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bemljvenyp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bemljvenyp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bemljvenyp thead, #bemljvenyp tbody, #bemljvenyp tfoot, #bemljvenyp tr, #bemljvenyp td, #bemljvenyp th {\n  border-style: none;\n}\n\n#bemljvenyp p {\n  margin: 0;\n  padding: 0;\n}\n\n#bemljvenyp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bemljvenyp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bemljvenyp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bemljvenyp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bemljvenyp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bemljvenyp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bemljvenyp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bemljvenyp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bemljvenyp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bemljvenyp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bemljvenyp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bemljvenyp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bemljvenyp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bemljvenyp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bemljvenyp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bemljvenyp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bemljvenyp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bemljvenyp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bemljvenyp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bemljvenyp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bemljvenyp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bemljvenyp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bemljvenyp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bemljvenyp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bemljvenyp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bemljvenyp .gt_left {\n  text-align: left;\n}\n\n#bemljvenyp .gt_center {\n  text-align: center;\n}\n\n#bemljvenyp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bemljvenyp .gt_font_normal {\n  font-weight: normal;\n}\n\n#bemljvenyp .gt_font_bold {\n  font-weight: bold;\n}\n\n#bemljvenyp .gt_font_italic {\n  font-style: italic;\n}\n\n#bemljvenyp .gt_super {\n  font-size: 65%;\n}\n\n#bemljvenyp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bemljvenyp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bemljvenyp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bemljvenyp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bemljvenyp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bemljvenyp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bemljvenyp .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bemljvenyp .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bemljvenyp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n### New: Calculate ranks using R's `rank()` function\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* However, it includes a difference of 0 in the ranking, and thus below I first remove the row with $d=0$ from the data.\n* In the output below, I called this column `Rank_R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_Ranks_R <- IOP_ranks %>% \n  filter(d != 0) %>% \n  mutate(\n    # create column with absolute values of differences\n    # it's the absolute values that get ranked\n    abs_d = abs(d), \n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(abs_d, ties.method = \"average\"),\n    Signed_Rank_R = case_when(\n      d < 0 ~ -Rank_R,\n      d > 0 ~ Rank_R\n      )\n    ) \n\nIOP_Ranks_R %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"tkbxfhllxo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tkbxfhllxo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tkbxfhllxo thead, #tkbxfhllxo tbody, #tkbxfhllxo tfoot, #tkbxfhllxo tr, #tkbxfhllxo td, #tkbxfhllxo th {\n  border-style: none;\n}\n\n#tkbxfhllxo p {\n  margin: 0;\n  padding: 0;\n}\n\n#tkbxfhllxo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tkbxfhllxo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tkbxfhllxo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tkbxfhllxo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tkbxfhllxo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tkbxfhllxo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tkbxfhllxo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tkbxfhllxo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tkbxfhllxo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tkbxfhllxo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tkbxfhllxo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tkbxfhllxo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tkbxfhllxo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tkbxfhllxo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tkbxfhllxo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tkbxfhllxo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tkbxfhllxo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tkbxfhllxo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tkbxfhllxo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tkbxfhllxo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tkbxfhllxo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tkbxfhllxo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tkbxfhllxo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tkbxfhllxo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tkbxfhllxo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tkbxfhllxo .gt_left {\n  text-align: left;\n}\n\n#tkbxfhllxo .gt_center {\n  text-align: center;\n}\n\n#tkbxfhllxo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tkbxfhllxo .gt_font_normal {\n  font-weight: normal;\n}\n\n#tkbxfhllxo .gt_font_bold {\n  font-weight: bold;\n}\n\n#tkbxfhllxo .gt_font_italic {\n  font-style: italic;\n}\n\n#tkbxfhllxo .gt_super {\n  font-size: 65%;\n}\n\n#tkbxfhllxo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tkbxfhllxo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tkbxfhllxo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tkbxfhllxo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tkbxfhllxo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tkbxfhllxo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tkbxfhllxo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tkbxfhllxo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tkbxfhllxo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"abs_d\">abs_d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank_R\">Rank_R</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_Rank_R\">Signed_Rank_R</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"abs_d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_Rank_R\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n## Test statistic (Wilcoxon) Signed-rank test\n\n__If the null is true:__\n\n* The population is symmetric around some point ( $\\tilde{\\mu}_0 = 0$ ,\n  typically), and \n\n* The __overall size of the positive ranks should be about the same\n  as the overall size of negative ranks__.\n\nNote: \n\n* The sum of the ranks $1,2,\\dotsc, n$ is always $n(n+1)/2$,\n* which can be broken down as the \n    * sum of the positive ranks ( $T^+$ )\n    * plus the sum of the negative ranks ( $T^-$ )\n\nThus, any of the following can be used as a test statistic and will lead to the same conclusion:\n     \n* $T^+$\n* $T^-$\n* $T^+$ - $T^-$\n* $\\min(T^+,T^−) = T_0$\n\n\n\n## Example: calculate sums of signed ranks\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIOP_ranks %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bianjgxfce\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bianjgxfce table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bianjgxfce thead, #bianjgxfce tbody, #bianjgxfce tfoot, #bianjgxfce tr, #bianjgxfce td, #bianjgxfce th {\n  border-style: none;\n}\n\n#bianjgxfce p {\n  margin: 0;\n  padding: 0;\n}\n\n#bianjgxfce .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bianjgxfce .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bianjgxfce .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bianjgxfce .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bianjgxfce .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bianjgxfce .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bianjgxfce .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bianjgxfce .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bianjgxfce .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bianjgxfce .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bianjgxfce .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bianjgxfce .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bianjgxfce .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bianjgxfce .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bianjgxfce .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bianjgxfce .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bianjgxfce .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bianjgxfce .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bianjgxfce .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bianjgxfce .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bianjgxfce .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bianjgxfce .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bianjgxfce .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bianjgxfce .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bianjgxfce .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bianjgxfce .gt_left {\n  text-align: left;\n}\n\n#bianjgxfce .gt_center {\n  text-align: center;\n}\n\n#bianjgxfce .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bianjgxfce .gt_font_normal {\n  font-weight: normal;\n}\n\n#bianjgxfce .gt_font_bold {\n  font-weight: bold;\n}\n\n#bianjgxfce .gt_font_italic {\n  font-style: italic;\n}\n\n#bianjgxfce .gt_super {\n  font-size: 65%;\n}\n\n#bianjgxfce .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bianjgxfce .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bianjgxfce .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bianjgxfce .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bianjgxfce .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bianjgxfce .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bianjgxfce .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bianjgxfce .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bianjgxfce div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Patient\">Patient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Adren\">Adren</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Synth\">Synth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d\">d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed_rank\">Signed_rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.2</td>\n<td headers=\"d\" class=\"gt_row gt_right\">-0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">-</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">-1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">1.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.9</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.8</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Patient\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Adren\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Synth\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"d\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\"Signed_rank\" class=\"gt_row gt_right\">6.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n* Sum of the positive ranks \n    * $T^+$ = 1.5 + 3 + 4.5 + 4.5 + 6 = 19.5\n\n* Sum of the negative ranks\n    * $T^-$ = -1.5\n\n* The sum of the ranks $1,2,\\dotsc, n$ is always $n(n+1)/2$:\n    * $n(n+1)/2 = 6(7)/2 = 21$\n    * $T^+ + |T^-| = 19.5 + |-1.5| = 21$\n\n\n\n## Exact p-value (Wilcoxon) Signed-rank test (fyi) (1/2)\n\n* __Exact p-value__ is preferable\n    * This is the default method in R's `wilcox.test()`\n        * if the samples contain less than 50 finite values \n        * and __there are no ties__\n          * _R will automatically use normal approximation method if there are ties_\n\n* _We will not be calculating the exact p-value \"by hand.\" We will be using R for this._\n\n<hr>\n\n<br>\n\n$$p-value = 2 * P(\\min(T^+,T^−) \\leq t)$$\n\n* $t$ is the smaller of the calculated sums of the positive and negative ranks\n* To calculate the exact p-value, we need the probability of each possible sum of ranks.\n\n### Exact p-value (Wilcoxon) Signed-rank test (fyi) (2/2)\n\n\n* To calculate the exact p-value, we need the probability of each possible sum of ranks:\n    * list all possible combinations of positive and negative ranks for the sample size,\n    * calculate the sum of the positive ranks ( $T^+$ ) for each possible combination (or $T^-$ ), and\n    * then figure out the probability of each possible $T^+$ (assuming all combinations are equally likely)\n\nExample when $n=3$ : (from https://online.stat.psu.edu/stat415/lesson/20/20.2)\n\n<center><../img_slides src=\"../img_slides/ExactW_n3.gif\" width=\"50%\">\n<../img_slides src=\"../img_slides/ExactW_n3_prob.png\" width=\"40%\">\n</center>    \n\nSee https://online.stat.psu.edu/stat415/lesson/20/20.2 for more details.\n\n\n\n## Normal approximation p-value (Wilcoxon) Signed-rank test (fyi)\n\n* __Normal approximation__ method:\n    * If the number of non-zero differences is at least 16, then a normal approximation can be used.\n    * Have the option to apply a continuity correct (default) or not \n* _We will not be calculating the p-value \"by hand.\" We will be using R for this._\n\n<hr>\n\nTest statistic:\n\n$$Z_{T_{min}} = \\frac{T_{min} - \\frac{n(n+1)}{4}}{\\sqrt{\\frac{n(n+1)(2n+1)}{24}}}$$\n\n* $T_{min} = \\min(T^+,T^−)$\n* $n$ = sample size\n* Test statistic $Z_{T_{min}}$ follows a standard normal distribution $N(0,1)$\n* Use normal distribution to calculate p-value\n\n\nSee https://online.stat.psu.edu/stat415/lesson/20/20.2 for more details.\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with exact p-value & specifying columns for paired data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exact p-value\nwilcox.test(x = IOP$Synth, y = IOP$Adren, paired = TRUE, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$Synth, y = IOP$Adren, paired = TRUE, :\ncannot compute exact p-value with ties\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$Synth, y = IOP$Adren, paired = TRUE, :\ncannot compute exact p-value with zeroes\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$Synth and IOP$Adren\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with exact p-value & running one sample test with differences\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exact p-value\nwilcox.test(x = IOP$d, \n\t\talternative = c(\"two.sided\"), mu = 0, \n\t\texact = TRUE, correct = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$d, alternative = c(\"two.sided\"), :\ncannot compute exact p-value with ties\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(x = IOP$d, alternative = c(\"two.sided\"), :\ncannot compute exact p-value with zeroes\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$d\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location is not equal to 0\n```\n:::\n:::\n\n\n\n\n## (Wilcoxon) Signed-rank test in R: Glaucoma example\n\n\"Attempt\" with approximate p-value & specifying columns for paired data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Normal approximation with continuity correction\nwilcox.test(x = IOP$Synth, y = IOP$Adren, paired = TRUE, \n\t\talternative = c(\"two.sided\"), mu = 0, \n\t\texact = FALSE, correct = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  IOP$Synth and IOP$Adren\nV = 19.5, p-value = 0.07314\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\nNo more warnings!! However,... should we be using the normal approximation here?\n\n\n\n## Conclusion\n\nRecall the hypotheses to the (Wilcoxon) Signed-rank test:\n\n$H_0:$ the population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is __symmetric around__ $\\tilde{\\mu}_0 =0$  \n$H_a:$ the population difference in reduction of intraocular pressure in treatment with adrenaline vs. new synthetic drug is __not symmetric around__ $\\tilde{\\mu}_0 =0$\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.07314\n\n\n__Conclusion__:\n\nThere is insufficient evidence the differences in reduction in intraocular pressure differs between the synthetic drug and adrenaline are symmetric about 0 (2-sided Wilcoxon signed rank test $p$-value = 0.07314)\n\nHowever,... \n\n\n\n\n# Wilcoxon rank-sum test\n\nFor two independent samples  \na.k.a Mann-Whitney U test\n\n\n## Wilcoxon rank-sum test\n\n* The nonparametric alternative to the two-sample $t$-test\n    * used to analyze two samples selected from separate (independent)\npopulations\n* Also called the Mann-Whitney U test.\n* Unlike the signed-rank test, there is no need to assume symmetry\n\n* Necessary __condition__ is that the two populations being compared \n    * have the same shape (both right skewed, both left skewed, or both symmetric), \n    * so any noted difference is due to a shift in the median\n\n* Since they have the same shape, when summarizing the test, we can describe the results in terms of a difference in medians.  \n\n\n__Hypotheses__:\n\n$H_0:$ the two populations have the same median  \n$H_a:$ the two populations do NOT have the same median\n\n\n\n## Example\n\nDr. Priya Chaudhary (OHSU) examined the evoked membrane current of dental sensory neurons (in rats) under control conditions and a mixture of capsaicin plus capsazepine (CPZ). [J. Dental Research} 80:1518--23, 2001.](https://journals.sagepub.com/doi/10.1177/00220345010800060801)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata <- tibble(\n  control = c(3024, 2164, 864, 780, 125, 110),\n  cap_CPZ = c(426, 232, 130, 94, 75, 55)\n  ) \n\nCPZdata %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ecobbnjdxk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ecobbnjdxk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ecobbnjdxk thead, #ecobbnjdxk tbody, #ecobbnjdxk tfoot, #ecobbnjdxk tr, #ecobbnjdxk td, #ecobbnjdxk th {\n  border-style: none;\n}\n\n#ecobbnjdxk p {\n  margin: 0;\n  padding: 0;\n}\n\n#ecobbnjdxk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ecobbnjdxk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ecobbnjdxk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ecobbnjdxk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ecobbnjdxk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ecobbnjdxk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ecobbnjdxk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ecobbnjdxk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ecobbnjdxk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ecobbnjdxk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ecobbnjdxk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ecobbnjdxk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ecobbnjdxk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ecobbnjdxk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ecobbnjdxk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ecobbnjdxk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ecobbnjdxk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ecobbnjdxk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ecobbnjdxk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ecobbnjdxk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ecobbnjdxk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ecobbnjdxk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ecobbnjdxk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ecobbnjdxk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ecobbnjdxk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ecobbnjdxk .gt_left {\n  text-align: left;\n}\n\n#ecobbnjdxk .gt_center {\n  text-align: center;\n}\n\n#ecobbnjdxk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ecobbnjdxk .gt_font_normal {\n  font-weight: normal;\n}\n\n#ecobbnjdxk .gt_font_bold {\n  font-weight: bold;\n}\n\n#ecobbnjdxk .gt_font_italic {\n  font-style: italic;\n}\n\n#ecobbnjdxk .gt_super {\n  font-size: 65%;\n}\n\n#ecobbnjdxk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ecobbnjdxk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ecobbnjdxk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ecobbnjdxk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ecobbnjdxk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ecobbnjdxk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ecobbnjdxk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ecobbnjdxk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ecobbnjdxk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"control\">control</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cap_CPZ\">cap_CPZ</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">426</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">232</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">864</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">130</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">780</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">94</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">125</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">75</td></tr>\n    <tr><td headers=\"control\" class=\"gt_row gt_right\">110</td>\n<td headers=\"cap_CPZ\" class=\"gt_row gt_right\">55</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\nCPZdata %>% get_summary_stats(type = \"median\") %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"qahcavcumy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qahcavcumy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qahcavcumy thead, #qahcavcumy tbody, #qahcavcumy tfoot, #qahcavcumy tr, #qahcavcumy td, #qahcavcumy th {\n  border-style: none;\n}\n\n#qahcavcumy p {\n  margin: 0;\n  padding: 0;\n}\n\n#qahcavcumy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qahcavcumy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qahcavcumy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qahcavcumy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qahcavcumy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qahcavcumy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qahcavcumy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qahcavcumy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qahcavcumy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qahcavcumy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qahcavcumy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qahcavcumy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qahcavcumy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qahcavcumy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qahcavcumy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qahcavcumy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qahcavcumy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qahcavcumy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qahcavcumy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qahcavcumy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qahcavcumy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qahcavcumy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qahcavcumy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qahcavcumy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qahcavcumy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qahcavcumy .gt_left {\n  text-align: left;\n}\n\n#qahcavcumy .gt_center {\n  text-align: center;\n}\n\n#qahcavcumy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qahcavcumy .gt_font_normal {\n  font-weight: normal;\n}\n\n#qahcavcumy .gt_font_bold {\n  font-weight: bold;\n}\n\n#qahcavcumy .gt_font_italic {\n  font-style: italic;\n}\n\n#qahcavcumy .gt_super {\n  font-size: 65%;\n}\n\n#qahcavcumy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qahcavcumy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qahcavcumy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qahcavcumy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qahcavcumy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qahcavcumy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qahcavcumy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qahcavcumy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qahcavcumy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_center\">control</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"median\" class=\"gt_row gt_right\">822</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_center\">cap_CPZ</td>\n<td headers=\"n\" class=\"gt_row gt_right\">6</td>\n<td headers=\"median\" class=\"gt_row gt_right\">112</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n## Visualize the data\n\n__Do the independent samples have the same distribution?__\n\nControl group\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-20-1.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-20-2.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = control)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-20-3.png){width=384}\n:::\n:::\n\n\nCap + CPZ group\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-21-1.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-21-2.png){width=384}\n:::\n\n```{.r .cell-code}\nggplot(CPZdata, aes(x = cap_CPZ)) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-21-3.png){width=384}\n:::\n:::\n\n\n\n\n## Calculating ranks and test statistic $W$\n\n1. Combine the two samples together (keep track of which observations came from each sample).\n\n2. Rank the full set of $N=n_1 + n_2$ observations. \n    * If ties exist, assign average ranks to the tied values (as with the signed-rank test).\n\n3. Sum the ranks corresponding to those observations from the smaller\nsample. \n    * This is a time-saving step; you could also have used the larger sample.\n    * Call this sum $W$.\n\n4. If $n_1, n_2$ are both less than 10, then use an exact test (can only be done if no ties are present)\n    * otherwise use the  large-sample normal approximation.\n\nIn our example, both groups have equal n; choose either for computing W.\n\n$$W_{CPZ}=1+2+3+6+7+8 = 27$$\n\n$$W_{control}=4+5+9+10+11+12 = 51$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata %>% \n  pivot_longer(cols = c(control,cap_CPZ), \n               names_to = \"Group\",\n               values_to = \"Current\") %>% \n  arrange(Current) %>% \n  mutate(Rank = 1:12)\n\nCPZdata_long %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"gqpiqsdirj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gqpiqsdirj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gqpiqsdirj thead, #gqpiqsdirj tbody, #gqpiqsdirj tfoot, #gqpiqsdirj tr, #gqpiqsdirj td, #gqpiqsdirj th {\n  border-style: none;\n}\n\n#gqpiqsdirj p {\n  margin: 0;\n  padding: 0;\n}\n\n#gqpiqsdirj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gqpiqsdirj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gqpiqsdirj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gqpiqsdirj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gqpiqsdirj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gqpiqsdirj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gqpiqsdirj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gqpiqsdirj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gqpiqsdirj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gqpiqsdirj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gqpiqsdirj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gqpiqsdirj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gqpiqsdirj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gqpiqsdirj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gqpiqsdirj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gqpiqsdirj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gqpiqsdirj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gqpiqsdirj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gqpiqsdirj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gqpiqsdirj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gqpiqsdirj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gqpiqsdirj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gqpiqsdirj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gqpiqsdirj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gqpiqsdirj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gqpiqsdirj .gt_left {\n  text-align: left;\n}\n\n#gqpiqsdirj .gt_center {\n  text-align: center;\n}\n\n#gqpiqsdirj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gqpiqsdirj .gt_font_normal {\n  font-weight: normal;\n}\n\n#gqpiqsdirj .gt_font_bold {\n  font-weight: bold;\n}\n\n#gqpiqsdirj .gt_font_italic {\n  font-style: italic;\n}\n\n#gqpiqsdirj .gt_super {\n  font-size: 65%;\n}\n\n#gqpiqsdirj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gqpiqsdirj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gqpiqsdirj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gqpiqsdirj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gqpiqsdirj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gqpiqsdirj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gqpiqsdirj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gqpiqsdirj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gqpiqsdirj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Current\">Current</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">55</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">75</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">94</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">110</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">125</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">130</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">232</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">426</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">780</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">864</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">12</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n### New: calculate ranks's using `rank()`\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* In the output below, I called this column `Rank_R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata_long %>% \n  mutate(\n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(Current, ties.method = \"average\")\n    ) \n\nCPZdata_long %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"esimwhoosf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#esimwhoosf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#esimwhoosf thead, #esimwhoosf tbody, #esimwhoosf tfoot, #esimwhoosf tr, #esimwhoosf td, #esimwhoosf th {\n  border-style: none;\n}\n\n#esimwhoosf p {\n  margin: 0;\n  padding: 0;\n}\n\n#esimwhoosf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#esimwhoosf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#esimwhoosf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#esimwhoosf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#esimwhoosf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#esimwhoosf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#esimwhoosf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#esimwhoosf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#esimwhoosf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#esimwhoosf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#esimwhoosf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#esimwhoosf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#esimwhoosf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#esimwhoosf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#esimwhoosf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#esimwhoosf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#esimwhoosf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#esimwhoosf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#esimwhoosf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#esimwhoosf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#esimwhoosf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#esimwhoosf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#esimwhoosf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#esimwhoosf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#esimwhoosf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#esimwhoosf .gt_left {\n  text-align: left;\n}\n\n#esimwhoosf .gt_center {\n  text-align: center;\n}\n\n#esimwhoosf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#esimwhoosf .gt_font_normal {\n  font-weight: normal;\n}\n\n#esimwhoosf .gt_font_bold {\n  font-weight: bold;\n}\n\n#esimwhoosf .gt_font_italic {\n  font-style: italic;\n}\n\n#esimwhoosf .gt_super {\n  font-size: 65%;\n}\n\n#esimwhoosf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#esimwhoosf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#esimwhoosf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#esimwhoosf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#esimwhoosf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#esimwhoosf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#esimwhoosf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#esimwhoosf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#esimwhoosf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Group\">Group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Current\">Current</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank_R\">Rank_R</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">55</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">75</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">94</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">110</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">125</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">130</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">232</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">cap_CPZ</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">426</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">780</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">864</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">2164</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">11</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"Group\" class=\"gt_row gt_left\">control</td>\n<td headers=\"Current\" class=\"gt_row gt_right\">3024</td>\n<td headers=\"Rank\" class=\"gt_row gt_right\">12</td>\n<td headers=\"Rank_R\" class=\"gt_row gt_right\">12</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n \n \n## Exact p-value approach\n\n* __If $n_1, n_2$ are both less than 10, then use an exact test__, \n    * otherwise use the large-sample normal approximation.\n    * However, exact method can only be done if __no ties__ are present\n\n* p-value is the probability of getting a rank sum $W$ as extreme or more extreme than the observed one.\n    * Multiply the 1-tail probability by 2 for the 2-tailed probability\n\n$$p-value = 2 \\cdot P(W_{CPZ} \\leq 27)$$\n\n* To calculate $P(W_{CPZ} \\leq 27)$, \n    * we need to enumerate all possible sets ranks for the sample size,  \n    * calculate the sum of ranks for each set of possible ranks,\n    * and then the probability for each sum (assuming each set of ranks is equally likely).\n\n<hr>\n\n* _We will not be calculating the p-value \"by hand.\" We will be using R for this._\n\n\n\n## Normal approximation approach\n\nIf the null hypothesis is true, then the mean of the sum of the ranks from the smaller-sized group will be\n\n$$\\mu_W = \\dfrac{n_s \\cdot (n_s + n_l + 1)}{2},$$\nwith a standard deviation of\n\n$$\\sigma_W = \\sqrt{ \\dfrac{n_s\\cdot n_l \\cdot (n_s + n_l + 1)}{12} }.$$\nProvided both groups are large ( $\\geq 10$ ),\n\n$$Z = \\frac{W - \\mu_W}{\\sigma_W}  \\approx Normal(0,1)$$\n\n\n\n### Example:\n\nWe have $W=27$ and $n_l = n_s = 6$:\n\n$$\\mu_W = \\dfrac{6 \\cdot (6 + 6 +1 )}{2} = 39 \\\\\n\\sigma_W  = \\sqrt{\\dfrac{6\\cdot 6 \\cdot (6+6+1)}{12}} = \\sqrt{39} \\approx 6.2450 \\\\\nz \\approx \\frac{27-39}{6.2450} = -1.921538$$\n\n\nThe two-sided $p$-value is \n$$p=2 \\cdot P(Z < -1.921538)=0.05466394$$ \n\n    \n\n::: {.cell}\n\n```{.r .cell-code}\n2 * pnorm((27-39) / sqrt(39))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05466394\n```\n:::\n:::\n\n\n\n\n## Wilcoxon rank-sum test in R: with wide data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(CPZdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 6\nColumns: 2\n$ control <dbl> 3024, 2164, 864, 780, 125, 110\n$ cap_CPZ <dbl> 426, 232, 130, 94, 75, 55\n```\n:::\n:::\n\n\n\nExact p-value\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n            alternative = c(\"two.sided\"), mu = 0, \n            exact = TRUE) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  CPZdata$cap_CPZ and CPZdata$control\nW = 6, p-value = 0.06494\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n\n## Wilcoxon rank-sum test in R: with wide data\n\nNormal approximation p-value without CC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = FALSE, correct = FALSE) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"llsrvyrxpd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#llsrvyrxpd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#llsrvyrxpd thead, #llsrvyrxpd tbody, #llsrvyrxpd tfoot, #llsrvyrxpd tr, #llsrvyrxpd td, #llsrvyrxpd th {\n  border-style: none;\n}\n\n#llsrvyrxpd p {\n  margin: 0;\n  padding: 0;\n}\n\n#llsrvyrxpd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#llsrvyrxpd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#llsrvyrxpd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#llsrvyrxpd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#llsrvyrxpd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#llsrvyrxpd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#llsrvyrxpd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#llsrvyrxpd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#llsrvyrxpd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#llsrvyrxpd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#llsrvyrxpd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#llsrvyrxpd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#llsrvyrxpd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#llsrvyrxpd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#llsrvyrxpd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#llsrvyrxpd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#llsrvyrxpd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#llsrvyrxpd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#llsrvyrxpd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#llsrvyrxpd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#llsrvyrxpd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#llsrvyrxpd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#llsrvyrxpd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#llsrvyrxpd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#llsrvyrxpd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#llsrvyrxpd .gt_left {\n  text-align: left;\n}\n\n#llsrvyrxpd .gt_center {\n  text-align: center;\n}\n\n#llsrvyrxpd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#llsrvyrxpd .gt_font_normal {\n  font-weight: normal;\n}\n\n#llsrvyrxpd .gt_font_bold {\n  font-weight: bold;\n}\n\n#llsrvyrxpd .gt_font_italic {\n  font-style: italic;\n}\n\n#llsrvyrxpd .gt_super {\n  font-size: 65%;\n}\n\n#llsrvyrxpd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#llsrvyrxpd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#llsrvyrxpd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#llsrvyrxpd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#llsrvyrxpd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#llsrvyrxpd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#llsrvyrxpd .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#llsrvyrxpd .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#llsrvyrxpd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.05466394</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nNormal approximation p-value with CC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x = CPZdata$cap_CPZ, y = CPZdata$control, \n\talternative = c(\"two.sided\"), mu = 0, \n\texact = FALSE, correct = TRUE) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ikozreuadd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ikozreuadd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ikozreuadd thead, #ikozreuadd tbody, #ikozreuadd tfoot, #ikozreuadd tr, #ikozreuadd td, #ikozreuadd th {\n  border-style: none;\n}\n\n#ikozreuadd p {\n  margin: 0;\n  padding: 0;\n}\n\n#ikozreuadd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ikozreuadd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ikozreuadd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ikozreuadd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ikozreuadd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ikozreuadd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ikozreuadd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ikozreuadd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ikozreuadd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ikozreuadd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ikozreuadd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ikozreuadd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ikozreuadd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ikozreuadd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ikozreuadd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ikozreuadd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ikozreuadd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ikozreuadd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ikozreuadd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ikozreuadd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ikozreuadd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ikozreuadd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ikozreuadd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ikozreuadd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ikozreuadd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ikozreuadd .gt_left {\n  text-align: left;\n}\n\n#ikozreuadd .gt_center {\n  text-align: center;\n}\n\n#ikozreuadd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ikozreuadd .gt_font_normal {\n  font-weight: normal;\n}\n\n#ikozreuadd .gt_font_bold {\n  font-weight: bold;\n}\n\n#ikozreuadd .gt_font_italic {\n  font-style: italic;\n}\n\n#ikozreuadd .gt_super {\n  font-size: 65%;\n}\n\n#ikozreuadd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ikozreuadd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ikozreuadd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ikozreuadd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ikozreuadd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ikozreuadd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ikozreuadd .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ikozreuadd .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ikozreuadd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.06555216</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum test with continuity correction</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n## Wilcoxon rank-sum test in R: with long data\n\nMake data long (if it's not already long):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCPZdata_long <- CPZdata %>% \n  pivot_longer(cols = c(control,cap_CPZ), \n               names_to = \"Group\",\n               values_to = \"Current\")\n\nhead(CPZdata_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  Group   Current\n  <chr>     <dbl>\n1 control    3024\n2 cap_CPZ     426\n3 control    2164\n4 cap_CPZ     232\n5 control     864\n6 cap_CPZ     130\n```\n:::\n:::\n\n\n\n\n\nExact p-value\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(Current ~ Group, \n            data = CPZdata_long, \n            alternative = c(\"two.sided\"), \n            mu = 0, \n            exact = TRUE) %>% \n  tidy() %>% gt() \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ambbdzzrhe\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ambbdzzrhe table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ambbdzzrhe thead, #ambbdzzrhe tbody, #ambbdzzrhe tfoot, #ambbdzzrhe tr, #ambbdzzrhe td, #ambbdzzrhe th {\n  border-style: none;\n}\n\n#ambbdzzrhe p {\n  margin: 0;\n  padding: 0;\n}\n\n#ambbdzzrhe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ambbdzzrhe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ambbdzzrhe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ambbdzzrhe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ambbdzzrhe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ambbdzzrhe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ambbdzzrhe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ambbdzzrhe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ambbdzzrhe .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ambbdzzrhe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ambbdzzrhe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ambbdzzrhe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ambbdzzrhe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ambbdzzrhe .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ambbdzzrhe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ambbdzzrhe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ambbdzzrhe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ambbdzzrhe .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ambbdzzrhe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ambbdzzrhe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ambbdzzrhe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ambbdzzrhe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ambbdzzrhe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ambbdzzrhe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ambbdzzrhe .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ambbdzzrhe .gt_left {\n  text-align: left;\n}\n\n#ambbdzzrhe .gt_center {\n  text-align: center;\n}\n\n#ambbdzzrhe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ambbdzzrhe .gt_font_normal {\n  font-weight: normal;\n}\n\n#ambbdzzrhe .gt_font_bold {\n  font-weight: bold;\n}\n\n#ambbdzzrhe .gt_font_italic {\n  font-style: italic;\n}\n\n#ambbdzzrhe .gt_super {\n  font-size: 65%;\n}\n\n#ambbdzzrhe .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ambbdzzrhe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ambbdzzrhe .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ambbdzzrhe .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ambbdzzrhe .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ambbdzzrhe .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ambbdzzrhe .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ambbdzzrhe .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ambbdzzrhe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.06493506</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Wilcoxon rank sum exact test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n\n\n\n\n## Conclusion\n\n\n\nRecall the hypotheses to the (Wilcoxon) Signed-rank test:\n\n$H_0:$ the control and treated populations have the same median  \n$H_a:$ the control and treated populations do NOT have the same median\n\n* Significance level: $\\alpha$ = 0.05\n* p-value = 0.06494\n\n\n__Conclusion__:\n\nThere is suggestive but inconclusive evidence that the evoked membrane current of dental sensory neurons (in rats) differs between the control group and the group exposed to a mixture of capsaicin plus capsazepine (2-sided Wilcoxon rank-sum test $p$-value = 0.06494).\n\n\n\n# Kruskal-Wallis test\n\nNonparametric ANOVA test\n\n\n## Kruskal-Wallis test: nonparametric ANOVA test\n\n* Recall that an ANOVA tests means from more than 2 groups\n* Conditions for ANOVA include\n    * Sample sizes in each group group are large (each $n \\ge 30$),  \n        * OR the data are relatively normally distributed in each group\n    * Variability is \"similar\" in all group groups\n\n* If these conditions are in doubt, or if the response is ordinal, then the Kruskal-Wallis test is an alternative.\n\n\\begin{align}\nH_0 &: \\text{pop median}_1 = \\text{pop median}_2 = ... = \\text{pop median}_k\\\\\n\\text{vs. } H_A&: \\text{At least one pair } \\text{pop median}_i \\neq \\text{pop median}_j \\text{ for } i \\neq j\n\\end{align}\n\n* K-W test is an extension of the (Wilcoxon) rank-sum test to more than 2 groups\n    * With $k=2$ groups, the K-W test is the same as the rank-sum test\n\n\n\n## K-W test statistic: $H$ (fyi)\n\n$$H = \\frac{12}{{N(N + 1)}} \\sum_{i=1}^{k} \\frac{R_i^2}{n_i} - 3(N + 1)$$\n\n* $k$ is the number of groups,\n* $n_i$ is the number of observations in group  $i$\n* $N = n_1 + \\ldots + n_k$ is the total number of observations across all groups,\n* $R_i$ is the sum of ranks for group $i$\n\nThe test statistic $H$ has a Chi-squared distribution with $k-1$ degrees of freedom:\n\n$$H \\sim \\chi^2_{k-1}$$\n\nRanks are calculated similarly to the (Wilcoxon) rank-sum test.\n\n\n\n## Ranks for the K-W test\n\n1. Combine the $k$ samples together (keep track of which observations came from each sample).\n2. Rank the full set of $N = n_1 + \\ldots + n_k$ observations. \n    * If ties exist, assign average ranks to the tied values (as with the signed-rank test).\n3. Then sum the ranks within each of the $k$ groups\n    * Label the sums of the ranks for each group as $R_1, \\ldots + R_k$.\n\nIf $H_0$ is true, we expect the populations to have the same medians, and thus the ranks to be similar as well.\n\n\n\n## Example: Ozone levels by month \n\n* `airquality` data included in base R - no need to load it\n* Daily air quality measurements in New York, May to September 1973.\n* Question: do ozone levels differ by month?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 153\nColumns: 6\n$ Ozone   <int> 41, 36, 12, 18, NA, 28, 23, 19, 8, NA, 7, 16, 11, 14, 18, 14, …\n$ Solar.R <int> 190, 118, 149, 313, NA, NA, 299, 99, 19, 194, NA, 256, 290, 27…\n$ Wind    <dbl> 7.4, 8.0, 12.6, 11.5, 14.3, 14.9, 8.6, 13.8, 20.1, 8.6, 6.9, 9…\n$ Temp    <int> 67, 72, 74, 62, 56, 66, 65, 59, 61, 69, 74, 69, 66, 68, 58, 64…\n$ Month   <int> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,…\n$ Day     <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nOz_mnth <- airquality %>% \n  group_by(Month) %>% \n  get_summary_stats(Ozone, \n    show = c(\"n\", \"mean\", \"median\", \"sd\"))\nOz_mnth %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"tevdgamvcs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tevdgamvcs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tevdgamvcs thead, #tevdgamvcs tbody, #tevdgamvcs tfoot, #tevdgamvcs tr, #tevdgamvcs td, #tevdgamvcs th {\n  border-style: none;\n}\n\n#tevdgamvcs p {\n  margin: 0;\n  padding: 0;\n}\n\n#tevdgamvcs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tevdgamvcs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tevdgamvcs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tevdgamvcs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tevdgamvcs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tevdgamvcs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tevdgamvcs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tevdgamvcs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tevdgamvcs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tevdgamvcs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tevdgamvcs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tevdgamvcs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tevdgamvcs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tevdgamvcs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tevdgamvcs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tevdgamvcs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tevdgamvcs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tevdgamvcs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tevdgamvcs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tevdgamvcs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tevdgamvcs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tevdgamvcs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tevdgamvcs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tevdgamvcs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tevdgamvcs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tevdgamvcs .gt_left {\n  text-align: left;\n}\n\n#tevdgamvcs .gt_center {\n  text-align: center;\n}\n\n#tevdgamvcs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tevdgamvcs .gt_font_normal {\n  font-weight: normal;\n}\n\n#tevdgamvcs .gt_font_bold {\n  font-weight: bold;\n}\n\n#tevdgamvcs .gt_font_italic {\n  font-style: italic;\n}\n\n#tevdgamvcs .gt_super {\n  font-size: 65%;\n}\n\n#tevdgamvcs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tevdgamvcs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tevdgamvcs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tevdgamvcs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tevdgamvcs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tevdgamvcs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tevdgamvcs .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tevdgamvcs .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tevdgamvcs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Month\">Month</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">5</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">23.615</td>\n<td headers=\"median\" class=\"gt_row gt_right\">18</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">22.224</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">6</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">9</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">29.444</td>\n<td headers=\"median\" class=\"gt_row gt_right\">23</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">18.208</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">7</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">59.115</td>\n<td headers=\"median\" class=\"gt_row gt_right\">60</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">31.636</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">8</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">59.962</td>\n<td headers=\"median\" class=\"gt_row gt_right\">52</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">39.681</td></tr>\n    <tr><td headers=\"Month\" class=\"gt_row gt_right\">9</td>\n<td headers=\"variable\" class=\"gt_row gt_center\">Ozone</td>\n<td headers=\"n\" class=\"gt_row gt_right\">29</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">31.448</td>\n<td headers=\"median\" class=\"gt_row gt_right\">23</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">24.142</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\nmax(Oz_mnth$sd) / min(Oz_mnth$sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.179317\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(airquality,\n       aes(x = Ozone, y = factor(Month))) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](19_Non_parametric_files/figure-revealjs/unnamed-chunk-33-1.png){width=384}\n:::\n:::\n\n\n\n\n## Example: calculate ranks (fyi) \n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth <- airquality %>% \n  select(Ozone, Month) \n\nsummary(ranks_Oz_mnth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Ozone            Month      \n Min.   :  1.00   Min.   :5.000  \n 1st Qu.: 18.00   1st Qu.:6.000  \n Median : 31.50   Median :7.000  \n Mean   : 42.13   Mean   :6.993  \n 3rd Qu.: 63.25   3rd Qu.:8.000  \n Max.   :168.00   Max.   :9.000  \n NA's   :37                      \n```\n:::\n\n```{.r .cell-code}\nranks_Oz_mnth <- ranks_Oz_mnth %>% \n  drop_na(Ozone) %>% \n  arrange(Ozone) %>% \n  mutate(Rank = 1:nrow(.))\n```\n:::\n\n\nRanks below do not take into account ties!!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ranks_Oz_mnth, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Ozone Month Rank\n1      1     5    1\n2      4     5    2\n3      6     5    3\n4      7     5    4\n5      7     7    5\n6      7     9    6\n7      8     5    7\n8      9     8    8\n9      9     8    9\n10     9     9   10\n11    10     7   11\n12    11     5   12\n13    11     5   13\n14    11     5   14\n15    12     5   15\n16    12     6   16\n17    13     6   17\n18    13     9   18\n19    13     9   19\n20    13     9   20\n```\n:::\n:::\n\n\n\nSum of ranks for each group: (not taking into account ties!!)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth %>% \n  group_by(Month) %>% \n  summarise(sumRank = sum(Rank))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  Month sumRank\n  <int>   <int>\n1     5     939\n2     6     434\n3     7    2023\n4     8    1956\n5     9    1434\n```\n:::\n:::\n\n\n\n\n### New: calculate ranks's using `rank()`\n\n* Below I create the ranks using R's `rank()` function that has an option `ties.method` to specify how to calculate ties. \n* This doesn't require first sorting the data. \n* In the output below, I called this column `Rank_R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranks_Oz_mnth <- ranks_Oz_mnth %>% \n  mutate(\n    # create column with ranks that accounts for ties using R's rank() function\n    # you don't need to first sort the data to use this command\n    Rank_R = rank(Ozone, ties.method = \"average\")\n    ) \n\n# Compare \"simple\" ranks not including ties with tie-corrected ranks\nhead(ranks_Oz_mnth, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Ozone Month Rank Rank_R\n1      1     5    1    1.0\n2      4     5    2    2.0\n3      6     5    3    3.0\n4      7     5    4    5.0\n5      7     7    5    5.0\n6      7     9    6    5.0\n7      8     5    7    7.0\n8      9     8    8    9.0\n9      9     8    9    9.0\n10     9     9   10    9.0\n11    10     7   11   11.0\n12    11     5   12   13.0\n13    11     5   13   13.0\n14    11     5   14   13.0\n15    12     5   15   15.5\n16    12     6   16   15.5\n17    13     6   17   18.5\n18    13     9   18   18.5\n19    13     9   19   18.5\n20    13     9   20   18.5\n```\n:::\n:::\n\n\n\n## K-W test in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(Ozone ~ Month, data = airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Ozone by Month\nKruskal-Wallis chi-squared = 29.267, df = 4, p-value = 6.901e-06\n```\n:::\n\n```{.r .cell-code}\nkruskal.test(Ozone ~ Month, data = airquality) %>% tidy() %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"zxyyvricfb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zxyyvricfb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zxyyvricfb thead, #zxyyvricfb tbody, #zxyyvricfb tfoot, #zxyyvricfb tr, #zxyyvricfb td, #zxyyvricfb th {\n  border-style: none;\n}\n\n#zxyyvricfb p {\n  margin: 0;\n  padding: 0;\n}\n\n#zxyyvricfb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zxyyvricfb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zxyyvricfb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zxyyvricfb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zxyyvricfb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zxyyvricfb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zxyyvricfb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zxyyvricfb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zxyyvricfb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zxyyvricfb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zxyyvricfb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zxyyvricfb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zxyyvricfb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zxyyvricfb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zxyyvricfb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zxyyvricfb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zxyyvricfb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zxyyvricfb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zxyyvricfb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zxyyvricfb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zxyyvricfb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zxyyvricfb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zxyyvricfb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zxyyvricfb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zxyyvricfb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zxyyvricfb .gt_left {\n  text-align: left;\n}\n\n#zxyyvricfb .gt_center {\n  text-align: center;\n}\n\n#zxyyvricfb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zxyyvricfb .gt_font_normal {\n  font-weight: normal;\n}\n\n#zxyyvricfb .gt_font_bold {\n  font-weight: bold;\n}\n\n#zxyyvricfb .gt_font_italic {\n  font-style: italic;\n}\n\n#zxyyvricfb .gt_super {\n  font-size: 65%;\n}\n\n#zxyyvricfb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zxyyvricfb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zxyyvricfb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zxyyvricfb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zxyyvricfb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zxyyvricfb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zxyyvricfb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zxyyvricfb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zxyyvricfb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"statistic\" class=\"gt_row gt_right\">29.26658</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">6.900714e-06</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">4</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Kruskal-Wallis rank sum test</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThere is sufficient evidence that the median ozone levels are different in at least two months from May - September, 1973 in New York City (p < 0.001; Kruskal-Wallis test).\n\n\n* (fyi) Since the K-W test is significant, follow-up with pairwise (Wilcoxon) rank-sum tests using a multiple comparison procedure to identify which months have different medians.\n\n\n# Learning Objectives\n\n1.  Recognize the motivation for and focus of our course (categorical responses)\n\n2.  Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation\n\n3.  Determine if a single proportion differs from a population value\n\n4.  Determine if two proportions differ from each other\n\n5.  Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables\n\n6.  Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test\n\n::: lob\n7.  Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test\n:::\n\n8.  Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test\n\n9.  Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test\n\n# Fischer's Exact Test\n\nUse this if expected cell counts are too small\n\n\n## Example with smaller sample size \n\n* Suppose that instead of taking a random sample of 400 adults (from the NHANES data), a study takes a random sample of 100 such that\n    * 50 people that are physically active and \n    * 50 people that are not physically active \n\n\n::: {.cell}\n\n```{.r .cell-code}\n(DepPA100_table <- matrix(c(43, 5, 2, 40, 4, 6), nrow = 2, ncol = 3, byrow = T))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]   43    5    2\n[2,]   40    4    6\n```\n:::\n\n```{.r .cell-code}\ndimnames(DepPA100_table) <- list(\"PA\" = c(\"Yes\", \"No\"),   # row names\n                              \"Depression\" = c(\"None\", \"Several\", \"Most\"))  # column names\n\nDepPA100_table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Depression\nPA    None Several Most\n  Yes   43       5    2\n  No    40       4    6\n```\n:::\n:::\n\n\n\n## Chi-squared test warning \n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(DepPA100_table) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in stats::chisq.test(x, y, ...): Chi-squared approximation may be\nincorrect\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  DepPA100_table\nX-squared = 2.2195, df = 2, p-value = 0.3296\n```\n:::\n\n```{.r .cell-code}\nchisq.test(DepPA100_table)$expected\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in stats::chisq.test(x, y, ...): Chi-squared approximation may be\nincorrect\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n     Depression\nPA    None Several Most\n  Yes 41.5     4.5    4\n  No  41.5     4.5    4\n```\n:::\n:::\n\n\n* Recall the __sample size__ condition\n    * In order for the test statistic to be modeled by a chi-squared distribution we need\n    * __[ 2 $\\times$ 2 table:]{style=\"color:darkorange\"} expected counts are at least 10 for each cell__\n    * __[larger tables:   ]{style=\"color:darkorange\"}__\n        * __no more than 1/5 of the expected counts are less than 5__, and \n        * __all expected counts are greater than 1__\n\n\n## Fisher's Exact Test\n\n* Called an exact test since it \n    * calculates an exact probability for the p-value \n        * instead of using an asymptotic approximation, such as the normal, t, or chi-squared distributions\n    * For 2x2 tables the p-value is calculated using the __hypergeometric__ probability distribution (see book for details)  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher.test(DepPA100_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  DepPA100_table\np-value = 0.3844\nalternative hypothesis: two.sided\n```\n:::\n:::\n\n\n::: {.callout-caution icon=false} \n## Comments\n\n* Note that there is no test statistic\n* There is also no CI\n* This is always a two-sided test\n* There is no continuity correction since the hypergeometric distribution is discrete\n:::\n\n\n\n## __Simulate p-values__: another option for small expected counts\n\nFrom the `chisq.test` help file: \n\n* Simulation is done by random sampling from the set of all contingency tables with the same margin totals\n    * works only if the margin totals are strictly positive. \n* For each simulation, a $\\chi^2$ test statistic is calculated\n* _P_-value is the proportion of simulations that have a test statistic at least as big as the observed one.\n* No continuity correction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(567)\nchisq.test(DepPA100_table, simulate.p.value = TRUE) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test with simulated p-value (based on 2000\n\treplicates)\n\ndata:  DepPA100_table\nX-squared = 2.2195, df = NA, p-value = 0.3893\n```\n:::\n:::\n\n\n\n## Fisher's Exact Test\n\n-   Only necessary when expected counts in one or more cells is less than 5\n-   Given row and column totals fixed, computes exact probability that we observe our data or more extreme data\n-   Consider a general 2 x 2 table:\n\n![](./images/fisher_tab.png){fig-align=\"center\"}\n\n-   The exact probability of observing a table with cells (a, b, c, d) can be computed based on the hypergeometric distribution\n\n$$P(a, b, c, d) = \\dfrac{(a+b)!\\cdot(c+d)!\\cdot(a+c)!\\cdot(b+d)!}{n!\\cdot a!\\cdot b!\\cdot c!\\cdot d!}$$\n\n-   Numerator is fixed and denominator changes\n\n## Fisher's Exact test: Process\n\n1.  Check the [**expected cell counts**]{style=\"color:#70AD47\"}\n\n2.  Set the [**level of significance**]{style=\"color:#70AD47\"} $\\alpha$\n\n3.  Specify the [**null**]{style=\"color:#70AD47\"} ( $H_0$ ) and [**alternative**]{style=\"color:#70AD47\"} ( $H_A$ ) [**hypotheses**]{style=\"color:#70AD47\"}\n\n    -   In symbols\n    -   In words\n    -   Alternative: one- or two-sided?\n\n4.  Calculate the [**test statistic**]{style=\"color:#70AD47\"} and [**p-value**]{style=\"color:#70AD47\"} for Fisher Exact test in R\n\n    -   We will not discuss the test statistic's equation\n\n5.  Write a [**conclusion**]{style=\"color:#70AD47\"} to the hypothesis test\n\n    -   Do we reject or fail to reject $H_0$?\n    -   Write a conclusion in the context of the problem\n\n## Fisher's Exact test: SHS Example (not appropriate use of Fisher's Exact)\n\n::: columns\n::: column\n1.  Check expected cell counts threshold\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#expected(SHS_table)\n```\n:::\n\n\nWe're going to pretend they are less than 5.\n\n2.  $\\alpha = 0.05$\n\n3.  Hypothesis test:\n\n    -   $H_0$ : There is no association between glucose tolerance and diabetes\n    -   $H_1$ : There is an association between glucose tolerance and diabetes\n:::\n\n::: column\n4.  Calculate the test statistic and p-value for Chi-squared test in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#fisher.test(x = SHS_table)\n```\n:::\n\n\n5.  Conclusion to the hypothesis test\n\nWe reject the null hypothesis that glucose tolerance and diabetes are not associated ($p<2.2\\cdot10^{-16}$). There is sufficient evidence that glucose tolerance and diabetes incidence are associated among American Indians.\n:::\n:::\n\n# Permutation tests & bootstrapping\n\nanother option to consider\n\n\n\n## Permutation tests & bootstrapping\n\n* In some cases we saw that the conditions failed or the sample size was too small for a normal approximation and there were ties in ranks preventing us from using an exact method.\n\n* Another nonparametric option to consider is a permutation test or bootstrapping.\n\n* If you're interested in learning more about this approach, check out the [ModernDive Statistical Inference via Data Science](https://moderndive.com/index.html) book by Chester Ismay and Albert Kim.\n    * Ch 7: [Sampling](https://moderndive.com/7-sampling.html)\n    * Ch 8: [Bootstrapping and Confidence Intervals](https://moderndive.com/8-confidence-intervals.html)\n    * Ch 9: [Hypothesis Testing](https://moderndive.com/9-hypothesis-testing.html)\n\n\n\n\n\n\n\n  \n",
    "supporting": [
      "19_Non_parametric_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}