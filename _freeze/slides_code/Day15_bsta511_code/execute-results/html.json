{
  "hash": "c7947bcd8f6355afd6f17b1b2e9ef65b",
  "result": {
    "markdown": "---\ntitle: \"Day 15: Simple Linear Regression (part 1) (Sections 6.1-6.2)\"\nsubtitle: \"BSTA 511/611\"\nauthor: \"Meike Niederhausen, PhD\"\ninstitute: \"OHSU-PSU School of Public Health\"\ndate: \"11/22/2023\"\ncategories: [\"Week 9\"]\nformat: \n  html:\n    link-external-newwindow: true\n    toc: true\n    source: repo\n    html-math-method: mathjax\nexecute:\n  echo: true\n  freeze: auto  # re-render only when source changes\n# editor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n## Load packages\n\n* Packages need to be loaded _every time_ you restart R or render an Qmd file\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run these every time you open Rstudio\nlibrary(tidyverse)    \nlibrary(oibiostat)\nlibrary(janitor)\nlibrary(rstatix)\nlibrary(knitr)\nlibrary(gtsummary)\nlibrary(moderndive)\nlibrary(gt)\nlibrary(broom) \nlibrary(here) \nlibrary(pwr) \n```\n:::\n\n\n\n- You can check whether a package has been loaded or not \n  - by looking at the Packages tab and \n  - seeing whether it has been checked off or not\n\n# Goals for Day 15: Simple Linear Regression (Sections 6.1-6.2)\n\n\n* Associations between two variables\n    * Correlation review\n* Simple linear regression: regression with one numerical explanatory variable\n* How do we\n    * calculate slope & intercept?\n    * interpret slope & intercept?\n    * Next time:\n        * do inference for slope & intercept? (CI, p-value)\n        * do prediction with regression line?\n* Regression in R\n* Residuals\n* (Population) regression model\n* LINE conditions\n    * Does the model fit the data well?\n        * Should we be using a line to model the data?\n* Should we add additional variables to the model? Take BSTA 512 to answer that (multiple regression)\n\n\n---\n\n# Life expectancy vs. female adult literacy rate\n\n<https://www.gapminder.org/tools/#$model$markers$bubble$encoding$x$data$concept=literacy_rate_adult_female_percent_of_females_ages_15_above&source=sg&space@=country&=time;;&scale$domain:null&zoomed:null&type:null;;&frame$value=2011;;;;;&chart-type=bubbles&url=v1>\n\n\n\n## Dataset description \n\n* Data file: `lifeexp_femlit_water_2011.csv`\n* Data were downloaded from <https://www.gapminder.org/data/>\n* 2011 is the most recent year with the most complete data\n* __Life expectancy__ = the average number of years a newborn child would live if current mortality patterns were to stay the same. Source: <https://www.gapminder.org/data/documentation/gd004/>\n\n* __Adult literacy rate__ is the percentage of people ages 15 and above who can, with understanding, read and write a short, simple statement on their everyday life. Source: <http://data.uis.unesco.org/>\n\n* __At least basic water source (%)__ = the percentage of people using at least basic water services. This indicator encompasses both people using basic water services as well as those using safely managed water services. Basic drinking water services is defined as drinking water from an improved source, provided collection time is not more than 30 minutes for a round trip. Improved water sources include piped water, boreholes or tubewells, protect dug wells, protected springs, and packaged or delivered water.\n\n\n## Get to know the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapm <- read_csv(here::here(\"data\", \"lifeexp_femlit_water_2011.csv\"))\n\nglimpse(gapm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 194\nColumns: 5\n$ country                    <chr> \"Afghanistan\", \"Albania\", \"Algeria\", \"Andor…\n$ life_expectancy_years_2011 <dbl> 56.7, 76.7, 76.7, 82.6, 60.9, 76.9, 76.0, 7…\n$ female_literacy_rate_2011  <dbl> 13.0, 95.7, NA, NA, 58.6, 99.4, 97.9, 99.5,…\n$ water_basic_source_2011    <dbl> 52.6, 88.1, 92.6, 100.0, 40.3, 97.0, 99.5, …\n$ water_2011_quart           <chr> \"Q1\", \"Q2\", \"Q2\", \"Q4\", \"Q1\", \"Q3\", \"Q4\", \"…\n```\n:::\n\n```{.r .cell-code}\nsummary(gapm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   country          life_expectancy_years_2011 female_literacy_rate_2011\n Length:194         Min.   :47.50              Min.   :13.00            \n Class :character   1st Qu.:64.30              1st Qu.:70.97            \n Mode  :character   Median :72.70              Median :91.60            \n                    Mean   :70.66              Mean   :81.65            \n                    3rd Qu.:76.90              3rd Qu.:98.03            \n                    Max.   :82.90              Max.   :99.80            \n                    NA's   :7                  NA's   :114              \n water_basic_source_2011 water_2011_quart  \n Min.   : 18.30          Length:194        \n 1st Qu.: 74.90          Class :character  \n Median : 93.50          Mode  :character  \n Mean   : 84.84                            \n 3rd Qu.: 99.08                            \n Max.   :100.00                            \n                                           \n```\n:::\n:::\n\n\n## Association between life expectancy and female literacy rate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(gapm, \n       aes(x = female_literacy_rate_2011,\n           y = life_expectancy_years_2011)) +\n  geom_point() +\n  labs(x = \"female literacy rate\", \n       y = \"life expectancy\",\n       title = \"Life expectancy vs. \n             female literacy rate in 2011\") +  \n  geom_smooth(method = \"lm\", \n              se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Day15_bsta511_code_files/figure-html/unnamed-chunk-4-1.png){width=480}\n:::\n:::\n\n\n\n* Is there a relationship between the two variables? \n* Is it positive or negative? \n* Strong, moderate, or weak? \n* Is it linear?\n\n\n## Dependent vs. independent variables\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Day15_bsta511_code_files/figure-html/unnamed-chunk-5-1.png){width=480}\n:::\n:::\n\n\n\n* $y$ = dependent variable (DV)\n    * also called the outcome or response variable\n* $x$ = independent variable (IV)\n    * also called the predictor variable\n    * or regressor in a regression analysis\n\n* How to determine which is which?\n\n\n## Correlation between life expectancy and female literacy rate\n\n* The base R function for calculating the correlation coefficient is `cor()`. \n* This can be used within summarize.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapm %>% \n  summarize(correlation = cor(life_expectancy_years_2011, \n                              female_literacy_rate_2011,\n                              use =  \"complete.obs\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  correlation\n        <dbl>\n1       0.641\n```\n:::\n\n```{.r .cell-code}\n# base R:\ncor(gapm$life_expectancy_years_2011, \n    gapm$female_literacy_rate_2011,\n    use =  \"complete.obs\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6410434\n```\n:::\n:::\n\n\n\n## (Pearson) Correlation coefficient (r)\n\n\n* A _bivariate_ summary statistic since calculated using two variables\n* __-1__ indicates a __perfect negative linear relationship__: As one variable increases, the value of the other variable tends to go down, following a *straight line*.\n* __0__ indicates __no linear relationship__: The values of both variables go up/down independently of each other.\n* __1__ indicates a__ perfect positive linear relationship__: As the value of one variable goes up, the value of the other variable tends to go up as well in a linear fashion.\n\n\n$$r = \\frac{1}{n-1}\\sum_{i=1}^{n}\\Big(\\frac{x_i - \\bar{x}}{s_x}\\Big)\\Big(\\frac{y_i - \\bar{y}}{s_y}\\Big)$$\n\n## Regression line = best-fit line\n\n$$\\widehat{y} = b_0 + b_1 \\cdot x $$\n\n* $\\hat{y}$ is the predicted outcome for a specific value of $x$.\n* $b_0$ is the intercept\n* $b_1$ is the slope of the line, i.e., the increase in $\\hat{y}$ for every increase of one (unit increase) in $x$.\n    - slope = *rise over run*\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Day15_bsta511_code_files/figure-html/unnamed-chunk-7-1.png){width=384}\n:::\n:::\n\n]\n\n__Interpreting coefficients__\n\n* __Intercept__\n    - The expected outcome for the $y$-variable when the $x$-variable is 0.\n* __Slope__\n    - For every increase of 1 unit in the $x$-variable, there is an expected increase of, on average, $b_1$ units in the $y$-variable.\n    - We only say that there is an expected increase and not necessarily a causal increase.\n\n\n\n## Correlation coefficient vs. slope\n\n* Not the same!!!\n* Directly related though:\n\n\n$$b_1 = r\\frac{s_y}{s_x}$$\n\nwhere $s_x$ and $s_y$ are the standard deviations of the $x$ and $y$ variables.\n\nThe correlation coefficient can be computed using the formula below. \n\n$$r = \\frac{1}{n-1}\\sum_{i=1}^{n}\\Big(\\frac{x_i - \\bar{x}}{s_x}\\Big)\\Big(\\frac{y_i - \\bar{y}}{s_y}\\Big)$$\n\n\nWe will be using R to do these calculations.\n\n\n\n# How is the best-fit line calculated? (1/3)  \n\n<https://www.rossmanchance.com/applets/2021/regshuffle/regshuffle.htm>\n\n## How is the best-fit line calculated? (2/3)\n\n* __Observed values__ $y_i$ are the values in the dataset\n\n* __Fitted values__ $\\widehat{y}_i$ are the values that fall on the best-fit line for a specific $x_i$\n\n* __Residuals__ $e_i = y_i - \\widehat{y}_i$ are the differences between the two.\n\n\nThe best-line is minimizing \"how far\" the residuals are from the best-fit line \n* However, if we add all the residuals we get 0. ( $\\sum_{i=1}^n e_i = 0$ )\n* Thus instead, we add the squares of the residuals, which is always positive, and minimize the sums of the squares ( $\\sum_{i=1}^n e_i^2 \\geq 0$ )\n    - which is why the best-fit line is often called the __least-squares line__\n* This is the same as minimizing the combined area of all the \"residual squares\" we were looking at in the applet.\n\n\n## Regression model with residuals\n\n\n* __Observed values__ $y_i$ \n  * the values in the dataset\n* __Fitted values__ $\\widehat{y}_i$ \n  * the values that fall on the best-fit line for a specific $x_i$\n* __Residuals__ $e_i = y_i - \\widehat{y}_i$ \n  * the differences between the observed and fitted values\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code from https://drsimonj.svbtle.com/visualising-residuals\n\nmodel1 <- lm(life_expectancy_years_2011 ~ female_literacy_rate_2011,\n                 data = gapm)\nregression_points <- augment(model1)\n\nggplot(regression_points, \n       aes(x = female_literacy_rate_2011,\n                 y = life_expectancy_years_2011)) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"lightgrey\") +\n  geom_segment(aes(\n    xend = female_literacy_rate_2011, \n    yend = .fitted), \n    alpha = .2) +\n  # > Color adjustments made here...\n  geom_point(aes(color = .resid), size = 4) +  # Color mapped here\n  scale_color_gradient2(low = \"blue\", mid = \"white\", high = \"red\") +  # Colors to use here\n  guides(color = \"none\") +\n  geom_point(aes(y = .fitted), shape = 1, size = 3) +\n  labs(x = \"Female literacy rate\", \n       y = \"Average life expectancy\",\n       title = \"Regression line with residuals\") +\n  theme_bw() + \n  theme(text = element_text(size = 20))    \n```\n\n::: {.cell-output-display}\n![](Day15_bsta511_code_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n\n\n## How is the best-fit line calculated? (3/3)\n\nIn math-speak, we need to find the values $b_0$ and $b_1$ that minimize the equation:\n\n$$\\sum_{i=1}^n e_i^2 = \n\\sum_{i=1}^n (y_i - \\hat{y_i})^2 = \n\\sum_{i=1}^n (y_i - b_0 -b_1 x_i)^2$$\n\nwhere \n\n* $y_i$ are the values in the dataset \n* with $n$ datapoints and \n* $\\widehat{y_i}$ are the fitted values that fall on the best-fit line for a specific value $x_i$.\n\nHow do we find the minimum values of an equation??? \n\nIf you want to see the mathematical details, check out pages 222-223 (pdf pages 10-11) of <https://www.stat.cmu.edu/~hseltman/309/Book/chapter9.pdf>.\n\n$$b_0 = \\bar{y} - b_1\\bar{x}, \\ \\ \\ \\ \\ \\ \\ \\ \\ \nb_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} = r\\frac{s_y}{s_x}$$\n\n\n# Regression in R\n\n* We will use R to run a simple linear regression using the command `lm()`.\n* The regression output gives us the coefficients (intercept and slope) for the regression line (along with other statistics that we will cover later in the course).\n\n##`summary()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(life_expectancy_years_2011 ~ female_literacy_rate_2011,\n                 data = gapm)\n\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, \n    data = gapm)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-22.299  -2.670   1.145   4.114   9.498 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)               50.92790    2.66041  19.143  < 2e-16 ***\nfemale_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.142 on 78 degrees of freedom\n  (114 observations deleted due to missingness)\nMultiple R-squared:  0.4109,\tAdjusted R-squared:  0.4034 \nF-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10\n```\n:::\n:::\n\n\n* Above we first \"fit\" the linear regression model to the data using the `lm()` function and save this as `model1`. \n    - By \"fit\", we mean \"find the best fitting line to this data\", which we will discuss later. \n    - `lm()` stands for \"linear model\" and is used as follows: `lm(y ~ x, data = data_name)` where:\n        - `y` is the outcome variable, followed by a tilde `~`. Above, `y` is set to `life_expectancy_years_2011`.\n        - `x` is the explanatory variable. Above, `x` is set to `female_literacy_rate_2011`.\n\n\n## `tidy()` model\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(model1) %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"lxwqzumilo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lxwqzumilo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lxwqzumilo thead, #lxwqzumilo tbody, #lxwqzumilo tfoot, #lxwqzumilo tr, #lxwqzumilo td, #lxwqzumilo th {\n  border-style: none;\n}\n\n#lxwqzumilo p {\n  margin: 0;\n  padding: 0;\n}\n\n#lxwqzumilo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lxwqzumilo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lxwqzumilo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lxwqzumilo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lxwqzumilo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lxwqzumilo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lxwqzumilo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lxwqzumilo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lxwqzumilo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lxwqzumilo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lxwqzumilo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lxwqzumilo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lxwqzumilo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lxwqzumilo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lxwqzumilo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lxwqzumilo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lxwqzumilo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lxwqzumilo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lxwqzumilo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lxwqzumilo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lxwqzumilo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lxwqzumilo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lxwqzumilo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lxwqzumilo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lxwqzumilo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lxwqzumilo .gt_left {\n  text-align: left;\n}\n\n#lxwqzumilo .gt_center {\n  text-align: center;\n}\n\n#lxwqzumilo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lxwqzumilo .gt_font_normal {\n  font-weight: normal;\n}\n\n#lxwqzumilo .gt_font_bold {\n  font-weight: bold;\n}\n\n#lxwqzumilo .gt_font_italic {\n  font-style: italic;\n}\n\n#lxwqzumilo .gt_super {\n  font-size: 65%;\n}\n\n#lxwqzumilo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lxwqzumilo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lxwqzumilo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lxwqzumilo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lxwqzumilo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lxwqzumilo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lxwqzumilo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">50.9278981</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">2.66040695</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">19.142898</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.325312e-31</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">female_literacy_rate_2011</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.2321951</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.03147744</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">7.376557</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.501286e-10</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n## Regression equation\n\nThe values in the `estimate` column are the intercept and slope of the regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(model1) %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mixiivakqu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mixiivakqu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mixiivakqu thead, #mixiivakqu tbody, #mixiivakqu tfoot, #mixiivakqu tr, #mixiivakqu td, #mixiivakqu th {\n  border-style: none;\n}\n\n#mixiivakqu p {\n  margin: 0;\n  padding: 0;\n}\n\n#mixiivakqu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mixiivakqu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mixiivakqu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mixiivakqu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mixiivakqu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mixiivakqu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mixiivakqu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mixiivakqu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mixiivakqu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mixiivakqu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mixiivakqu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mixiivakqu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mixiivakqu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mixiivakqu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mixiivakqu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mixiivakqu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mixiivakqu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mixiivakqu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mixiivakqu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mixiivakqu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mixiivakqu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mixiivakqu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mixiivakqu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mixiivakqu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mixiivakqu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mixiivakqu .gt_left {\n  text-align: left;\n}\n\n#mixiivakqu .gt_center {\n  text-align: center;\n}\n\n#mixiivakqu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mixiivakqu .gt_font_normal {\n  font-weight: normal;\n}\n\n#mixiivakqu .gt_font_bold {\n  font-weight: bold;\n}\n\n#mixiivakqu .gt_font_italic {\n  font-style: italic;\n}\n\n#mixiivakqu .gt_super {\n  font-size: 65%;\n}\n\n#mixiivakqu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mixiivakqu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mixiivakqu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mixiivakqu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mixiivakqu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mixiivakqu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mixiivakqu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">50.9278981</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">2.66040695</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">19.142898</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.325312e-31</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">female_literacy_rate_2011</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.2321951</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.03147744</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">7.376557</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.501286e-10</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nGeneric regression equation:\n\n$$\\widehat{y} = b_0 + b_1 \\cdot x $$\n\nRegression equation for our model:\n\n$$\\widehat{\\textrm{life expectancy}} = 50.9 + 0.232 \\cdot \\textrm{female literacy rate} $$\n\n\n## Interpretation of coefficients\n\n$$\\widehat{\\textrm{life expectancy}} = 50.9 + 0.232 \\cdot \\textrm{female literacy rate} $$\n\n__Interpretation of the intercept for this example. Is it meaningful?__ \n\n* The average life expectancy in 2011 for countries with no literate female adults was on average 50.9 years.\n\n\n__Interpretation of the slope for this example.__ \n\n* For every 1 point increase in a country’s female literacy rate, we expect an average 0.232 year increase in the country’s average life expectancy.\n\n\n\n# The (Population) Regression Model\n\n\n## The regresison model\n\n* The (population) regression model is denoted by\n\n$$y = \\beta_0 + \\beta_1 \\cdot x + \\epsilon$$\n\n* $\\beta_0$ and $\\beta_1$ are unknown population parameters\n* $\\epsilon$ (epsilon) is the error about the line\n    * It is assumed to be a random variable with a \n        * normal distribution with\n        * mean 0 and\n        * constant variance $\\sigma^2$\n\n* The __line__ is the average (expected) value of $Y$ given a value of $x$: $E(Y|x)$.\n\n* The point estimates based on a sample are denoted by $b_0, b_1, s_{residuals}^2$\n    * Note: also common notation is $\\widehat{\\beta}_0, \\widehat{\\beta}_1, \\widehat{\\sigma}^2$\n\n\n---\n\n## The regresison model visually\n\n$$y = \\beta_0 + \\beta_1 \\cdot x + \\epsilon, \\text{ where } \\epsilon \\sim N(0, \\sigma^2)$$\n\nSee slides for figure. \n\n\n# What are the LINE conditions?\n\nFor \"good\" model fit and to be able to make inferences and predictions based on our models, 4 conditions need to be satisfied.  \n\nBriefly: \n\n* __L__inearity of relationship between variables\n* __I__ndependence of the Y values\n* __N__ormality of the residuals\n* __E__quality of variance of the residuals (homoscedasticity)\n\n[More in depth](https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions):\n\n* __L__ : there is a linear relationship between the mean response (Y) and the explanatory variable (X),\n* __I__ : the errors are independent—there’s no connection between how far any two points lie from the regression line,\n* __N__ : the responses are normally distributed at each level of X, and\n* __E__ : the variance or, equivalently, the standard deviation of the responses is equal for all levels of X.\n\n<!-- Note that the __residuals__ play a key role! -->\n\n\n\n## L: Linearity of relationship between variables\n\nIs the association between the variables linear?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(gapm, aes(x = female_literacy_rate_2011,\n                 y = life_expectancy_years_2011)) +\n  geom_point() +\n  labs(x = \"female literacy rate\", \n       y = \"life expectancy\",\n       title = \"Life expectancy vs. female literacy rate in 2011\") +  \n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_smooth(se = FALSE, color = \"black\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing non-finite values (`stat_smooth()`).\nRemoved 114 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 114 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Day15_bsta511_code_files/figure-html/unnamed-chunk-12-1.png){width=480}\n:::\n:::\n\n\n\n\n## I: Independence of the residuals\n\n* __Are the data points independent of each other?__\n\n* Examples of when they are *not* independent, include\n    * repeated measures (such as baseline, 3 months, 6 months)\n    * data from clusters, such as different hospitals or families\n\n* This condition is checked by reviewing the study *design* and not by inspecting the data\n\n* How to analyze data using regression models when the $Y$-values are not independent is covered in BSTA 519 (Longitudinal data) \n\n\n## N: Normality of the residuals\n\n* The responses Y are normally distributed at each level of x\n* Next time we will go over how to assess this\n\nSee slides for figure.\n\n\n\n## E: Equality of variance of the residuals\n\n* The __variance__ or, equivalently, the standard deviation of the responses is __equal for all values of x__.\n* This is called __homoskedasticity__ (top row)\n* If there is __heteroskedasticity__ (bottom row), then the assumption is not met.\n\n_See slides for figure._\n\nWe will discuss how to assess this next time.\n\n\n",
    "supporting": [
      "Day15_bsta511_code_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}