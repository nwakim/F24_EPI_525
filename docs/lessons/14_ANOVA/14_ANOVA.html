<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Meike Niederhausen and Nicky Wakim">
<meta name="dcterms.date" content="2024-09-25">

<title>Biostatistics 1 - Day 14: Comparing Means with ANOVA (Section 5.5)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/Bsta513.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Biostatistics 1</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../instructors.html" rel="" target="">
 <span class="menu-text">Instructors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../homework.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#where-are-we" id="toc-where-are-we" class="nav-link active" data-scroll-target="#where-are-we">Where are we?</a></li>
  <li><a href="#where-are-we-continuous-outcome-zoomed-in" id="toc-where-are-we-continuous-outcome-zoomed-in" class="nav-link" data-scroll-target="#where-are-we-continuous-outcome-zoomed-in">Where are we? Continuous outcome zoomed in</a></li>
  <li><a href="#goals-for-today-section-5.5" id="toc-goals-for-today-section-5.5" class="nav-link" data-scroll-target="#goals-for-today-section-5.5">Goals for today (Section 5.5)</a></li>
  <li><a href="#disability-discrimination-example" id="toc-disability-discrimination-example" class="nav-link" data-scroll-target="#disability-discrimination-example">Disability Discrimination Example</a></li>
  <li><a href="#load-interview-data-from-.txt-file" id="toc-load-interview-data-from-.txt-file" class="nav-link" data-scroll-target="#load-interview-data-from-.txt-file">Load interview data from <code>.txt</code> file</a></li>
  <li><a href="#moritzs-tip-of-the-day" id="toc-moritzs-tip-of-the-day" class="nav-link" data-scroll-target="#moritzs-tip-of-the-day">MoRitz’s tip of the day</a></li>
  <li><a href="#factor-variable-make-disability-a-factor-variable" id="toc-factor-variable-make-disability-a-factor-variable" class="nav-link" data-scroll-target="#factor-variable-make-disability-a-factor-variable">Factor variable: Make <code>disability</code> a factor variable</a></li>
  <li><a href="#factor-variable-change-order-name-of-disability-levels" id="toc-factor-variable-change-order-name-of-disability-levels" class="nav-link" data-scroll-target="#factor-variable-change-order-name-of-disability-levels">Factor variable: Change order &amp; name of disability levels</a></li>
  <li><a href="#data-viz-12" id="toc-data-viz-12" class="nav-link" data-scroll-target="#data-viz-12">Data viz (1/2)</a></li>
  <li><a href="#data-viz-22" id="toc-data-viz-22" class="nav-link" data-scroll-target="#data-viz-22">Data viz (2/2)</a></li>
  <li><a href="#hypotheses" id="toc-hypotheses" class="nav-link" data-scroll-target="#hypotheses">Hypotheses</a></li>
  <li><a href="#comparing-means" id="toc-comparing-means" class="nav-link" data-scroll-target="#comparing-means">Comparing means</a></li>
  <li><a href="#anova-in-base-r" id="toc-anova-in-base-r" class="nav-link" data-scroll-target="#anova-in-base-r">ANOVA in base R</a></li>
  <li><a href="#anova-tables" id="toc-anova-tables" class="nav-link" data-scroll-target="#anova-tables">ANOVA tables</a></li>
  <li><a href="#anova-analysis-of-variance" id="toc-anova-analysis-of-variance" class="nav-link" data-scroll-target="#anova-analysis-of-variance">ANOVA: Analysis of Variance</a></li>
  <li><a href="#anova-analysis-of-variance-1" id="toc-anova-analysis-of-variance-1" class="nav-link" data-scroll-target="#anova-analysis-of-variance-1">ANOVA: Analysis of Variance</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation">Notation</a></li>
  <li><a href="#total-sums-of-squares-visually" id="toc-total-sums-of-squares-visually" class="nav-link" data-scroll-target="#total-sums-of-squares-visually">Total Sums of Squares Visually</a></li>
  <li><a href="#calculate-total-sums-of-squares" id="toc-calculate-total-sums-of-squares" class="nav-link" data-scroll-target="#calculate-total-sums-of-squares">Calculate Total Sums of Squares</a></li>
  <li><a href="#anova-analysis-of-variance-2" id="toc-anova-analysis-of-variance-2" class="nav-link" data-scroll-target="#anova-analysis-of-variance-2">ANOVA: Analysis of Variance</a></li>
  <li><a href="#sums-of-squares-due-to-groups-visually-between-groups" id="toc-sums-of-squares-due-to-groups-visually-between-groups" class="nav-link" data-scroll-target="#sums-of-squares-due-to-groups-visually-between-groups">Sums of Squares due to Groups Visually (“between” groups)</a></li>
  <li><a href="#calculate-sums-of-squares-due-to-groups-between-groups" id="toc-calculate-sums-of-squares-due-to-groups-between-groups" class="nav-link" data-scroll-target="#calculate-sums-of-squares-due-to-groups-between-groups">Calculate Sums of Squares due to Groups (“between” groups)</a></li>
  <li><a href="#anova-analysis-of-variance-3" id="toc-anova-analysis-of-variance-3" class="nav-link" data-scroll-target="#anova-analysis-of-variance-3">ANOVA: Analysis of Variance</a></li>
  <li><a href="#sums-of-squares-error-visually-within-groups" id="toc-sums-of-squares-error-visually-within-groups" class="nav-link" data-scroll-target="#sums-of-squares-error-visually-within-groups">Sums of Squares Error Visually (within groups)</a></li>
  <li><a href="#calculate-sums-of-squares-error-within-groups" id="toc-calculate-sums-of-squares-error-within-groups" class="nav-link" data-scroll-target="#calculate-sums-of-squares-error-within-groups">Calculate Sums of Squares Error (within groups)</a></li>
  <li><a href="#verify-sst-ssg-sse" id="toc-verify-sst-ssg-sse" class="nav-link" data-scroll-target="#verify-sst-ssg-sse">Verify <em>SST = SSG + SSE</em></a></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA table</a></li>
  <li><a href="#thinking-about-the-f-statistic" id="toc-thinking-about-the-f-statistic" class="nav-link" data-scroll-target="#thinking-about-the-f-statistic">Thinking about the F-statistic</a></li>
  <li><a href="#anova-in-base-r-1" id="toc-anova-in-base-r-1" class="nav-link" data-scroll-target="#anova-in-base-r-1">ANOVA in base R</a></li>
  <li><a href="#conclusion-to-hypothesis-test" id="toc-conclusion-to-hypothesis-test" class="nav-link" data-scroll-target="#conclusion-to-hypothesis-test">Conclusion to hypothesis test</a></li>
  <li><a href="#conditions-for-anova" id="toc-conditions-for-anova" class="nav-link" data-scroll-target="#conditions-for-anova">Conditions for ANOVA</a></li>
  <li><a href="#testing-variances-condition-3" id="toc-testing-variances-condition-3" class="nav-link" data-scroll-target="#testing-variances-condition-3">Testing variances (Condition 3)</a></li>
  <li><a href="#the-f-distribution" id="toc-the-f-distribution" class="nav-link" data-scroll-target="#the-f-distribution">The F-distribution</a></li>
  <li><a href="#which-groups-are-statistically-different" id="toc-which-groups-are-statistically-different" class="nav-link" data-scroll-target="#which-groups-are-statistically-different">Which groups are statistically different?</a></li>
  <li><a href="#post-hoc-testing-for-anova" id="toc-post-hoc-testing-for-anova" class="nav-link" data-scroll-target="#post-hoc-testing-for-anova">Post-hoc testing for ANOVA</a>
  <ul class="collapse">
  <li><a href="#post-hoc-testing-pairwise-t-tests" id="toc-post-hoc-testing-pairwise-t-tests" class="nav-link" data-scroll-target="#post-hoc-testing-pairwise-t-tests">Post-hoc testing: pairwise t-tests</a></li>
  <li><a href="#the-bonferroni-correction-12" id="toc-the-bonferroni-correction-12" class="nav-link" data-scroll-target="#the-bonferroni-correction-12">The Bonferroni Correction (1/2)</a></li>
  <li><a href="#the-bonferroni-correction-22" id="toc-the-bonferroni-correction-22" class="nav-link" data-scroll-target="#the-bonferroni-correction-22">The Bonferroni Correction (2/2)</a></li>
  <li><a href="#tukeys-honest-significance-test-hsd" id="toc-tukeys-honest-significance-test-hsd" class="nav-link" data-scroll-target="#tukeys-honest-significance-test-hsd">Tukey’s Honest Significance Test (HSD)</a></li>
  <li><a href="#there-are-many-more-multiple-testing-adjustment-procedures" id="toc-there-are-many-more-multiple-testing-adjustment-procedures" class="nav-link" data-scroll-target="#there-are-many-more-multiple-testing-adjustment-procedures">There are many more multiple testing adjustment procedures</a></li>
  </ul></li>
  <li><a href="#multiple-testing" id="toc-multiple-testing" class="nav-link" data-scroll-target="#multiple-testing">Multiple testing</a>
  <ul class="collapse">
  <li><a href="#multiple-testing-controlling-the-type-i-error-rate" id="toc-multiple-testing-controlling-the-type-i-error-rate" class="nav-link" data-scroll-target="#multiple-testing-controlling-the-type-i-error-rate">Multiple testing: controlling the Type I error rate</a></li>
  <li><a href="#anova-summary" id="toc-anova-summary" class="nav-link" data-scroll-target="#anova-summary">ANOVA Summary</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What’s next?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="14_ANOVA.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day 14: Comparing Means with ANOVA (Section 5.5)</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Week 6</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Meike Niederhausen and Nicky Wakim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 25, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="where-are-we" class="level2">
<h2 class="anchored" data-anchor-id="where-are-we">Where are we?</h2>
<p><br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/flowchart_511_continuous_categorical.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="where-are-we-continuous-outcome-zoomed-in" class="level2">
<h2 class="anchored" data-anchor-id="where-are-we-continuous-outcome-zoomed-in">Where are we? Continuous outcome zoomed in</h2>
<p><br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/flowchart_only_continuous.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="goals-for-today-section-5.5" class="level2">
<h2 class="anchored" data-anchor-id="goals-for-today-section-5.5">Goals for today (Section 5.5)</h2>
<ul>
<li><p>Analysis of Variance (ANOVA)</p></li>
<li><p>When to use an ANOVA</p></li>
<li><p>Hypotheses</p></li>
<li><p>ANOVA table</p></li>
<li><p>Different sources of variation in ANOVA</p></li>
<li><p>ANOVA conditions</p></li>
<li><p>F-distribution</p></li>
<li><p>Post-hoc testing of differences in means</p></li>
<li><p>Running an ANOVA in R</p></li>
</ul>
</section>
<section id="disability-discrimination-example" class="level2">
<h2 class="anchored" data-anchor-id="disability-discrimination-example">Disability Discrimination Example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>The U.S. Rehabilitation Act of 1973 prohibited discrimination against people with physical disabilities.
<ul>
<li>The act defined a disabled person as any individual who has a physical or mental impairment that limits the person’s major life activities.</li>
</ul></li>
<li>A 1980’s study examined whether physical disabilities affect people’s perceptions of employment qualifications
<ul>
<li>(<a href="https://psycnet.apa.org/record/1991-07629-001">Cesare, Tannenbaum, &amp; Dalessio, 1990</a>).</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Researchers prepared recorded job interviews, using <em>same actors and script each time</em>.</li>
<li>Only difference: job applicant appeared with different disabilities.
<ul>
<li><em>No disability</em></li>
<li><em>Leg amputation</em></li>
<li><em>Crutches</em></li>
<li><em>Hearing impairment</em></li>
<li><em>Wheelchair confinement</em></li>
</ul></li>
<li>70 undergrad students were randomly assigned to view one of the videotapes,
<ul>
<li>then <strong>rated</strong> the candidate’s qualifications on a <strong>1-10 scale</strong>.</li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li>The research question: <strong>are qualifications evaluated differently depending on the applicant’s presented disability?</strong></li>
</ul>
</section>
<section id="load-interview-data-from-.txt-file" class="level2">
<h2 class="anchored" data-anchor-id="load-interview-data-from-.txt-file">Load interview data from <code>.txt</code> file</h2>
<ul>
<li><code>.txt</code> (text) files are usually tab-deliminated files
<ul>
<li><code>.csv</code> files are comma-separated files</li>
</ul></li>
<li><code>read_delim</code> is from the <code>readr</code> package, just like <code>read_csv</code>, and loads with other <code>tidyverse</code> packages</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>employ <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"DisabilityEmployment.txt"</span>), </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,   <span class="co"># tab delimited</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 70 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (1): disability
dbl (1): score

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p><code>trim_ws</code>: specify whether leading and trailing white space should be trimmed from each field before parsing it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 70
Columns: 2
$ disability &lt;chr&gt; "none", "none", "none", "none", "none", "none", "none", "no…
$ score      &lt;dbl&gt; 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  disability            score      
 Length:70          Min.   :1.400  
 Class :character   1st Qu.:3.700  
 Mode  :character   Median :5.050  
                    Mean   :4.929  
                    3rd Qu.:6.100  
                    Max.   :8.500  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>employ <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(disability)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disability  n percent
    amputee 14     0.2
   crutches 14     0.2
    hearing 14     0.2
       none 14     0.2
 wheelchair 14     0.2</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="moritzs-tip-of-the-day" class="level2">
<h2 class="anchored" data-anchor-id="moritzs-tip-of-the-day">MoRitz’s tip of the day</h2>
<p>Read <a href="https://www.ohsu.edu/sites/default/files/2021-03/OHSU%20Inclusive%20Language%20Guide_031521.pdf">OHSU’s Inclusive Language Guide</a> (below is from pgs. 22-25)</p>
<p>“… an evolving tool to help OHSU members learn about and use inclusive language…”</p>
<p>Sections on: Race and ethnicity, Immigration status, Gender and sexual orientation, and Ability (including physical, mental and chronological attributes)</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="../../img_slides/OHSU_Inclusive_Language_Guide_Ability_header.png" class="img-fluid" data-fig-align="center"> <img src="../../img_slides/OHSU_Inclusive_Language_Guide_Respectful.png" class="img-fluid" data-fig-align="center"> <img src="../../img_slides/OHSU_Inclusive_Language_Guide_Respectful_disability.png" class="img-fluid" data-fig-align="center"></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/OHSU_Inclusive_Language_Guide_Avoid.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="factor-variable-make-disability-a-factor-variable" class="level2">
<h2 class="anchored" data-anchor-id="factor-variable-make-disability-a-factor-variable">Factor variable: Make <code>disability</code> a factor variable</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 70
Columns: 2
$ disability &lt;chr&gt; "none", "none", "none", "none", "none", "none", "none", "no…
$ score      &lt;dbl&gt; 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  disability            score      
 Length:70          Min.   :1.400  
 Class :character   1st Qu.:3.700  
 Mode  :character   Median :5.050  
                    Mean   :4.929  
                    3rd Qu.:6.100  
                    Max.   :8.500  </code></pre>
</div>
</div>
</div>
</div>
<p>Make <code>disability</code> a factor variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>employ <span class="ot">&lt;-</span> employ <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disability =</span> <span class="fu">factor</span>(disability))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>What’s different now?</p>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 70
Columns: 2
$ disability &lt;fct&gt; none, none, none, none, none, none, none, none, none, none,…
$ score      &lt;dbl&gt; 1.9, 2.5, 3.0, 3.6, 4.1, 4.2, 4.9, 5.1, 5.4, 5.9, 6.1, 6.7,…</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      disability     score      
 amputee   :14   Min.   :1.400  
 crutches  :14   1st Qu.:3.700  
 hearing   :14   Median :5.050  
 none      :14   Mean   :4.929  
 wheelchair:14   3rd Qu.:6.100  
                 Max.   :8.500  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="factor-variable-change-order-name-of-disability-levels" class="level2">
<h2 class="anchored" data-anchor-id="factor-variable-change-order-name-of-disability-levels">Factor variable: Change order &amp; name of disability levels</h2>
<p><span style="color:purple">What are the current level names and order?</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(employ<span class="sc">$</span>disability)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "amputee"    "crutches"   "hearing"    "none"       "wheelchair"</code></pre>
</div>
</div>
<p><span style="color:green">What changes are being made below?</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>employ <span class="ot">&lt;-</span> employ <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make "none" the first level</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># by only listing the level none, all other levels will be in original order</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">disability =</span> <span class="fu">fct_relevel</span>(disability, <span class="st">"none"</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change the level name amputee to amputation</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">disability =</span> <span class="fu">fct_recode</span>(disability, <span class="at">amputation =</span> <span class="st">"amputee"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>fct_relevel()</code> and <code>fct_recode()</code> are from the <code>forcats</code> package: <a href="https://forcats.tidyverse.org/index.html" class="uri">https://forcats.tidyverse.org/index.html</a>.</li>
<li><code>forcats</code> is loaded with <code>library(tidyverse)</code>.</li>
</ul>
<p><span style="color:purple">New order &amp; names:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(employ<span class="sc">$</span>disability) <span class="co"># note the new order and new name</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "none"       "amputation" "crutches"   "hearing"    "wheelchair"</code></pre>
</div>
</div>
</section>
<section id="data-viz-12" class="level2">
<h2 class="anchored" data-anchor-id="data-viz-12">Data viz (1/2)</h2>
<ul>
<li>What are the <code>score</code> distribution shapes within each group?</li>
<li>Any unusual values?</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(employ, <span class="fu">aes</span>(<span class="at">x=</span>score)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> disability)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(employ, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>score,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> disability,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> disability)) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.801</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="data-viz-22" class="level2">
<h2 class="anchored" data-anchor-id="data-viz-22">Data viz (2/2)</h2>
<ul>
<li>Compare the <code>score</code> measures of <strong>center</strong> and <strong>spread</strong> between the groups</li>
</ul>
<div class="columns">
<div class="column" style="width:45%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(employ, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y=</span>score, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> disability,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> disability)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(employ, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> disability, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>score, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span>disability, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span>disability)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(score)), </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey33"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="720"></p>
</div>
</div>
</div>
</div>
</section>
<section id="hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="hypotheses">Hypotheses</h2>
<p>To test for a difference in means across <em>k</em> groups:</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \mu_1 = \mu_2 = ... = \mu_k\\
\text{vs. } H_A&amp;: \text{At least one pair } \mu_i \neq \mu_j \text{ for } i \neq j
\end{align}\]</span></p>
<p><strong>Hypothetical examples:</strong><br>
In which set (A or B) do you believe the evidence will be stronger that at least one population differs from the others?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/hypothetical_disability_data_v2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="comparing-means" class="level2">
<h2 class="anchored" data-anchor-id="comparing-means">Comparing means</h2>
<p>Whether or not two means are significantly different depends on:</p>
<ul>
<li>How far apart the <strong>means</strong> are</li>
<li>How much <strong>variability</strong> there is within each group</li>
</ul>
<p><strong><span style="color:green">Questions:</span></strong></p>
<ul>
<li>How to measure variability <strong>between</strong> groups?</li>
<li>How to measure variability <strong>within</strong> groups?</li>
<li>How to compare the two measures of variability?</li>
<li>How to determine significance?</li>
</ul>
</section>
<section id="anova-in-base-r" class="level2">
<h2 class="anchored" data-anchor-id="anova-in-base-r">ANOVA in base R</h2>
<ul>
<li>There are several options to run an ANOVA model in R</li>
<li>Two most common are <code>lm</code> and <code>aov</code>
<ul>
<li><code>lm</code> = linear model; will be using frequently in BSTA 512</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) <span class="sc">%&gt;%</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: score
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
disability  4  30.521  7.6304  2.8616 0.03013 *
Residuals  65 173.321  2.6665                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
disability   4  30.52   7.630   2.862 0.0301 *
Residuals   65 173.32   2.666                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Hypotheses:</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \mu_{none} = \mu_{amputation} = \mu_{crutches} = \mu_{hearing} =  \mu_{wheelchair}\\
\text{vs. } H_A&amp;: \text{At least one pair } \mu_i \neq \mu_j \text{ for } i \neq j
\end{align}\]</span></p>
<p>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</p>
</section>
<section id="anova-tables" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="anova-tables">ANOVA tables</h2>
<p>Disability example ANOVA table from R:</p>
<div style="font-size: 90%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) <span class="sc">%&gt;%</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: score
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
disability  4  30.521  7.6304  2.8616 0.03013 *
Residuals  65 173.321  2.6665                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<p>Generic ANOVA table:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_table.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="anova-analysis-of-variance" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="anova-analysis-of-variance">ANOVA: Analysis of Variance</h2>
<p><strong>ANOVA</strong> compares the variability between groups to the variability within groups</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_total_variability.png" style="height:1.5in" class="figure-img"></p>
</figure>
</div>
<p><img src="../../img_slides/SST_visually_unnamed-chunk-13-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSG_visually_unnamed-chunk-14-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSE_visually_unnamed-chunk-17-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"></p>
</section>
<section id="anova-analysis-of-variance-1" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="anova-analysis-of-variance-1">ANOVA: Analysis of Variance</h2>
<p><strong>Analysis of Variance (ANOVA)</strong> compares the variability between groups to the variability within groups</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_total_variability.png" style="height:1.5in" class="figure-img"></p>
</figure>
</div>
<p><span class="math display">\[\sum_{i = 1}^k \sum_{j = 1}^{n_i}(x_{ij} -\bar{x})^2 \ \
= \ \sum_{i = 1}^k n_i(\bar{x}_{i}-\bar{x})^2 \ \
+ \ \ \sum_{i = 1}^k\sum_{j = 1}^{n_i}(x_{ij}-\bar{x}_{i})^2\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_SS_total.png" style="height:1.5in" class="figure-img"></p>
</figure>
</div>
</section>
<section id="notation" class="level2">
<h2 class="anchored" data-anchor-id="notation">Notation</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li><em>k</em> groups</li>
<li><span class="math inline">\(n_i\)</span> observations in each of the <em>k</em> groups</li>
<li>Total sample size is <span class="math inline">\(N=\sum_{i=1}^{k}n_i\)</span></li>
<li><span class="math inline">\(\bar{x}_{i}\)</span> = mean of observations in group <em>i</em></li>
<li><span class="math inline">\(\bar{x}\)</span> = mean of <em>all</em> observations</li>
<li><span class="math inline">\(s_{i}\)</span> = sd of observations in group <em>i</em></li>
<li><span class="math inline">\(s\)</span> = sd of <em>all</em> observations</li>
</ul>
</div><div class="column" style="width:70%;">
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Observation</th>
<th style="text-align: center;"><em>i</em> = 1</th>
<th style="text-align: center;"><em>i</em> = 2</th>
<th style="text-align: center;"><em>i</em> = 3</th>
<th style="text-align: center;"><span class="math inline">\(\ldots\)</span></th>
<th style="text-align: center;"><em>i</em> = <em>k</em></th>
<th style="text-align: center;">overall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><em>j</em> = 1</td>
<td style="text-align: center;"><span class="math inline">\(x_{11}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{21}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{31}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{k1}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>j</em> = 2</td>
<td style="text-align: center;"><span class="math inline">\(x_{12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{22}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{32}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{k2}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>j</em> = 3</td>
<td style="text-align: center;"><span class="math inline">\(x_{13}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{23}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{33}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{k3}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>j</em> = 4</td>
<td style="text-align: center;"><span class="math inline">\(x_{14}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{24}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{34}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{k4}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ddots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><em>j</em> = <span class="math inline">\(n_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{1n_1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{2n_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{3n_3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_{kn_k}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Means</td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}_{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}_{2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}_{3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}_{k}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Variance</td>
<td style="text-align: center;"><span class="math inline">\({s}^2_{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\({s}^2_{2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\({s}^2_{3}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ldots\)</span></td>
<td style="text-align: center;"><span class="math inline">\({s}^2_{k}\)</span></td>
<td style="text-align: center;"><span class="math inline">\({s}^2\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="total-sums-of-squares-visually" class="level2">
<h2 class="anchored" data-anchor-id="total-sums-of-squares-visually">Total Sums of Squares Visually</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>Total Sums of Squares:</p>
<p><span class="math display">\[SST = \sum_{i = 1}^k \sum_{j = 1}^{n_i}(x_{ij} -\bar{x})^2 = (N-1)s^2\]</span></p>
<ul>
<li><p>where</p>
<ul>
<li><span class="math inline">\(N=\sum_{i=1}^{k}n_i\)</span> is the total sample size and</li>
<li><span class="math inline">\(s^2\)</span> is the grand standard deviation of all the observations</li>
</ul></li>
<li><p>This is the sum of the squared differences between each observed <span class="math inline">\(x_{ij}\)</span> value and the <em>grand mean</em>, <span class="math inline">\(\bar{x}\)</span>.</p></li>
<li><p>That is, it is the total deviation of the <span class="math inline">\(x_{ij}\)</span>’s from the grand mean.</p></li>
</ul>
</div>
</div>
</section>
<section id="calculate-total-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="calculate-total-sums-of-squares">Calculate Total Sums of Squares</h2>
<p>Total Sums of Squares:</p>
<p><span class="math display">\[SST = \sum_{i = 1}^k \sum_{j = 1}^{n_i}(x_{ij} -\bar{x})^2 = (N-1)s^2\]</span></p>
<div class="columns">
<div class="column" style="width:35%;">
<ul>
<li>where
<ul>
<li><span class="math inline">\(N=\sum_{i=1}^{k}n_i\)</span> is the total sample size and</li>
<li><span class="math inline">\(s^2\)</span> is the grand standard deviation of all the observations</li>
</ul></li>
</ul>
</div><div class="column" style="width:65%;">
<p>Total sample size <span class="math inline">\(N\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(Ns <span class="ot">&lt;-</span> employ <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(disability) <span class="sc">%&gt;%</span> <span class="fu">count</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
# Groups:   disability [5]
  disability     n
  &lt;fct&gt;      &lt;int&gt;
1 none          14
2 amputation    14
3 crutches      14
4 hearing       14
5 wheelchair    14</code></pre>
</div>
</div>
<p><span class="math inline">\(SST\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(SST <span class="ot">&lt;-</span> (<span class="fu">sum</span>(Ns<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(employ<span class="sc">$</span>score)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203.8429</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="anova-analysis-of-variance-2" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="anova-analysis-of-variance-2">ANOVA: Analysis of Variance</h2>
<p><strong>ANOVA</strong> compares the variability between groups to the variability within groups</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_total_variability.png" style="height:1.5in" class="figure-img"></p>
</figure>
</div>
<p><img src="../../img_slides/SST_visually_unnamed-chunk-13-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSG_visually_unnamed-chunk-14-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSE_visually_unnamed-chunk-17-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"></p>
</section>
<section id="sums-of-squares-due-to-groups-visually-between-groups" class="level2">
<h2 class="anchored" data-anchor-id="sums-of-squares-due-to-groups-visually-between-groups">Sums of Squares due to Groups Visually (“between” groups)</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>Sums of Squares due to Groups:</p>
<p><span class="math display">\[SSG = \sum_{i = 1}^k n_i(\bar{x}_{i}-\bar{x})^2\]</span></p>
<ul>
<li><p>This is the sum of the squared differences between each <em>group</em> mean, <span class="math inline">\(\bar{x}_{i}\)</span>, and the <em>grand mean</em>, <span class="math inline">\(\bar{x}\)</span>.</p></li>
<li><p>That is, it is the deviation of the group means from the grand mean.</p></li>
<li><p>Also called the Model SS, or <span class="math inline">\(SS_{model}.\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="calculate-sums-of-squares-due-to-groups-between-groups" class="level2">
<h2 class="anchored" data-anchor-id="calculate-sums-of-squares-due-to-groups-between-groups">Calculate Sums of Squares due to Groups (“between” groups)</h2>
<p><span class="math display">\[SSG = \sum_{i = 1}^k n_i(\bar{x}_{i}-\bar{x})^2\]</span></p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>Calculate means <span class="math inline">\(\bar{x}_i\)</span> for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>xbar_groups <span class="ot">&lt;-</span> employ <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disability) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(score))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>xbar_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  disability  mean
  &lt;fct&gt;      &lt;dbl&gt;
1 none        4.9 
2 amputation  4.43
3 crutches    5.92
4 hearing     4.05
5 wheelchair  5.34</code></pre>
</div>
</div>
<p>Calculate <span class="math inline">\(SSG\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(SSG <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ns<span class="sc">$</span>n <span class="sc">*</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  (xbar_groups<span class="sc">$</span>mean <span class="sc">-</span> <span class="fu">mean</span>(employ<span class="sc">$</span>score))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30.52143</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="anova-analysis-of-variance-3" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="anova-analysis-of-variance-3">ANOVA: Analysis of Variance</h2>
<p><strong>ANOVA</strong> compares the variability between groups to the variability within groups</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_total_variability.png" style="height:1.5in" class="figure-img"></p>
</figure>
</div>
<p><img src="../../img_slides/SST_visually_unnamed-chunk-13-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSG_visually_unnamed-chunk-14-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"> <img src="../../img_slides/SSE_visually_unnamed-chunk-17-1.png" class="img-fluid" style="width:30.0%" data-fig-align="center"></p>
</section>
<section id="sums-of-squares-error-visually-within-groups" class="level2">
<h2 class="anchored" data-anchor-id="sums-of-squares-error-visually-within-groups">Sums of Squares Error Visually (within groups)</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>Sums of Squares Error:</p>
<p><span class="math display">\[SSE = \sum_{i = 1}^k\sum_{j = 1}^{n_i}(x_{ij}-\bar{x}_{i})^2 = \sum_{i = 1}^k(n_i-1)s_{i}^2\]</span> where <span class="math inline">\(s_{i}\)</span> is the standard deviation of the <span class="math inline">\(i^{th}\)</span> group</p>
<ul>
<li><p>This is the sum of the squared differences between each observed <span class="math inline">\(x_{ij}\)</span> value and its group mean <span class="math inline">\(\bar{x}_{i}\)</span>.</p></li>
<li><p>That is, it is the deviation of the <span class="math inline">\(x_{ij}\)</span>’s from the predicted score by group.</p></li>
<li><p>Also called the residual sums of squares, or <span class="math inline">\(SS_{residual}.\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="calculate-sums-of-squares-error-within-groups" class="level2">
<h2 class="anchored" data-anchor-id="calculate-sums-of-squares-error-within-groups">Calculate Sums of Squares Error (within groups)</h2>
<p><span class="math display">\[SSE = \sum_{i = 1}^k\sum_{j = 1}^{n_i}(x_{ij}-\bar{x}_{i})^2 = \sum_{i = 1}^k(n_i-1)s_{i}^2\]</span> where <span class="math inline">\(s_{i}\)</span> is the standard deviation of the <span class="math inline">\(i^{th}\)</span> group</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Calculate sd’s <span class="math inline">\(s_i\)</span> for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sd_groups <span class="ot">&lt;-</span> employ <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disability) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">SD =</span> <span class="fu">sd</span>(score))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>sd_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  disability    SD
  &lt;fct&gt;      &lt;dbl&gt;
1 none        1.79
2 amputation  1.59
3 crutches    1.48
4 hearing     1.53
5 wheelchair  1.75</code></pre>
</div>
</div>
<p>Calculate <span class="math inline">\(SSE\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  (Ns<span class="sc">$</span>n<span class="dv">-1</span>)<span class="sc">*</span>sd_groups<span class="sc">$</span>SD<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 173.3214</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="verify-sst-ssg-sse" class="level2 nostretch">
<h2 class="nostretch anchored" data-anchor-id="verify-sst-ssg-sse">Verify <em>SST = SSG + SSE</em></h2>
<p><strong>ANOVA</strong> compares the variability between groups to the variability within groups</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_total_variability.png" style="height:1.25in" class="figure-img"></p>
</figure>
</div>
<p><span class="math display">\[\sum_{i = 1}^k \sum_{j = 1}^{n_i}(x_{ij} -\bar{x})^2 \ \ = \ \ n_i\sum_{i = 1}^k(\bar{x}_{i}-\bar{x})^2 \ \
+ \ \ \sum_{i = 1}^k\sum_{j = 1}^{n_i}(x_{ij}-\bar{x}_{i})^2\]</span></p>
<p><span class="math display">\[(N-1)s^2 \ \
= \ \sum_{i = 1}^k n_i(\bar{x}_{i}-\bar{x})^2 \ \
+ \ \ \sum_{i = 1}^k(n_i-1)s_{i}^2\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_SS_total.png" style="height:1.25in" class="figure-img"></p>
</figure>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>SST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203.8429</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>SSG <span class="sc">+</span> SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203.8429</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="anova-table" class="level2">
<h2 class="anchored" data-anchor-id="anova-table">ANOVA table</h2>
<div class="columns">
<div class="column" style="width:15%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/SS_all3_vertical.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:85%;">
<!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_table.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="thinking-about-the-f-statistic" class="level2">
<h2 class="anchored" data-anchor-id="thinking-about-the-f-statistic">Thinking about the F-statistic</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong><span style="color:green">If the groups are actually different, then which of these is more accurate?</span></strong></p>
<ol type="1">
<li>The variability between groups should be higher than the variability within groups</li>
<li>The variability within groups should be higher than the variability between groups</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong><span style="color:green">If there really is a difference between the groups, we would expect the F-statistic to be which of these:</span></strong></p>
<ol type="1">
<li>Higher than we would observe by random chance</li>
<li>Lower than we would observe by random chance</li>
</ol>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<p><span class="math display">\[F = \frac{MSG}{MSE}\]</span></p>
</div><div class="column" style="width:75%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/hypothetical_disability_data_v2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-in-base-r-1" class="level2">
<h2 class="anchored" data-anchor-id="anova-in-base-r-1">ANOVA in base R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that I'm saving the tidy anova table</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Will be pulling p-value from this on future slide</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>empl_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>empl_lm <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="mvdoixwwln" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mvdoixwwln table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mvdoixwwln thead, #mvdoixwwln tbody, #mvdoixwwln tfoot, #mvdoixwwln tr, #mvdoixwwln td, #mvdoixwwln th {
  border-style: none;
}

#mvdoixwwln p {
  margin: 0;
  padding: 0;
}

#mvdoixwwln .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mvdoixwwln .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mvdoixwwln .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mvdoixwwln .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mvdoixwwln .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvdoixwwln .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvdoixwwln .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvdoixwwln .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mvdoixwwln .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mvdoixwwln .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mvdoixwwln .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mvdoixwwln .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mvdoixwwln .gt_spanner_row {
  border-bottom-style: hidden;
}

#mvdoixwwln .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mvdoixwwln .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mvdoixwwln .gt_from_md > :first-child {
  margin-top: 0;
}

#mvdoixwwln .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mvdoixwwln .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mvdoixwwln .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mvdoixwwln .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mvdoixwwln .gt_row_group_first td {
  border-top-width: 2px;
}

#mvdoixwwln .gt_row_group_first th {
  border-top-width: 2px;
}

#mvdoixwwln .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvdoixwwln .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mvdoixwwln .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mvdoixwwln .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvdoixwwln .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvdoixwwln .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mvdoixwwln .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mvdoixwwln .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mvdoixwwln .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvdoixwwln .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvdoixwwln .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvdoixwwln .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvdoixwwln .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvdoixwwln .gt_left {
  text-align: left;
}

#mvdoixwwln .gt_center {
  text-align: center;
}

#mvdoixwwln .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mvdoixwwln .gt_font_normal {
  font-weight: normal;
}

#mvdoixwwln .gt_font_bold {
  font-weight: bold;
}

#mvdoixwwln .gt_font_italic {
  font-style: italic;
}

#mvdoixwwln .gt_super {
  font-size: 65%;
}

#mvdoixwwln .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mvdoixwwln .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mvdoixwwln .gt_indent_1 {
  text-indent: 5px;
}

#mvdoixwwln .gt_indent_2 {
  text-indent: 10px;
}

#mvdoixwwln .gt_indent_3 {
  text-indent: 15px;
}

#mvdoixwwln .gt_indent_4 {
  text-indent: 20px;
}

#mvdoixwwln .gt_indent_5 {
  text-indent: 25px;
}

#mvdoixwwln .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mvdoixwwln div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="meansq">meansq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">disability</td>
<td headers="df" class="gt_row gt_right">4</td>
<td headers="sumsq" class="gt_row gt_right">30.52143</td>
<td headers="meansq" class="gt_row gt_right">7.630357</td>
<td headers="statistic" class="gt_row gt_right">2.86158</td>
<td headers="p.value" class="gt_row gt_right">0.03012686</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Residuals</td>
<td headers="df" class="gt_row gt_right">65</td>
<td headers="sumsq" class="gt_row gt_right">173.32143</td>
<td headers="meansq" class="gt_row gt_right">2.666484</td>
<td headers="statistic" class="gt_row gt_right">NA</td>
<td headers="p.value" class="gt_row gt_right">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Hypotheses:</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \mu_{none} = \mu_{amputation} = \mu_{crutches} = \mu_{hearing} =  \mu_{wheelchair}\\
\text{vs. } H_A&amp;: \text{At least one pair } \mu_i \neq \mu_j \text{ for } i \neq j
\end{align}\]</span></p>
<p>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</p>
</section>
<section id="conclusion-to-hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-to-hypothesis-test">Conclusion to hypothesis test</h2>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \mu_{none} = \mu_{amputation} = \mu_{crutches} = \mu_{hearing} =  \mu_{wheelchair}\\
\text{vs. } H_A&amp;: \text{At least one pair } \mu_i \neq \mu_j \text{ for } i \neq j
\end{align}\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>empl_lm  <span class="co"># tidy anova output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term          df sumsq meansq statistic p.value
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 disability     4  30.5   7.63      2.86  0.0301
2 Residuals     65 173.    2.67     NA    NA     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this is a vector:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>empl_lm<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03012686         NA</code></pre>
</div>
</div>
<p>Pull the p-value using base R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(empl_lm<span class="sc">$</span>p.value[<span class="dv">1</span>],<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03</code></pre>
</div>
</div>
<p>Pull the p-value using tidyverse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>empl_lm <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"disability"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Use <span class="math inline">\(\alpha\)</span> = 0.05.</li>
<li>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</li>
</ul>
<p><strong>Conclusion statement</strong>:</p>
<ul>
<li>There is sufficient evidence that at least one of the disability groups has a mean employment score statistically different from the other groups. ( <span class="math inline">\(p\)</span>-value = 0.03).</li>
</ul>
</div>
</div>
</section>
<section id="conditions-for-anova" class="level2">
<h2 class="anchored" data-anchor-id="conditions-for-anova">Conditions for ANOVA</h2>
<p><span style="color:green"><strong>IF</strong> ALL of the following conditions hold:</span></p>
<ol type="1">
<li>The null hypothesis is true</li>
<li>Sample sizes in each group group are large (each <span class="math inline">\(n \ge 30\)</span>)
<ul>
<li>OR the data are relatively normally distributed in each group</li>
</ul></li>
</ol>
<div class="columns">
<div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Variability is “similar” in all group groups:
<ul>
<li>Is the within group variability about the same for each group?</li>
<li>As a rough rule of thumb, this condition is <em>violated if the standard deviation of one group is more than double the standard deviation of another group</em></li>
</ul></li>
</ol>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p>Checking the <strong>equal variance</strong> condition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sd_groups <span class="co"># previously defined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  disability    SD
  &lt;fct&gt;      &lt;dbl&gt;
1 none        1.79
2 amputation  1.59
3 crutches    1.48
4 hearing     1.53
5 wheelchair  1.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(sd_groups<span class="sc">$</span>SD) <span class="sc">/</span> <span class="fu">min</span>(sd_groups<span class="sc">$</span>SD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.210425</code></pre>
</div>
</div>
</div>
</div>
<p><span style="color:green"><strong>THEN</strong> the sampling distribution of the <strong>F-statistic</strong> is an <strong>F-distribution</strong></span></p>
</section>
<section id="testing-variances-condition-3" class="level2">
<h2 class="anchored" data-anchor-id="testing-variances-condition-3">Testing variances (Condition 3)</h2>
<p><strong>Bartlett’s test for equal variances</strong></p>
<ul>
<li><span class="math inline">\(H_0:\)</span> population variances of group levels are equal</li>
<li><span class="math inline">\(H_A:\)</span> population variances of group levels are NOT equal</li>
</ul>
<p><em>Note: <span class="math inline">\(H_A\)</span> is same as saying that at least one of the group levels has a different variance</em></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Bartlett’s test assumes the data in each group are normally distributed.</li>
<li>Do not use if data do not satisfy the normality condition.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  score by disability
Bartlett's K-squared = 0.7016, df = 4, p-value = 0.9511</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Levene’s test for equality of variances is not as restrictive: see <a href="https://www.statology.org/levenes-test-r/" class="uri">https://www.statology.org/levenes-test-r/</a></p>
</div>
</div>
</section>
<section id="the-f-distribution" class="level2">
<h2 class="anchored" data-anchor-id="the-f-distribution">The F-distribution</h2>
<ul>
<li>The F-distribution is skewed right.</li>
<li>The F-distribution has <strong><span style="color:green">two different degrees of freedom</span></strong>:
<ul>
<li>one for the <span style="color:green">numerator</span> of the ratio <span style="color:green">(k – 1)</span> and</li>
<li>one for the <span style="color:green">denominator (N – k)</span></li>
</ul></li>
<li><span style="color:purple"><span class="math inline">\(p\)</span>-<strong>value</strong></span>
<ul>
<li>is always the <strong><span style="color:purple">upper tail</span></strong></li>
<li>(the area as extreme or more extreme)</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>empl_lm <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="iqmradiezn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iqmradiezn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iqmradiezn thead, #iqmradiezn tbody, #iqmradiezn tfoot, #iqmradiezn tr, #iqmradiezn td, #iqmradiezn th {
  border-style: none;
}

#iqmradiezn p {
  margin: 0;
  padding: 0;
}

#iqmradiezn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iqmradiezn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iqmradiezn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iqmradiezn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iqmradiezn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iqmradiezn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqmradiezn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iqmradiezn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iqmradiezn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iqmradiezn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iqmradiezn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iqmradiezn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iqmradiezn .gt_spanner_row {
  border-bottom-style: hidden;
}

#iqmradiezn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iqmradiezn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iqmradiezn .gt_from_md > :first-child {
  margin-top: 0;
}

#iqmradiezn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iqmradiezn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iqmradiezn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iqmradiezn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iqmradiezn .gt_row_group_first td {
  border-top-width: 2px;
}

#iqmradiezn .gt_row_group_first th {
  border-top-width: 2px;
}

#iqmradiezn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqmradiezn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iqmradiezn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iqmradiezn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqmradiezn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqmradiezn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iqmradiezn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iqmradiezn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iqmradiezn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqmradiezn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iqmradiezn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqmradiezn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iqmradiezn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqmradiezn .gt_left {
  text-align: left;
}

#iqmradiezn .gt_center {
  text-align: center;
}

#iqmradiezn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iqmradiezn .gt_font_normal {
  font-weight: normal;
}

#iqmradiezn .gt_font_bold {
  font-weight: bold;
}

#iqmradiezn .gt_font_italic {
  font-style: italic;
}

#iqmradiezn .gt_super {
  font-size: 65%;
}

#iqmradiezn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iqmradiezn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iqmradiezn .gt_indent_1 {
  text-indent: 5px;
}

#iqmradiezn .gt_indent_2 {
  text-indent: 10px;
}

#iqmradiezn .gt_indent_3 {
  text-indent: 15px;
}

#iqmradiezn .gt_indent_4 {
  text-indent: 20px;
}

#iqmradiezn .gt_indent_5 {
  text-indent: 25px;
}

#iqmradiezn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iqmradiezn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="meansq">meansq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">disability</td>
<td headers="df" class="gt_row gt_right">4</td>
<td headers="sumsq" class="gt_row gt_right">30.52143</td>
<td headers="meansq" class="gt_row gt_right">7.630357</td>
<td headers="statistic" class="gt_row gt_right">2.86158</td>
<td headers="p.value" class="gt_row gt_right">0.03012686</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Residuals</td>
<td headers="df" class="gt_row gt_right">65</td>
<td headers="sumsq" class="gt_row gt_right">173.32143</td>
<td headers="meansq" class="gt_row gt_right">2.666484</td>
<td headers="statistic" class="gt_row gt_right">NA</td>
<td headers="p.value" class="gt_row gt_right">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value using F-distribution</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">2.86158</span>, <span class="at">df1=</span><span class="dv">5-1</span>, <span class="at">df2=</span><span class="dv">70-5</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03012688</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="which-groups-are-statistically-different" class="level2">
<h2 class="anchored" data-anchor-id="which-groups-are-statistically-different">Which groups are statistically different?</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><br></p>
<ul>
<li>So far we’ve only determined that <em>at least one of the groups is different</em> from the others,
<ul>
<li>but we don’t know which.</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>What’s your guess?</li>
</ul>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="post-hoc-testing-for-anova" class="level1">
<h1>Post-hoc testing for ANOVA</h1>
<p><em>determining which groups are statistically different</em></p>
<section id="post-hoc-testing-pairwise-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-testing-pairwise-t-tests">Post-hoc testing: pairwise t-tests</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>In post-hoc testing we <span style="color:green"><strong>run all the pairwise t-tests</strong></span> comparing the means from each pair of groups.</li>
<li>With 5 groups, this involves doing <span class="math inline">\({5 \choose 2} = \frac{5!}{2!3!} = \frac{5\cdot 4}{2}= 10\)</span> different pairwise tests.</li>
</ul>
<p><strong>Problem:</strong></p>
<ul>
<li>Although the ANOVA test has an <span class="math inline">\(\alpha\)</span> chance of a Type I error (finding a difference between a pair that aren’t different),</li>
<li>the <span style="color:darkorange">overall Type I error rate will be much higher when running many tests simultaneously</span>.</li>
</ul>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:58%;">
<div style="font-size: 85%;">
<p><span class="math display">\[\begin{align}
P(\text{making an error}) = &amp; \alpha\\
P(\text{not making an error}) = &amp; 1-\alpha\\
P(\text{not making an error in m tests}) = &amp; (1-\alpha)^m\\
P(\text{making at least 1 error in m tests}) = &amp; 1-(1-\alpha)^m
\end{align}\]</span></p>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="the-bonferroni-correction-12" class="level2">
<h2 class="anchored" data-anchor-id="the-bonferroni-correction-12">The Bonferroni Correction (1/2)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>A very conservative (but very popular) approach is to divide the <span class="math inline">\(\alpha\)</span> level by how many tests <span class="math inline">\(m\)</span> are being done:</p>
<p><span class="math display">\[\alpha_{Bonf} = \frac{\alpha}{m}\]</span></p>
<ul>
<li>This is equivalent to multiplying the<br>
<em>p</em>-values by m:</li>
</ul>
<p><span class="math display">\[p\textrm{-value} &lt; \alpha_{Bonf} = \frac{\alpha}{m}\]</span> is the same as <span class="math display">\[m \cdot (p\textrm{-value}) &lt; \alpha\]</span> The Bonferroni correction is popular since it’s very easy to implement.</p>
</div><div class="column" style="width:50%;">
<ul>
<li>The <strong>plot below</strong> shows the <strong><span style="color:green">likelihood of making at least one Type I error</span></strong> depending on how may tests are done.</li>
<li>Notice the likelihood decreases very quickly
<ul>
<li>Unfortunately the likelihood of a Type II error is increasing as well</li>
<li>It becomes “harder” and harder to reject <span class="math inline">\(H_0\)</span> if doing many tests.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="the-bonferroni-correction-22" class="level2">
<h2 class="anchored" data-anchor-id="the-bonferroni-correction-22">The Bonferroni Correction (2/2)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Pairwise t-tests without any <em>p</em>-value adjustments:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(employ<span class="sc">$</span>score, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                employ<span class="sc">$</span>disability, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adj=</span><span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  employ$score and employ$disability 

           none   amputation crutches hearing
amputation 0.4477 -          -        -      
crutches   0.1028 0.0184     -        -      
hearing    0.1732 0.5418     0.0035   -      
wheelchair 0.4756 0.1433     0.3520   0.0401 

P value adjustment method: none </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Pairwise t-tests <strong><span style="color:green">with Bonferroni <em>p</em>-value adjustments</span></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(employ<span class="sc">$</span>score,  </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                employ<span class="sc">$</span>disability, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adj=</span><span class="st">"bonferroni"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  employ$score and employ$disability 

           none  amputation crutches hearing
amputation 1.000 -          -        -      
crutches   1.000 0.184      -        -      
hearing    1.000 1.000      0.035    -      
wheelchair 1.000 1.000      1.000    0.401  

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<ul>
<li>Since there were 10 tests, all the <em>p</em>-values were multiplied by 10.</li>
<li>Are there any significant pairwise differences?</li>
</ul>
</div>
</div>
</section>
<section id="tukeys-honest-significance-test-hsd" class="level2">
<h2 class="anchored" data-anchor-id="tukeys-honest-significance-test-hsd">Tukey’s Honest Significance Test (HSD)</h2>
<ul>
<li>Tukey’s Honest Significance Test (HSD) controls the “family-wise probability” of making a Type I error using a much less conservative method than Bonferroni
<ul>
<li><strong>It is specific to ANOVA</strong></li>
</ul></li>
<li>In addition to adjusted <em>p</em>-values, it also calculates Tukey adjusted CI’s for all pairwise differences</li>
<li>The function <code>TukeyHSD()</code> creates a <strong>set of confidence intervals</strong> of the differences between means with the specified <strong>family-wise probability of coverage</strong>.</li>
</ul>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need to run the model using `aov` instead of `lm`</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>empl_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="at">x=</span>empl_aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = score ~ disability, data = employ)

$disability
                            diff        lwr        upr     p adj
amputation-none       -0.4714286 -2.2031613  1.2603042 0.9399911
crutches-none          1.0214286 -0.7103042  2.7531613 0.4686233
hearing-none          -0.8500000 -2.5817328  0.8817328 0.6442517
wheelchair-none        0.4428571 -1.2888756  2.1745899 0.9517374
crutches-amputation    1.4928571 -0.2388756  3.2245899 0.1232819
hearing-amputation    -0.3785714 -2.1103042  1.3531613 0.9724743
wheelchair-amputation  0.9142857 -0.8174470  2.6460185 0.5781165
hearing-crutches      -1.8714286 -3.6031613 -0.1396958 0.0277842
wheelchair-crutches   -0.5785714 -2.3103042  1.1531613 0.8812293
wheelchair-hearing     1.2928571 -0.4388756  3.0245899 0.2348141</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(<span class="at">x=</span>empl_aov, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="there-are-many-more-multiple-testing-adjustment-procedures" class="level2">
<h2 class="anchored" data-anchor-id="there-are-many-more-multiple-testing-adjustment-procedures">There are many more multiple testing adjustment procedures</h2>
<div class="columns">
<div class="column" style="width:49%;">
<ul>
<li>Bonferroni is popular because it’s so easy to apply</li>
<li>Tukey’s HSD is usually used for ANOVA</li>
<li>Code below used Holm’s adjustment</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default is Holm's adjustments</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(employ<span class="sc">$</span>score, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                employ<span class="sc">$</span>disability) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  employ$score and employ$disability 

           none  amputation crutches hearing
amputation 1.000 -          -        -      
crutches   0.719 0.165      -        -      
hearing    0.866 1.000      0.035    -      
wheelchair 1.000 0.860      1.000    0.321  

P value adjustment method: holm </code></pre>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<ul>
<li><strong>False discovery rate (fdr)</strong> <em>p</em>-value adjustments are popular in omics, or whenever there are <em>many</em> tests being run:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(employ<span class="sc">$</span>score, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                employ<span class="sc">$</span>disability, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adj=</span><span class="st">"fdr"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  employ$score and employ$disability 

           none  amputation crutches hearing
amputation 0.528 -          -        -      
crutches   0.257 0.092      -        -      
hearing    0.289 0.542      0.035    -      
wheelchair 0.528 0.287      0.503    0.134  

P value adjustment method: fdr </code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-testing" class="level1">
<h1>Multiple testing</h1>
<p><em>post-hoc testing vs.&nbsp;testing many outcomes</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/xkcd_significant2.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><a href="https://xkcd.com/882/" class="uri">https://xkcd.com/882/</a></p>
<section id="multiple-testing-controlling-the-type-i-error-rate" class="level2">
<h2 class="anchored" data-anchor-id="multiple-testing-controlling-the-type-i-error-rate">Multiple testing: controlling the Type I error rate</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>The multiple testing issue is not unique to ANOVA post-hoc testing.</li>
<li>It is also a concern when running separate tests for many related outcomes.</li>
<li><strong><span style="color:darkorange">Beware of <em>p</em>-hacking!</span></strong></li>
</ul>
<p><strong>Problem:</strong></p>
<ul>
<li>Although one test has an <span class="math inline">\(\alpha\)</span> chance of a Type I error (finding a difference between a pair that aren’t different),</li>
<li>the <span style="color:darkorange"><strong>overall Type I error rate will be much higher when running many tests simultaneously</strong></span>.</li>
</ul>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:58%;">
<div style="font-size: 85%;">
<p><span class="math display">\[\begin{align}
P(\text{making an error}) = &amp; \alpha\\
P(\text{not making an error}) = &amp; 1-\alpha\\
P(\text{not making an error in m tests}) = &amp; (1-\alpha)^m\\
P(\text{making at least 1 error in m tests}) = &amp; 1-(1-\alpha)^m
\end{align}\]</span></p>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="anova-summary" class="level2">
<h2 class="anchored" data-anchor-id="anova-summary">ANOVA Summary</h2>
<div style="font-size: 90%;">
<p><span class="math display">\[\begin{align}
H_0 &amp;: \mu_1 = \mu_2 = ... = \mu_k\\
\text{vs. } H_A&amp;: \text{At least one pair } \mu_i \neq \mu_j \text{ for } i \neq j
\end{align}\]</span></p>
</div>
<p>ANOVA table in R:</p>
<div style="font-size: 90%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(score <span class="sc">~</span> disability, <span class="at">data =</span> employ) <span class="sc">%&gt;%</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: score
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
disability  4  30.521  7.6304  2.8616 0.03013 *
Residuals  65 173.321  2.6665                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>ANOVA table</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/anova_table.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Post-hoc testing</p>
</div><div class="column" style="width:50%;">
<p>F-distribution &amp; p-value</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="14_ANOVA_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">What’s next?</h2>
<p><br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img_slides/flowchart_only_continuous.jpg" class="img-fluid figure-img"></p>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>