<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Meike Niederhausen, PhD">
<meta name="dcterms.date" content="2023-11-27">

<title>BSTA 511/611 Fall 2023 - Day 16: Simple Linear Regression Part 2 (Sections 6.3-6.4)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/IMG_8165sq_med.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BSTA 511/611 Fall 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class_slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../weeks.html" rel="" target="">
 <span class="menu-text">Weeks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homework.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homework_solutions.html" rel="" target="">
 <span class="menu-text">Homework solutions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Day 16: Simple Linear Regression Part 2 (Sections 6.3-6.4)</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weeks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework solutions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#goals-for-today-sections-6.3-6.4" id="toc-goals-for-today-sections-6.3-6.4" class="nav-link" data-scroll-target="#goals-for-today-sections-6.3-6.4">Goals for today (Sections 6.3-6.4)</a></li>
  <li><a href="#life-expectancy-vs.-female-adult-literacy-rate" id="toc-life-expectancy-vs.-female-adult-literacy-rate" class="nav-link" data-scroll-target="#life-expectancy-vs.-female-adult-literacy-rate">Life expectancy vs.&nbsp;female adult literacy rate</a>
  <ul class="collapse">
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link" data-scroll-target="#dataset-description">Dataset description</a></li>
  <li><a href="#get-to-know-the-data" id="toc-get-to-know-the-data" class="nav-link" data-scroll-target="#get-to-know-the-data">Get to know the data</a></li>
  <li><a href="#remove-missing-values" id="toc-remove-missing-values" class="nav-link" data-scroll-target="#remove-missing-values">Remove missing values</a></li>
  </ul></li>
  <li><a href="#regression-line-best-fit-line" id="toc-regression-line-best-fit-line" class="nav-link" data-scroll-target="#regression-line-best-fit-line">Regression line = best-fit line</a>
  <ul class="collapse">
  <li><a href="#regression-in-r-lm-summary-tidy" id="toc-regression-in-r-lm-summary-tidy" class="nav-link" data-scroll-target="#regression-in-r-lm-summary-tidy">Regression in R: <code>lm()</code>, <code>summary()</code>, &amp; <code>tidy()</code></a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#the-population-regresison-model" id="toc-the-population-regresison-model" class="nav-link" data-scroll-target="#the-population-regresison-model">The (population) regresison model</a></li>
  </ul></li>
  <li><a href="#what-are-the-line-conditions" id="toc-what-are-the-line-conditions" class="nav-link" data-scroll-target="#what-are-the-line-conditions">What are the LINE conditions?</a>
  <ul class="collapse">
  <li><a href="#l-linearity-of-relationship-between-variables" id="toc-l-linearity-of-relationship-between-variables" class="nav-link" data-scroll-target="#l-linearity-of-relationship-between-variables">L: Linearity of relationship between variables</a></li>
  <li><a href="#i-independence-of-the-residuals-y-values" id="toc-i-independence-of-the-residuals-y-values" class="nav-link" data-scroll-target="#i-independence-of-the-residuals-y-values">I: Independence of the residuals (<span class="math inline">\(Y\)</span> values)</a></li>
  </ul></li>
  <li><a href="#n-normality-of-the-residuals" id="toc-n-normality-of-the-residuals" class="nav-link" data-scroll-target="#n-normality-of-the-residuals">N: Normality of the residuals</a>
  <ul class="collapse">
  <li><a href="#n-normality-of-the-residuals-1" id="toc-n-normality-of-the-residuals-1" class="nav-link" data-scroll-target="#n-normality-of-the-residuals-1">N: Normality of the residuals</a></li>
  <li><a href="#extract-models-residuals-in-r" id="toc-extract-models-residuals-in-r" class="nav-link" data-scroll-target="#extract-models-residuals-in-r">Extract model’s residuals in R</a></li>
  <li><a href="#check-normality-with-usual-distribution-plots" id="toc-check-normality-with-usual-distribution-plots" class="nav-link" data-scroll-target="#check-normality-with-usual-distribution-plots">Check normality with “usual” distribution plots</a></li>
  <li><a href="#normal-qq-plots-qq-quantile-quantile" id="toc-normal-qq-plots-qq-quantile-quantile" class="nav-link" data-scroll-target="#normal-qq-plots-qq-quantile-quantile">Normal QQ plots (QQ = quantile-quantile)</a>
  <ul class="collapse">
  <li><a href="#examples-of-normal-qq-plots" id="toc-examples-of-normal-qq-plots" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots">Examples of Normal QQ plots</a></li>
  </ul></li>
  <li><a href="#qq-plot-of-residuals-of-model1" id="toc-qq-plot-of-residuals-of-model1" class="nav-link" data-scroll-target="#qq-plot-of-residuals-of-model1">QQ plot of residuals of <code>model1</code></a></li>
  <li><a href="#compare-to-randomly-generated-normal-qq-plots" id="toc-compare-to-randomly-generated-normal-qq-plots" class="nav-link" data-scroll-target="#compare-to-randomly-generated-normal-qq-plots">Compare to randomly generated Normal QQ plots</a>
  <ul class="collapse">
  <li><a href="#randomly-generated-normal-qq-plots-n100" id="toc-randomly-generated-normal-qq-plots-n100" class="nav-link" data-scroll-target="#randomly-generated-normal-qq-plots-n100">Randomly generated Normal QQ plots: n=100</a></li>
  <li><a href="#examples-of-simulated-normal-qq-plots-n10" id="toc-examples-of-simulated-normal-qq-plots-n10" class="nav-link" data-scroll-target="#examples-of-simulated-normal-qq-plots-n10">Examples of simulated Normal QQ plots: n=10</a></li>
  <li><a href="#examples-of-simulated-normal-qq-plots-n1000" id="toc-examples-of-simulated-normal-qq-plots-n1000" class="nav-link" data-scroll-target="#examples-of-simulated-normal-qq-plots-n1000">Examples of simulated Normal QQ plots: n=1,000</a></li>
  </ul></li>
  <li><a href="#back-to-our-example" id="toc-back-to-our-example" class="nav-link" data-scroll-target="#back-to-our-example">Back to our example</a></li>
  </ul></li>
  <li><a href="#e-equality-of-variance-of-the-residuals" id="toc-e-equality-of-variance-of-the-residuals" class="nav-link" data-scroll-target="#e-equality-of-variance-of-the-residuals">E: Equality of variance of the residuals</a>
  <ul class="collapse">
  <li><a href="#residual-plot" id="toc-residual-plot" class="nav-link" data-scroll-target="#residual-plot">Residual plot</a></li>
  <li><a href="#e-equality-of-variance-of-the-residuals-homoscedasticity" id="toc-e-equality-of-variance-of-the-residuals-homoscedasticity" class="nav-link" data-scroll-target="#e-equality-of-variance-of-the-residuals-homoscedasticity">E: Equality of variance of the residuals (Homoscedasticity)</a></li>
  </ul></li>
  <li><a href="#r2-coefficient-of-determination" id="toc-r2-coefficient-of-determination" class="nav-link" data-scroll-target="#r2-coefficient-of-determination"><span class="math inline">\(R^2\)</span> = Coefficient of determination</a>
  <ul class="collapse">
  <li><a href="#r2-coefficient-of-determination-12" id="toc-r2-coefficient-of-determination-12" class="nav-link" data-scroll-target="#r2-coefficient-of-determination-12"><span class="math inline">\(R^2\)</span> = Coefficient of determination (1/2)</a></li>
  <li><a href="#r2-coefficient-of-determination-22" id="toc-r2-coefficient-of-determination-22" class="nav-link" data-scroll-target="#r2-coefficient-of-determination-22"><span class="math inline">\(R^2\)</span> = Coefficient of determination (2/2)</a></li>
  <li><a href="#r2-in-summary-r-output" id="toc-r2-in-summary-r-output" class="nav-link" data-scroll-target="#r2-in-summary-r-output"><span class="math inline">\(R^2\)</span> in <code>summary()</code> R output</a></li>
  </ul></li>
  <li><a href="#regression-inference" id="toc-regression-inference" class="nav-link" data-scroll-target="#regression-inference">Regression inference</a>
  <ul class="collapse">
  <li><a href="#inference-for-population-slope-beta_1" id="toc-inference-for-population-slope-beta_1" class="nav-link" data-scroll-target="#inference-for-population-slope-beta_1">Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a>
  <ul class="collapse">
  <li><a href="#inference-for-the-population-slope-ci-and-hypothesis-test" id="toc-inference-for-the-population-slope-ci-and-hypothesis-test" class="nav-link" data-scroll-target="#inference-for-the-population-slope-ci-and-hypothesis-test">Inference for the population <span style="color:green"><strong>slope</strong></span>: CI and hypothesis test</a></li>
  <li><a href="#ci-for-population-slope-beta_1" id="toc-ci-for-population-slope-beta_1" class="nav-link" data-scroll-target="#ci-for-population-slope-beta_1">CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#standard-error-of-fitted-slope-b_1" id="toc-standard-error-of-fitted-slope-b_1" class="nav-link" data-scroll-target="#standard-error-of-fitted-slope-b_1">Standard error of fitted slope <span class="math inline">\(b_1\)</span></a></li>
  <li><a href="#calculate-ci-for-population-slope-beta_1" id="toc-calculate-ci-for-population-slope-beta_1" class="nav-link" data-scroll-target="#calculate-ci-for-population-slope-beta_1">Calculate CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#hypothesis-test-for-population-slope-beta_1" id="toc-hypothesis-test-for-population-slope-beta_1" class="nav-link" data-scroll-target="#hypothesis-test-for-population-slope-beta_1">Hypothesis test for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#p-value-for-testing-population-slope-beta_1" id="toc-p-value-for-testing-population-slope-beta_1" class="nav-link" data-scroll-target="#p-value-for-testing-population-slope-beta_1"><span class="math inline">\(p\)</span>-value for testing population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#prediction-inference" id="toc-prediction-inference" class="nav-link" data-scroll-target="#prediction-inference">Prediction (&amp; inference)</a>
  <ul class="collapse">
  <li><a href="#prediction-with-regression-line" id="toc-prediction-with-regression-line" class="nav-link" data-scroll-target="#prediction-with-regression-line">Prediction with regression line</a>
  <ul class="collapse">
  <li><a href="#prediction-with-regression-line-1" id="toc-prediction-with-regression-line-1" class="nav-link" data-scroll-target="#prediction-with-regression-line-1">Prediction with regression line</a></li>
  <li><a href="#ci-for-mean-response-mu_yx" id="toc-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#ci-for-mean-response-mu_yx">CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#example-ci-for-mean-response-mu_yx" id="toc-example-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#example-ci-for-mean-response-mu_yx">Example: CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#example-using-r-for-ci-for-mean-response-mu_yx" id="toc-example-using-r-for-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#example-using-r-for-ci-for-mean-response-mu_yx">Example: Using R for CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#confidence-bands-for-mean-response-mu_yx" id="toc-confidence-bands-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#confidence-bands-for-mean-response-mu_yx">Confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#width-of-confidence-bands-for-mean-response-mu_yx" id="toc-width-of-confidence-bands-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#width-of-confidence-bands-for-mean-response-mu_yx">Width of confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  </ul></li>
  <li><a href="#prediction-interval-for-predicting-individual-observations" id="toc-prediction-interval-for-predicting-individual-observations" class="nav-link" data-scroll-target="#prediction-interval-for-predicting-individual-observations">Prediction interval for predicting <strong>individual</strong> observations</a>
  <ul class="collapse">
  <li><a href="#example-prediction-interval" id="toc-example-prediction-interval" class="nav-link" data-scroll-target="#example-prediction-interval">Example: Prediction interval</a></li>
  <li><a href="#example-using-r-for-prediction-interval" id="toc-example-using-r-for-prediction-interval" class="nav-link" data-scroll-target="#example-using-r-for-prediction-interval">Example: Using R for prediction interval</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#prediction-bands-vs.-confidence-bands-12" id="toc-prediction-bands-vs.-confidence-bands-12" class="nav-link" data-scroll-target="#prediction-bands-vs.-confidence-bands-12">Prediction bands vs.&nbsp;confidence bands (1/2)</a>
  <ul class="collapse">
  <li><a href="#prediction-bands-vs.-confidence-bands-22" id="toc-prediction-bands-vs.-confidence-bands-22" class="nav-link" data-scroll-target="#prediction-bands-vs.-confidence-bands-22">Prediction bands vs.&nbsp;confidence bands (2/2)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day 16: Simple Linear Regression Part 2 (Sections 6.3-6.4)</h1>
<p class="subtitle lead">BSTA 511/611</p>
  <div class="quarto-categories">
    <div class="quarto-category">Week 10</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Meike Niederhausen, PhD </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            OHSU-PSU School of Public Health
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 27, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="load-packages" class="level1">
<h1>Load packages</h1>
<ul>
<li>Packages need to be loaded <em>every time</em> you restart R or render an Qmd file</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run these every time you open Rstudio</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(oibiostat)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># NEW!!!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>You can check whether a package has been loaded or not
<ul>
<li>by looking at the Packages tab and</li>
<li>seeing whether it has been checked off or not</li>
</ul></li>
</ul>
</section>
<section id="goals-for-today-sections-6.3-6.4" class="level1">
<h1>Goals for today (Sections 6.3-6.4)</h1>
<p>Simple Linear Regression Part 2</p>
<ul>
<li>Review of
<ul>
<li>best-fit line (aka regression line or least-squares line)</li>
<li>residuals</li>
<li>population model</li>
</ul></li>
<li>LINE conditions and how to assess them
<ul>
<li>New diagnostic tools:
<ul>
<li>Normal QQ plots of residuals</li>
<li>Residual plots</li>
</ul></li>
</ul></li>
<li>Coefficient of determination (<span class="math inline">\(R^2\)</span>)</li>
<li>Regression inference
<ol type="1">
<li>Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span>
<ul>
<li>CI &amp; hypothesis test</li>
</ul></li>
<li>CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></li>
<li>Prediction interval for predicting <strong>individual</strong> observations</li>
</ol>
<ul>
<li>Confidence bands vs.&nbsp;predictions bands</li>
</ul></li>
</ul>
</section>
<section id="life-expectancy-vs.-female-adult-literacy-rate" class="level1">
<h1>Life expectancy vs.&nbsp;female adult literacy rate</h1>
<p><a href="https://www.gapminder.org/tools/#$model$markers$bubble$encoding$x$data$concept=literacy_rate_adult_female_percent_of_females_ages_15_above&amp;source=sg&amp;space@=country&amp;=time;;&amp;scale$domain:null&amp;zoomed:null&amp;type:null;;&amp;frame$value=2011;;;;;&amp;chart-type=bubbles&amp;url=v1" class="uri">https://www.gapminder.org/tools/#$model$markers$bubble$encoding$x$data$concept=literacy_rate_adult_female_percent_of_females_ages_15_above&amp;source=sg&amp;space@=country&amp;=time;;&amp;scale$domain:null&amp;zoomed:null&amp;type:null;;&amp;frame$value=2011;;;;;&amp;chart-type=bubbles&amp;url=v1</a></p>
<section id="dataset-description" class="level2">
<h2 class="anchored" data-anchor-id="dataset-description">Dataset description</h2>
<ul>
<li><p>Data file: <code>lifeexp_femlit_water_2011.csv</code></p></li>
<li><p>Data were downloaded from <a href="https://www.gapminder.org/data/" class="uri">https://www.gapminder.org/data/</a></p></li>
<li><p>2011 is the most recent year with the most complete data</p></li>
<li><p><strong>Life expectancy</strong> = the average number of years a newborn child would live if current mortality patterns were to stay the same. Source: <a href="https://www.gapminder.org/data/documentation/gd004/" class="uri">https://www.gapminder.org/data/documentation/gd004/</a></p></li>
<li><p><strong>Adult literacy rate</strong> is the percentage of people ages 15 and above who can, with understanding, read and write a short, simple statement on their everyday life. Source: <a href="http://data.uis.unesco.org/" class="uri">http://data.uis.unesco.org/</a></p></li>
<li><p><strong>At least basic water source (%)</strong> = the percentage of people using at least basic water services. This indicator encompasses both people using basic water services as well as those using safely managed water services. Basic drinking water services is defined as drinking water from an improved source, provided collection time is not more than 30 minutes for a round trip. Improved water sources include piped water, boreholes or tubewells, protect dug wells, protected springs, and packaged or delivered water.</p></li>
</ul>
</section>
<section id="get-to-know-the-data" class="level2">
<h2 class="anchored" data-anchor-id="get-to-know-the-data">Get to know the data</h2>
<p>Load data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gapm_original <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"lifeexp_femlit_water_2011.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Glimpse of the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapm_original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 194
Columns: 5
$ country                    &lt;chr&gt; "Afghanistan", "Albania", "Algeria", "Andor…
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 76.7, 82.6, 60.9, 76.9, 76.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, NA, NA, 58.6, 99.4, 97.9, 99.5,…
$ water_basic_source_2011    &lt;dbl&gt; 52.6, 88.1, 92.6, 100.0, 40.3, 97.0, 99.5, …
$ water_2011_quart           &lt;chr&gt; "Q1", "Q2", "Q2", "Q4", "Q1", "Q3", "Q4", "…</code></pre>
</div>
</div>
<p>Note the missing values for our variables of interest</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gapm_original <span class="sc">%&gt;%</span> <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  variable        n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 life_expec…   187  47.5  82.9   72.7  64.3  76.9  12.6  9.04  70.7  8.44 0.617
2 female_lit…    80  13    99.8   91.6  71.0  98.0  27.0 11.4   81.7 22.0  2.45 
# ℹ 1 more variable: ci &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="remove-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="remove-missing-values">Remove missing values</h2>
<p>Remove rows with missing data for life expectancy and female literacy rate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gapm <span class="ot">&lt;-</span> gapm_original <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(life_expectancy_years_2011, female_literacy_rate_2011)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 5
$ country                    &lt;chr&gt; "Afghanistan", "Albania", "Angola", "Antigu…
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ water_basic_source_2011    &lt;dbl&gt; 52.6, 88.1, 40.3, 97.0, 99.5, 97.8, 96.7, 9…
$ water_2011_quart           &lt;chr&gt; "Q1", "Q2", "Q1", "Q3", "Q4", "Q3", "Q3", "…</code></pre>
</div>
</div>
<p>No missing values now for our variables of interest</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gapm <span class="sc">%&gt;%</span> <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  variable        n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 life_expec…    80    48  81.8   72.4  65.9  75.8  9.95  6.30  69.9  7.95 0.889
2 female_lit…    80    13  99.8   91.6  71.0  98.0 27.0  11.4   81.7 22.0  2.45 
# ℹ 1 more variable: ci &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Removing the rows with missing data was not needed to run the regression model.</li>
<li>I did this step since later we will be calculating the standard deviations of the explanatory and response variables for <em>just the values included in the regression model</em>. It’ll be easier to do this if we remove the missing values now.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="regression-line-best-fit-line" class="level1">
<h1>Regression line = best-fit line</h1>
<p><span class="math display">\[\widehat{y} = b_0 + b_1 \cdot x \]</span></p>
<ul>
<li><span class="math inline">\(\hat{y}\)</span> is the predicted outcome for a specific value of <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(b_0\)</span> is the intercept</li>
<li><span class="math inline">\(b_1\)</span> is the slope of the line, i.e., the increase in <span class="math inline">\(\hat{y}\)</span> for every increase of one (unit increase) in <span class="math inline">\(x\)</span>.
<ul>
<li>slope = <em>rise over run</em></li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ul>
<li><strong>Intercept</strong>
<ul>
<li>The expected outcome for the <span class="math inline">\(y\)</span>-variable when the <span class="math inline">\(x\)</span>-variable is 0.</li>
</ul></li>
<li><strong>Slope</strong>
<ul>
<li>For every increase of 1 unit in the <span class="math inline">\(x\)</span>-variable, there is an expected increase of, on average, <span class="math inline">\(b_1\)</span> units in the <span class="math inline">\(y\)</span>-variable.</li>
<li>We only say that there is an expected increase and not necessarily a causal increase.</li>
</ul></li>
</ul>
<section id="regression-in-r-lm-summary-tidy" class="level2">
<h2 class="anchored" data-anchor-id="regression-in-r-lm-summary-tidy">Regression in R: <code>lm()</code>, <code>summary()</code>, &amp; <code>tidy()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> gapm)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, 
    data = gapm)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.299  -2.670   1.145   4.114   9.498 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               50.92790    2.66041  19.143  &lt; 2e-16 ***
female_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.142 on 78 degrees of freedom
Multiple R-squared:  0.4109,    Adjusted R-squared:  0.4034 
F-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="nvdglatniq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nvdglatniq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nvdglatniq thead, #nvdglatniq tbody, #nvdglatniq tfoot, #nvdglatniq tr, #nvdglatniq td, #nvdglatniq th {
  border-style: none;
}

#nvdglatniq p {
  margin: 0;
  padding: 0;
}

#nvdglatniq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nvdglatniq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nvdglatniq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nvdglatniq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nvdglatniq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nvdglatniq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nvdglatniq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nvdglatniq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nvdglatniq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nvdglatniq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nvdglatniq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nvdglatniq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nvdglatniq .gt_spanner_row {
  border-bottom-style: hidden;
}

#nvdglatniq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nvdglatniq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nvdglatniq .gt_from_md > :first-child {
  margin-top: 0;
}

#nvdglatniq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nvdglatniq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nvdglatniq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nvdglatniq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nvdglatniq .gt_row_group_first td {
  border-top-width: 2px;
}

#nvdglatniq .gt_row_group_first th {
  border-top-width: 2px;
}

#nvdglatniq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nvdglatniq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nvdglatniq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nvdglatniq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nvdglatniq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nvdglatniq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nvdglatniq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nvdglatniq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nvdglatniq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nvdglatniq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nvdglatniq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nvdglatniq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nvdglatniq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nvdglatniq .gt_left {
  text-align: left;
}

#nvdglatniq .gt_center {
  text-align: center;
}

#nvdglatniq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nvdglatniq .gt_font_normal {
  font-weight: normal;
}

#nvdglatniq .gt_font_bold {
  font-weight: bold;
}

#nvdglatniq .gt_font_italic {
  font-style: italic;
}

#nvdglatniq .gt_super {
  font-size: 65%;
}

#nvdglatniq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nvdglatniq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nvdglatniq .gt_indent_1 {
  text-indent: 5px;
}

#nvdglatniq .gt_indent_2 {
  text-indent: 10px;
}

#nvdglatniq .gt_indent_3 {
  text-indent: 15px;
}

#nvdglatniq .gt_indent_4 {
  text-indent: 20px;
}

#nvdglatniq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Regression equation for our model:</p>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot \textrm{female literacy rate} \]</span></p>
</section>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<ul>
<li><strong>Observed values</strong> <span class="math inline">\(y_i\)</span>
<ul>
<li>the values in the dataset</li>
</ul></li>
<li><strong>Fitted values</strong> <span class="math inline">\(\widehat{y}_i\)</span>
<ul>
<li>the values that fall on the best-fit line for a specific <span class="math inline">\(x_i\)</span></li>
</ul></li>
<li><strong>Residuals</strong> <span class="math inline">\(e_i = y_i - \widehat{y}_i\)</span>
<ul>
<li>the differences between the observed and fitted values</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="the-population-regresison-model" class="level2">
<h2 class="anchored" data-anchor-id="the-population-regresison-model">The (population) regresison model</h2>
<ul>
<li>The (population) regression model is denoted by</li>
</ul>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \epsilon\]</span></p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown population parameters</li>
<li><span class="math inline">\(\epsilon\)</span> (epsilon) is the error about the line
<ul>
<li>It is assumed to be a random variable:
<ul>
<li><span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></li>
<li>variance <span class="math inline">\(\sigma^2\)</span> is constant</li>
</ul></li>
</ul></li>
</ul>
<p><em>See slides for image.</em></p>
<ul>
<li><p>The <span style="color:blue"><strong>line</strong></span> is the average (expected) value of <span class="math inline">\(Y\)</span> given a value of <span class="math inline">\(x\)</span>: <span style="color:blue"><span class="math inline">\(E(Y|x)\)</span></span>.</p></li>
<li><p>The point estimates for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> based on a sample are denoted by <span class="math inline">\(b_0, b_1, s_{residuals}^2\)</span></p>
<ul>
<li>Note: also common notation is <span class="math inline">\(\widehat{\beta}_0, \widehat{\beta}_1, \widehat{\sigma}^2\)</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="what-are-the-line-conditions" class="level1">
<h1>What are the LINE conditions?</h1>
<p>For “good” model fit and to be able to make inferences and predictions based on our models, 4 conditions need to be satisfied.</p>
<p>Briefly:</p>
<ul>
<li><strong>L</strong> inearity of relationship between variables</li>
<li><strong>I</strong> ndependence of the Y values</li>
<li><strong>N</strong> ormality of the residuals</li>
<li><strong>E</strong> quality of variance of the residuals (homoscedasticity)</li>
</ul>
<p><a href="https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions">More in depth</a>:</p>
<ul>
<li><strong>L</strong> : there is a linear relationship between the mean response (Y) and the explanatory variable (X),</li>
<li><strong>I</strong> : the errors are independent—there’s no connection between how far any two points lie from the regression line,</li>
<li><strong>N</strong> : the responses are normally distributed at each level of X, and</li>
<li><strong>E</strong> : the variance or, equivalently, the standard deviation of the responses is equal for all levels of X.</li>
</ul>
<section id="l-linearity-of-relationship-between-variables" class="level2">
<h2 class="anchored" data-anchor-id="l-linearity-of-relationship-between-variables">L: Linearity of relationship between variables</h2>
<p>Is the association between the variables linear?</p>
<ul>
<li>Diagnostic tools:
<ul>
<li>Scatterplot</li>
<li>Residual plot (see later section for E : Equality of variance of the residuals)</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="i-independence-of-the-residuals-y-values" class="level2">
<h2 class="anchored" data-anchor-id="i-independence-of-the-residuals-y-values">I: Independence of the residuals (<span class="math inline">\(Y\)</span> values)</h2>
<ul>
<li><p><strong>Are the data points independent of each other?</strong></p></li>
<li><p>Examples of when they are <em>not</em> independent, include</p>
<ul>
<li>repeated measures (such as baseline, 3 months, 6 months)</li>
<li>data from clusters, such as different hospitals or families</li>
</ul></li>
<li><p>This condition is checked by reviewing the study <em>design</em> and not by inspecting the data</p></li>
<li><p>How to analyze data using regression models when the <span class="math inline">\(Y\)</span>-values are not independent is covered in BSTA 519 (Longitudinal data)</p></li>
</ul>
</section>
</section>
<section id="n-normality-of-the-residuals" class="level1">
<h1>N: Normality of the residuals</h1>
<ul>
<li>Extract residuals from regression model in R</li>
<li>Diagnostic tools:
<ul>
<li>Distribution plots of residuals</li>
<li>QQ plots</li>
</ul></li>
</ul>
<section id="n-normality-of-the-residuals-1" class="level2">
<h2 class="anchored" data-anchor-id="n-normality-of-the-residuals-1">N: Normality of the residuals</h2>
<ul>
<li>The responses Y are normally distributed at each level of x</li>
</ul>
<p><em>See slides for image.</em></p>
</section>
<section id="extract-models-residuals-in-r" class="level2">
<h2 class="anchored" data-anchor-id="extract-models-residuals-in-r">Extract model’s residuals in R</h2>
<ul>
<li>First extract the residuals’ values from the model output using the <code>augment()</code> function from the <code>broom</code> package.</li>
<li>Get a tibble with the orginal data, as well as the residuals and some other important values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> gapm)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>aug1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(model1) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(aug1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 8
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ .fitted                    &lt;dbl&gt; 53.94643, 73.14897, 64.53453, 74.00809, 73.…
$ .resid                     &lt;dbl&gt; 2.7535654, 3.5510294, -3.6345319, 2.8919074…
$ .hat                       &lt;dbl&gt; 0.13628996, 0.01768176, 0.02645854, 0.02077…
$ .sigma                     &lt;dbl&gt; 6.172684, 6.168414, 6.167643, 6.172935, 6.1…
$ .cooksd                    &lt;dbl&gt; 1.835891e-02, 3.062372e-03, 4.887448e-03, 2…
$ .std.resid                 &lt;dbl&gt; 0.48238134, 0.58332052, -0.59972251, 0.4757…</code></pre>
</div>
</div>
</section>
<section id="check-normality-with-usual-distribution-plots" class="level2">
<h2 class="anchored" data-anchor-id="check-normality-with-usual-distribution-plots">Check normality with “usual” distribution plots</h2>
<p>Note that below I save each figure, and then combine them together in one row of output using <code>grid.arrange()</code> from the <code>gridExtra</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>hist1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>density1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>box1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># NEW!!!</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist1, density1, box1, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
<section id="normal-qq-plots-qq-quantile-quantile" class="level2">
<h2 class="anchored" data-anchor-id="normal-qq-plots-qq-quantile-quantile">Normal QQ plots (QQ = quantile-quantile)</h2>
<ul>
<li><p>It can be tricky to eyeball with a histogram or density plot whether the residuals are normal or not</p></li>
<li><p>QQ plots are often used to help with this</p></li>
<li><p><em>Vertical axis</em>: <strong>data quantiles</strong></p>
<ul>
<li>data points are sorted in order and</li>
<li>assigned quantiles based on how many data points there are</li>
</ul></li>
<li><p><em>Horizontal axis</em>: <strong>theoretical quantiles</strong></p>
<ul>
<li>mean and standard deviation (SD) calculated from the data points</li>
<li>theoretical quantiles are calculated for each point, assuming the data are modeled by a normal distribution with the mean and SD of the data</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ul>
<li><strong>Data are approximately normal if points fall on a line.</strong></li>
</ul>
<p>See more info at <a href="https://data.library.virginia.edu/understanding-QQ-plots/" class="uri">https://data.library.virginia.edu/understanding-QQ-plots/</a></p>
<section id="examples-of-normal-qq-plots" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-normal-qq-plots">Examples of Normal QQ plots</h3>
<p><em>See slides for examples.</em></p>
</section>
</section>
<section id="qq-plot-of-residuals-of-model1" class="level2">
<h2 class="anchored" data-anchor-id="qq-plot-of-residuals-of-model1">QQ plot of residuals of <code>model1</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist1, density1, box1, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span>     <span class="co"># points</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()  <span class="co"># line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="compare-to-randomly-generated-normal-qq-plots" class="level2">
<h2 class="anchored" data-anchor-id="compare-to-randomly-generated-normal-qq-plots">Compare to randomly generated Normal QQ plots</h2>
<p>How “<em>good</em>” we can expect a QQ plot to look depends on the sample size.</p>
<ul>
<li><p>The QQ plots on the next slides are randomly generated</p>
<ul>
<li>using random samples from actual standard normal distributions <span class="math inline">\(N(0,1)\)</span>.</li>
</ul></li>
<li><p>Thus, all the points in the QQ plots <strong>should theoretically</strong> fall in a line</p></li>
<li><p>However, there is sampling variability…</p></li>
</ul>
<section id="randomly-generated-normal-qq-plots-n100" class="level3">
<h3 class="anchored" data-anchor-id="randomly-generated-normal-qq-plots-n100">Randomly generated Normal QQ plots: n=100</h3>
<ul>
<li>Note that <code>stat_qq_line()</code> doesn’t work with randomly generated samples, and thus the code below manually creates the line that the points should be on (which is <span class="math inline">\(y=x\)</span> in this case.)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="examples-of-simulated-normal-qq-plots-n10" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-simulated-normal-qq-plots-n10">Examples of simulated Normal QQ plots: n=10</h3>
<p>With fewer data points,</p>
<ul>
<li>simulated QQ plots are more likely to look “less normal”</li>
<li>even though the data points were sampled from normal distributions.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># only change made to code!</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="examples-of-simulated-normal-qq-plots-n1000" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-simulated-normal-qq-plots-n1000">Examples of simulated Normal QQ plots: n=1,000</h3>
<p>With more data points,</p>
<ul>
<li>simulated QQ plots are more likely to look “more normal”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># only change made to code!</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
</section>
<section id="back-to-our-example" class="level2">
<h2 class="anchored" data-anchor-id="back-to-our-example">Back to our example</h2>
<p>Residuals from Life Expectancy vs.&nbsp;Female Literacy Rate Regression</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Simulated QQ plot of Normal Residuals with n = 80</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in fitted model</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">rnorm</span>(<span class="dv">80</span>))) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
</section>
<section id="e-equality-of-variance-of-the-residuals" class="level1 nostretch">
<h1 class="nostretch">E: Equality of variance of the residuals</h1>
<ul>
<li>Homoscedasticity</li>
<li>Diagnostic tool: <strong>residual plot</strong></li>
</ul>
<section id="residual-plot" class="level2">
<h2 class="anchored" data-anchor-id="residual-plot">Residual plot</h2>
<ul>
<li><span class="math inline">\(x\)</span> = explanatory variable from regression model
<ul>
<li>(or the fitted values for a multiple regression)</li>
</ul></li>
<li><span class="math inline">\(y\)</span> = residuals from regression model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aug1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "life_expectancy_years_2011" "female_literacy_rate_2011" 
[3] ".fitted"                    ".resid"                    
[5] ".hat"                       ".sigma"                    
[7] ".cooksd"                    ".std.resid"                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> female_literacy_rate_2011, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="dv">0</span>, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="e-equality-of-variance-of-the-residuals-homoscedasticity" class="level2">
<h2 class="anchored" data-anchor-id="e-equality-of-variance-of-the-residuals-homoscedasticity">E: Equality of variance of the residuals (Homoscedasticity)</h2>
<ul>
<li>The <strong>variance</strong> or, equivalently, the standard deviation of the responses is <strong>equal for all values of x</strong>.</li>
<li>This is called <strong>homoskedasticity</strong> (top row)</li>
<li>If there is <strong>heteroskedasticity</strong> (bottom row), then the assumption is not met.</li>
</ul>
<p><em>See slides for image.</em></p>
</section>
</section>
<section id="r2-coefficient-of-determination" class="level1">
<h1><span class="math inline">\(R^2\)</span> = Coefficient of determination</h1>
<p>Another way to assess model fit</p>
<section id="r2-coefficient-of-determination-12" class="level2">
<h2 class="anchored" data-anchor-id="r2-coefficient-of-determination-12"><span class="math inline">\(R^2\)</span> = Coefficient of determination (1/2)</h2>
<ul>
<li>Recall that the correlation coefficient <span class="math inline">\(r\)</span> measures the strength of the linear relationship between two numerical variables</li>
<li><span class="math inline">\(R^2\)</span> is usually used to measure the strength of a <em>linear fit</em>
<ul>
<li>For a simple linear regression model (one numerical predictor), <span class="math inline">\(R^2\)</span> is just the square of the correlation coefficient</li>
</ul></li>
<li>In general, <span class="math inline">\(R^2\)</span> is the proportion of the variability of the dependent variable that is <strong>explained</strong> by the independent variable(s)</li>
</ul>
<p><span class="math display">\[R^2 = \frac{\textrm{variance of predicted y-values}}
{\textrm{variance of observed y-values}} = \frac{\sum_{i=1}^n(\widehat{y}_i-\bar{y})^2}
{\sum_{i=1}^n(y_i-\bar{y})^2}
= \frac{s_y^2 - s_{\textrm{residuals}}^2}
{s_y^2}\]</span> <span class="math display">\[R^2 = 1- \frac{s_{\textrm{residuals}}^2}
{s_y^2}\]</span> where <span class="math inline">\(\frac{s_{\textrm{residuals}}^2}{s_y^2}\)</span> is the proportion of “unexplained” variability in the <span class="math inline">\(y\)</span> values,<br>
and thus <span class="math inline">\(R^2 = 1- \frac{s_{\textrm{residuls}}^2}{s_y^2}\)</span> is the proportion of “explained” variability in the <span class="math inline">\(y\)</span> values</p>
</section>
<section id="r2-coefficient-of-determination-22" class="level2">
<h2 class="anchored" data-anchor-id="r2-coefficient-of-determination-22"><span class="math inline">\(R^2\)</span> = Coefficient of determination (2/2)</h2>
<ul>
<li><p>Recall, <span class="math inline">\(-1&lt;r&lt;1\)</span></p></li>
<li><p>Thus, <span class="math inline">\(0&lt;R^2&lt;1\)</span></p></li>
<li><p>In practice, we want “high” <span class="math inline">\(R^2\)</span> values, i.e.&nbsp;<span class="math inline">\(R^2\)</span> as close to 1 as possible.</p></li>
</ul>
<p>Calculating <span class="math inline">\(R^2\)</span> in R using <code>glance()</code> from the <code>broom</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.411         0.403  6.14      54.4 1.50e-10     1  -258.  521.  529.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4109366</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>A model can have a high <span class="math inline">\(R^2\)</span> value when there is a curved pattern.</li>
<li>Always first check whether a linear model is reasonable or not.</li>
</ul>
</div>
</div>
</section>
<section id="r2-in-summary-r-output" class="level2">
<h2 class="anchored" data-anchor-id="r2-in-summary-r-output"><span class="math inline">\(R^2\)</span> in <code>summary()</code> R output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, 
    data = gapm)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.299  -2.670   1.145   4.114   9.498 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               50.92790    2.66041  19.143  &lt; 2e-16 ***
female_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.142 on 78 degrees of freedom
Multiple R-squared:  0.4109,    Adjusted R-squared:  0.4034 
F-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10</code></pre>
</div>
</div>
<p>Compare to the square of the correlation coefficient <span class="math inline">\(r\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="at">x =</span> gapm<span class="sc">$</span>life_expectancy_years_2011, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> gapm<span class="sc">$</span>female_literacy_rate_2011,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span>  <span class="st">"complete.obs"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6410434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4109366</code></pre>
</div>
</div>
</section>
</section>
<section id="regression-inference" class="level1">
<h1>Regression inference</h1>
<ol type="1">
<li>Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></li>
<li>CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></li>
<li>Prediction interval for predicting <strong>individual</strong> observations</li>
</ol>
<section id="inference-for-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="inference-for-population-slope-beta_1">Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> gapm)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="co"># conf.int = TRUE part is new! </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="sfhdzlppva" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sfhdzlppva table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sfhdzlppva thead, #sfhdzlppva tbody, #sfhdzlppva tfoot, #sfhdzlppva tr, #sfhdzlppva td, #sfhdzlppva th {
  border-style: none;
}

#sfhdzlppva p {
  margin: 0;
  padding: 0;
}

#sfhdzlppva .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sfhdzlppva .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sfhdzlppva .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sfhdzlppva .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sfhdzlppva .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfhdzlppva .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfhdzlppva .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfhdzlppva .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sfhdzlppva .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sfhdzlppva .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sfhdzlppva .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sfhdzlppva .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sfhdzlppva .gt_spanner_row {
  border-bottom-style: hidden;
}

#sfhdzlppva .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sfhdzlppva .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sfhdzlppva .gt_from_md > :first-child {
  margin-top: 0;
}

#sfhdzlppva .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sfhdzlppva .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sfhdzlppva .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sfhdzlppva .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sfhdzlppva .gt_row_group_first td {
  border-top-width: 2px;
}

#sfhdzlppva .gt_row_group_first th {
  border-top-width: 2px;
}

#sfhdzlppva .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfhdzlppva .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sfhdzlppva .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sfhdzlppva .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfhdzlppva .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfhdzlppva .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sfhdzlppva .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sfhdzlppva .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sfhdzlppva .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfhdzlppva .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfhdzlppva .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfhdzlppva .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfhdzlppva .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfhdzlppva .gt_left {
  text-align: left;
}

#sfhdzlppva .gt_center {
  text-align: center;
}

#sfhdzlppva .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sfhdzlppva .gt_font_normal {
  font-weight: normal;
}

#sfhdzlppva .gt_font_bold {
  font-weight: bold;
}

#sfhdzlppva .gt_font_italic {
  font-style: italic;
}

#sfhdzlppva .gt_super {
  font-size: 65%;
}

#sfhdzlppva .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sfhdzlppva .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sfhdzlppva .gt_indent_1 {
  text-indent: 5px;
}

#sfhdzlppva .gt_indent_2 {
  text-indent: 10px;
}

#sfhdzlppva .gt_indent_3 {
  text-indent: 15px;
}

#sfhdzlppva .gt_indent_4 {
  text-indent: 20px;
}

#sfhdzlppva .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><span class="math display">\[\begin{align}
\widehat{y} =&amp; b_0 + b_1 \cdot x\\
\widehat{\text{life expectancy}} =&amp; 50.9 + 0.232 \cdot \text{female literacy rate}
\end{align}\]</span></p>
<ul>
<li>What are <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_A\)</span>?</li>
<li>How do we calculate the standard error, statistic, <em>p</em>-value, and CI?</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>We can also test &amp; calculate CI for the population intercept</li>
<li>This will be covered in BSTA 512</li>
</ul>
</div>
</div>
<section id="inference-for-the-population-slope-ci-and-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="inference-for-the-population-slope-ci-and-hypothesis-test">Inference for the population <span style="color:green"><strong>slope</strong></span>: CI and hypothesis test</h3>
<p><strong>Population model</strong><br>
<em>line + random “noise”</em></p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \varepsilon\]</span> with <span class="math inline">\(\varepsilon \sim N(0,\sigma)\)</span><br>
<span class="math inline">\(\sigma\)</span> is the variability (SD) of the residuals</p>
<p><br></p>
<p><strong>Sample best-fit (least-squares) line:</strong></p>
<p><span class="math display">\[\widehat{y} = b_0 + b_1 \cdot x \]</span></p>
<p>Note: Some sources use <span class="math inline">\(\widehat{\beta}\)</span> instead of <span class="math inline">\(b\)</span>.</p>
<ul>
<li>Construct a <strong>95% confidence interval</strong> for the <strong>population slope</strong> <span class="math inline">\(\beta_1\)</span></li>
</ul>
<p><br></p>
<ul>
<li>Conduct the <strong>hypothesis test</strong></li>
</ul>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_1 = 0\\
\text{vs. } H_A&amp;: \beta_1 \neq 0
\end{align}\]</span></p>
<p><br></p>
<p><em>Note: R reports p-values for 2-sided tests</em></p>
</section>
<section id="ci-for-population-slope-beta_1" class="level3">
<h3 class="anchored" data-anchor-id="ci-for-population-slope-beta_1">CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h3>
<p>Recall the general CI formula:</p>
<p><span class="math display">\[\textrm{Point Estimate} \pm t^*\cdot SE_{\textrm{Point Estimate}}\]</span></p>
<p>For the CI of the coefficient <span class="math inline">\(b_1\)</span> this translates to</p>
<p><span class="math display">\[b_1 \pm t^*\cdot SE_{b_1}\]</span> where <span class="math inline">\(t^*\)</span> is the critical value from a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(df = n -2\)</span>.</p>
<p><br></p>
<p><em>How is</em> <span class="math inline">\(\text{SE}_{b_1}\)</span> <em>calculated?</em> See next slide.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term                  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             50.9      2.66       19.1  3.33e-31   45.6      56.2  
2 female_literacy_rate…    0.232    0.0315      7.38 1.50e-10    0.170     0.295</code></pre>
</div>
</div>
</section>
<section id="standard-error-of-fitted-slope-b_1" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-of-fitted-slope-b_1">Standard error of fitted slope <span class="math inline">\(b_1\)</span></h3>
<p><span class="math display">\[\text{SE}_{b_1} = \frac{s_{\textrm{residuals}}}{s_x\sqrt{n-1}}\]</span></p>
<p><span class="math inline">\(\text{SE}_{b_1}\)</span> is the <strong>variability</strong> of the statistic <span class="math inline">\(b_1\)</span></p>
<ul>
<li><span class="math inline">\(s_{\textrm{residuals}}^2\)</span> is the sd of the residuals</li>
<li><span class="math inline">\(s_x\)</span> is the sample sd of the explanatory variable <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(n\)</span> is the sample size, or the number of (complete) pairs of points</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.411         0.403  6.14      54.4 1.50e-10     1  -258.  521.  529.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard deviation of the residuals (Residual standard error in summary() output)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard deviation of x's</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.95371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pairs of complete observations</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(se_b1 <span class="ot">&lt;-</span> s_resid<span class="sc">/</span>(s_x <span class="sc">*</span> <span class="fu">sqrt</span>(n<span class="dv">-1</span>))) <span class="co"># compare to SE in regression output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03147744</code></pre>
</div>
</div>
</section>
<section id="calculate-ci-for-population-slope-beta_1" class="level3">
<h3 class="anchored" data-anchor-id="calculate-ci-for-population-slope-beta_1">Calculate CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h3>
<p><span class="math display">\[b_1 \pm t^*\cdot SE_{b_1}\]</span></p>
<p>where <span class="math inline">\(t^*\)</span> is the <span class="math inline">\(t\)</span>-distribution critical value with <span class="math inline">\(df = n -2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="eenaijtmfm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eenaijtmfm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eenaijtmfm thead, #eenaijtmfm tbody, #eenaijtmfm tfoot, #eenaijtmfm tr, #eenaijtmfm td, #eenaijtmfm th {
  border-style: none;
}

#eenaijtmfm p {
  margin: 0;
  padding: 0;
}

#eenaijtmfm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eenaijtmfm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eenaijtmfm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eenaijtmfm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eenaijtmfm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eenaijtmfm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eenaijtmfm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eenaijtmfm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eenaijtmfm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eenaijtmfm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eenaijtmfm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eenaijtmfm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eenaijtmfm .gt_spanner_row {
  border-bottom-style: hidden;
}

#eenaijtmfm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eenaijtmfm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eenaijtmfm .gt_from_md > :first-child {
  margin-top: 0;
}

#eenaijtmfm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eenaijtmfm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eenaijtmfm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eenaijtmfm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eenaijtmfm .gt_row_group_first td {
  border-top-width: 2px;
}

#eenaijtmfm .gt_row_group_first th {
  border-top-width: 2px;
}

#eenaijtmfm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eenaijtmfm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eenaijtmfm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eenaijtmfm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eenaijtmfm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eenaijtmfm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eenaijtmfm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eenaijtmfm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eenaijtmfm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eenaijtmfm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eenaijtmfm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eenaijtmfm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eenaijtmfm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eenaijtmfm .gt_left {
  text-align: left;
}

#eenaijtmfm .gt_center {
  text-align: center;
}

#eenaijtmfm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eenaijtmfm .gt_font_normal {
  font-weight: normal;
}

#eenaijtmfm .gt_font_bold {
  font-weight: bold;
}

#eenaijtmfm .gt_font_italic {
  font-style: italic;
}

#eenaijtmfm .gt_super {
  font-size: 65%;
}

#eenaijtmfm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eenaijtmfm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eenaijtmfm .gt_indent_1 {
  text-indent: 5px;
}

#eenaijtmfm .gt_indent_2 {
  text-indent: 10px;
}

#eenaijtmfm .gt_indent_3 {
  text-indent: 15px;
}

#eenaijtmfm .gt_indent_4 {
  text-indent: 20px;
}

#eenaijtmfm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Save regression output for the row with the slope’s information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model1_b1 <span class="ot">&lt;-</span><span class="fu">tidy</span>(model1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"female_literacy_rate_2011"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model1_b1 <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="uvyjbxqcqr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uvyjbxqcqr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uvyjbxqcqr thead, #uvyjbxqcqr tbody, #uvyjbxqcqr tfoot, #uvyjbxqcqr tr, #uvyjbxqcqr td, #uvyjbxqcqr th {
  border-style: none;
}

#uvyjbxqcqr p {
  margin: 0;
  padding: 0;
}

#uvyjbxqcqr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uvyjbxqcqr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uvyjbxqcqr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uvyjbxqcqr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uvyjbxqcqr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uvyjbxqcqr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvyjbxqcqr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uvyjbxqcqr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uvyjbxqcqr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uvyjbxqcqr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uvyjbxqcqr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uvyjbxqcqr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uvyjbxqcqr .gt_spanner_row {
  border-bottom-style: hidden;
}

#uvyjbxqcqr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uvyjbxqcqr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uvyjbxqcqr .gt_from_md > :first-child {
  margin-top: 0;
}

#uvyjbxqcqr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uvyjbxqcqr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uvyjbxqcqr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uvyjbxqcqr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uvyjbxqcqr .gt_row_group_first td {
  border-top-width: 2px;
}

#uvyjbxqcqr .gt_row_group_first th {
  border-top-width: 2px;
}

#uvyjbxqcqr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvyjbxqcqr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uvyjbxqcqr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uvyjbxqcqr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvyjbxqcqr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvyjbxqcqr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uvyjbxqcqr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uvyjbxqcqr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uvyjbxqcqr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvyjbxqcqr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uvyjbxqcqr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvyjbxqcqr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uvyjbxqcqr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvyjbxqcqr .gt_left {
  text-align: left;
}

#uvyjbxqcqr .gt_center {
  text-align: center;
}

#uvyjbxqcqr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uvyjbxqcqr .gt_font_normal {
  font-weight: normal;
}

#uvyjbxqcqr .gt_font_bold {
  font-weight: bold;
}

#uvyjbxqcqr .gt_font_italic {
  font-style: italic;
}

#uvyjbxqcqr .gt_super {
  font-size: 65%;
}

#uvyjbxqcqr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uvyjbxqcqr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uvyjbxqcqr .gt_indent_1 {
  text-indent: 5px;
}

#uvyjbxqcqr .gt_indent_2 {
  text-indent: 10px;
}

#uvyjbxqcqr .gt_indent_3 {
  text-indent: 15px;
}

#uvyjbxqcqr .gt_indent_4 {
  text-indent: 20px;
}

#uvyjbxqcqr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Save values needed for CI:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>estimate</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>std.error</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model1) <span class="co"># sample size n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">80-2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
</div>
<p>Compare CI bounds below with the ones in the regression table above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(CI_LB <span class="ot">&lt;-</span> b1 <span class="sc">-</span> tstar<span class="sc">*</span>SE_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1695284</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(CI_UB <span class="ot">&lt;-</span> b1 <span class="sc">+</span> tstar<span class="sc">*</span>SE_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2948619</code></pre>
</div>
</div>
</section>
<section id="hypothesis-test-for-population-slope-beta_1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-for-population-slope-beta_1">Hypothesis test for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h3>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \beta_1 = 0\\
\text{vs. } H_A&amp;: \beta_1 \neq 0
\end{align}\]</span></p>
<p>The <strong>test statistic</strong> for <span class="math inline">\(b_1\)</span> is</p>
<p><span class="math display">\[t = \frac{ b_1 - \beta_1}{ \text{SE}_{b_1}} = \frac{ b_1}{ \text{SE}_{b_1}}\]</span></p>
<p>when we assume <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="rlnjmcksqk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rlnjmcksqk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rlnjmcksqk thead, #rlnjmcksqk tbody, #rlnjmcksqk tfoot, #rlnjmcksqk tr, #rlnjmcksqk td, #rlnjmcksqk th {
  border-style: none;
}

#rlnjmcksqk p {
  margin: 0;
  padding: 0;
}

#rlnjmcksqk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rlnjmcksqk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rlnjmcksqk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rlnjmcksqk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rlnjmcksqk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rlnjmcksqk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rlnjmcksqk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rlnjmcksqk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rlnjmcksqk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rlnjmcksqk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rlnjmcksqk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rlnjmcksqk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rlnjmcksqk .gt_spanner_row {
  border-bottom-style: hidden;
}

#rlnjmcksqk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rlnjmcksqk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rlnjmcksqk .gt_from_md > :first-child {
  margin-top: 0;
}

#rlnjmcksqk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rlnjmcksqk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rlnjmcksqk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rlnjmcksqk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rlnjmcksqk .gt_row_group_first td {
  border-top-width: 2px;
}

#rlnjmcksqk .gt_row_group_first th {
  border-top-width: 2px;
}

#rlnjmcksqk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rlnjmcksqk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rlnjmcksqk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rlnjmcksqk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rlnjmcksqk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rlnjmcksqk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rlnjmcksqk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rlnjmcksqk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rlnjmcksqk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rlnjmcksqk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rlnjmcksqk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rlnjmcksqk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rlnjmcksqk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rlnjmcksqk .gt_left {
  text-align: left;
}

#rlnjmcksqk .gt_center {
  text-align: center;
}

#rlnjmcksqk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rlnjmcksqk .gt_font_normal {
  font-weight: normal;
}

#rlnjmcksqk .gt_font_bold {
  font-weight: bold;
}

#rlnjmcksqk .gt_font_italic {
  font-style: italic;
}

#rlnjmcksqk .gt_super {
  font-size: 65%;
}

#rlnjmcksqk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rlnjmcksqk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rlnjmcksqk .gt_indent_1 {
  text-indent: 5px;
}

#rlnjmcksqk .gt_indent_2 {
  text-indent: 10px;
}

#rlnjmcksqk .gt_indent_3 {
  text-indent: 15px;
}

#rlnjmcksqk .gt_indent_4 {
  text-indent: 20px;
}

#rlnjmcksqk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Calculate the test statistic using the values in the regression table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recall model1_b1 is regression table restricted to b1 row</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>(TestStat <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>estimate <span class="sc">/</span> model1_b1<span class="sc">$</span>std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.376557</code></pre>
</div>
</div>
<p>Compare this test statistic value to the one from the regression table above</p>
</section>
<section id="p-value-for-testing-population-slope-beta_1" class="level3">
<h3 class="anchored" data-anchor-id="p-value-for-testing-population-slope-beta_1"><span class="math inline">\(p\)</span>-value for testing population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h3>
<ul>
<li><p>As usual, the <span class="math inline">\(p\)</span>-value is the <em>probability of obtaining a test statistic</em> <strong>just as extreme or more extreme</strong> <em>than the observed test statistic assuming the null hypothesis</em> <span class="math inline">\(H_0\)</span> <em>is true.</em></p></li>
<li><p>To calculate the <span class="math inline">\(p\)</span>-value, we need to know the probability distribution of the test statistic (the <em>null distribution</em>) assuming <span class="math inline">\(H_0\)</span> is true.</p></li>
<li><p>Statistical theory tells us that the test statistic <span class="math inline">\(t\)</span> can be modeled by a <span style="color:green"><strong><span class="math inline">\(t\)</span>-distribution</strong></span> with <span style="color:green"><strong><span class="math inline">\(df = n-2\)</span></strong></span>.</p></li>
<li><p>Recall that this is a 2-sided test:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pv =</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(TestStat, <span class="at">df=</span><span class="dv">80-2</span>, <span class="at">lower.tail=</span>F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.501286e-10</code></pre>
</div>
</div>
<p>Compare the <span class="math inline">\(p\)</span>-value to the one from the regression table below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()  <span class="co"># compare p-value calculated above to p-value in table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="fygwlmeczf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fygwlmeczf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fygwlmeczf thead, #fygwlmeczf tbody, #fygwlmeczf tfoot, #fygwlmeczf tr, #fygwlmeczf td, #fygwlmeczf th {
  border-style: none;
}

#fygwlmeczf p {
  margin: 0;
  padding: 0;
}

#fygwlmeczf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fygwlmeczf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fygwlmeczf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fygwlmeczf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fygwlmeczf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fygwlmeczf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fygwlmeczf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fygwlmeczf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fygwlmeczf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fygwlmeczf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fygwlmeczf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fygwlmeczf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fygwlmeczf .gt_spanner_row {
  border-bottom-style: hidden;
}

#fygwlmeczf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fygwlmeczf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fygwlmeczf .gt_from_md > :first-child {
  margin-top: 0;
}

#fygwlmeczf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fygwlmeczf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fygwlmeczf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fygwlmeczf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fygwlmeczf .gt_row_group_first td {
  border-top-width: 2px;
}

#fygwlmeczf .gt_row_group_first th {
  border-top-width: 2px;
}

#fygwlmeczf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fygwlmeczf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fygwlmeczf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fygwlmeczf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fygwlmeczf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fygwlmeczf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fygwlmeczf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fygwlmeczf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fygwlmeczf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fygwlmeczf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fygwlmeczf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fygwlmeczf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fygwlmeczf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fygwlmeczf .gt_left {
  text-align: left;
}

#fygwlmeczf .gt_center {
  text-align: center;
}

#fygwlmeczf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fygwlmeczf .gt_font_normal {
  font-weight: normal;
}

#fygwlmeczf .gt_font_bold {
  font-weight: bold;
}

#fygwlmeczf .gt_font_italic {
  font-style: italic;
}

#fygwlmeczf .gt_super {
  font-size: 65%;
}

#fygwlmeczf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fygwlmeczf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fygwlmeczf .gt_indent_1 {
  text-indent: 5px;
}

#fygwlmeczf .gt_indent_2 {
  text-indent: 10px;
}

#fygwlmeczf .gt_indent_3 {
  text-indent: 15px;
}

#fygwlmeczf .gt_indent_4 {
  text-indent: 20px;
}

#fygwlmeczf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="prediction-inference" class="level1">
<h1>Prediction (&amp; inference)</h1>
<ol type="1">
<li>Prediction for mean response</li>
<li>Prediction for new individual observation</li>
</ol>
<section id="prediction-with-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-regression-line">Prediction with regression line</h2>
<div class="cell">
<div class="cell-output-display">

<div id="itmsffkyyo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#itmsffkyyo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#itmsffkyyo thead, #itmsffkyyo tbody, #itmsffkyyo tfoot, #itmsffkyyo tr, #itmsffkyyo td, #itmsffkyyo th {
  border-style: none;
}

#itmsffkyyo p {
  margin: 0;
  padding: 0;
}

#itmsffkyyo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#itmsffkyyo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#itmsffkyyo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#itmsffkyyo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#itmsffkyyo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#itmsffkyyo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itmsffkyyo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#itmsffkyyo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#itmsffkyyo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#itmsffkyyo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#itmsffkyyo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#itmsffkyyo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#itmsffkyyo .gt_spanner_row {
  border-bottom-style: hidden;
}

#itmsffkyyo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#itmsffkyyo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#itmsffkyyo .gt_from_md > :first-child {
  margin-top: 0;
}

#itmsffkyyo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#itmsffkyyo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#itmsffkyyo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#itmsffkyyo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#itmsffkyyo .gt_row_group_first td {
  border-top-width: 2px;
}

#itmsffkyyo .gt_row_group_first th {
  border-top-width: 2px;
}

#itmsffkyyo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#itmsffkyyo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#itmsffkyyo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#itmsffkyyo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itmsffkyyo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#itmsffkyyo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#itmsffkyyo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#itmsffkyyo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#itmsffkyyo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itmsffkyyo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#itmsffkyyo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#itmsffkyyo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#itmsffkyyo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#itmsffkyyo .gt_left {
  text-align: left;
}

#itmsffkyyo .gt_center {
  text-align: center;
}

#itmsffkyyo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#itmsffkyyo .gt_font_normal {
  font-weight: normal;
}

#itmsffkyyo .gt_font_bold {
  font-weight: bold;
}

#itmsffkyyo .gt_font_italic {
  font-style: italic;
}

#itmsffkyyo .gt_super {
  font-size: 65%;
}

#itmsffkyyo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#itmsffkyyo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#itmsffkyyo .gt_indent_1 {
  text-indent: 5px;
}

#itmsffkyyo .gt_indent_2 {
  text-indent: 10px;
}

#itmsffkyyo .gt_indent_3 {
  text-indent: 15px;
}

#itmsffkyyo .gt_indent_4 {
  text-indent: 20px;
}

#itmsffkyyo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot \textrm{female literacy rate} \]</span></p>
<p>What is the predicted life expectancy for a country with female literacy rate 60%?</p>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot 60 = 64.82\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(y_60 <span class="ot">&lt;-</span> <span class="fl">50.9</span> <span class="sc">+</span> <span class="fl">0.232</span><span class="sc">*</span><span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.82</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>How do we interpret the predicted value?</li>
<li>How variable is it?</li>
</ul>
<section id="prediction-with-regression-line-1" class="level3">
<h3 class="anchored" data-anchor-id="prediction-with-regression-line-1">Prediction with regression line</h3>
<p>Recall the population model:</p>
<p><em>line + random “noise”</em></p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \varepsilon\]</span> with <span class="math inline">\(\varepsilon \sim N(0,\sigma)\)</span><br>
<span class="math inline">\(\sigma\)</span> is the variability (SD) of the residuals</p>
<p><br></p>
<ul>
<li>When we take the expected value, at a given value <span class="math inline">\(x^*\)</span>, we have that the predicted response is the average expected response at <span class="math inline">\(x^*\)</span>:</li>
</ul>
<p><span class="math display">\[\widehat{E[Y|x^*]} = b_0 + b_1 x^*\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapm, <span class="fu">aes</span>(<span class="at">x =</span> female_literacy_rate_2011,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"female literacy rate"</span>, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"life expectancy"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Life expectancy vs. female literacy rate"</span>) <span class="sc">+</span>  </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">60</span>, <span class="at">color =</span> <span class="st">"green3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ul>
<li>These are the points on the regression line.</li>
<li>The mean responses has variability, and we can calculate a CI for it, for every value of <span class="math inline">\(x^*\)</span>.</li>
</ul>
</section>
<section id="ci-for-mean-response-mu_yx" class="level3">
<h3 class="anchored" data-anchor-id="ci-for-mean-response-mu_yx">CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h3>
<p><span class="math display">\[\widehat{E[Y|x^*]} \pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\]</span></p>
<ul>
<li><span class="math inline">\(SE_{\widehat{E[Y|x^*]}}\)</span> is calculated using</li>
</ul>
<p><span class="math display">\[SE_{\widehat{E[Y|x^*]}} = s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\]</span></p>
<ul>
<li><span class="math inline">\(\widehat{E[Y|x^*]}\)</span> is the predicted value at the specified point <span class="math inline">\(x^*\)</span> of the explanatory variable</li>
<li><span class="math inline">\(s_{\textrm{residuals}}^2\)</span> is the sd of the residuals</li>
<li><span class="math inline">\(n\)</span> is the sample size, or the number of (complete) pairs of points</li>
<li><span class="math inline">\(\bar{x}\)</span> is the sample mean of the explanatory variable <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(s_x\)</span> is the sample sd of the explanatory variable <span class="math inline">\(x\)</span></li>
</ul>
<p><br></p>
<ul>
<li>Recall that <span class="math inline">\(t_{n-2}^*\)</span> is calculated using <code>qt()</code> and depends on the confidence level.</li>
</ul>
</section>
<section id="example-ci-for-mean-response-mu_yx" class="level3">
<h3 class="anchored" data-anchor-id="example-ci-for-mean-response-mu_yx">Example: CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h3>
<p><strong>Find the 95% CI for the mean life expectancy when the female literacy rate is 60.</strong></p>
<p><span class="math display">\[\begin{align}
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\\
64.8596 &amp;\pm 1.990847 \cdot s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 6.142157 \sqrt{\frac{1}{80} + \frac{(60 - 81.65375)^2}{(80-1)21.95371^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 0.9675541\\
64.8596 &amp;\pm 1.926252\\
(62.93335 &amp;, 66.78586)
\end{align}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(Y60 <span class="ot">&lt;-</span> <span class="fl">50.9278981</span> <span class="sc">+</span> <span class="fl">0.2321951</span> <span class="sc">*</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.8596</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">78</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(mx <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.65375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.95371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(SE_Yx <span class="ot">&lt;-</span> s_resid <span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (<span class="dv">60</span> <span class="sc">-</span> mx)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span>s_x<span class="sc">^</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9675541</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(MOE_Yx <span class="ot">&lt;-</span> SE_Yx<span class="sc">*</span>tstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.926252</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">-</span> MOE_Yx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.93335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">+</span> MOE_Yx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.78586</code></pre>
</div>
</div>
</section>
<section id="example-using-r-for-ci-for-mean-response-mu_yx" class="level3">
<h3 class="anchored" data-anchor-id="example-using-r-for-ci-for-mean-response-mu_yx">Example: Using R for CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h3>
<p><strong>Find the 95% CI’s for the mean life expectancy when the female literacy rate is 40, 60, and 80.</strong></p>
<ul>
<li>Use the base R <code>predict()</code> function</li>
<li>Requires specification of a <code>newdata</code> “value”
<ul>
<li>The <code>newdata</code> value is <span class="math inline">\(x^*\)</span></li>
<li>This has to be in the format of a data frame though</li>
<li>with column name identical to the predictor variable in the model</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">female_literacy_rate_2011 =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>)) </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>newdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  female_literacy_rate_2011
1                        40
2                        60
3                        80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model1, </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span>newdata, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 60.21570 57.26905 63.16236
2 64.85961 62.93335 66.78586
3 69.50351 68.13244 70.87457</code></pre>
</div>
</div>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<p>We are 95% confident that the <strong>average</strong> life expectancy for a country with a 60% female literacy rate will be between 62.9 and 66.8 years.</p>
</section>
<section id="confidence-bands-for-mean-response-mu_yx" class="level3">
<h3 class="anchored" data-anchor-id="confidence-bands-for-mean-response-mu_yx">Confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h3>
<ul>
<li>Often we plot the CI for many values of X, creating <strong>confidence bands</strong></li>
<li>The confidence bands are what ggplot creates when we set <code>se = TRUE</code> within <code>geom_smooth</code></li>
<li>For what values of x are the confidence bands (intervals) narrowest?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapm,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>female_literacy_rate_2011, </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Life expectancy vs. female literacy rate"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="width-of-confidence-bands-for-mean-response-mu_yx" class="level3">
<h3 class="anchored" data-anchor-id="width-of-confidence-bands-for-mean-response-mu_yx">Width of confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h3>
<ul>
<li>For what values of <span class="math inline">\(x^*\)</span> are the confidence bands (intervals) narrowest? widest?</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\\
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}
\end{align}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
</section>
<section id="prediction-interval-for-predicting-individual-observations" class="level2">
<h2 class="anchored" data-anchor-id="prediction-interval-for-predicting-individual-observations">Prediction interval for predicting <strong>individual</strong> observations</h2>
<ul>
<li>We do not call this interval a CI since <span class="math inline">\(Y\)</span> is a random variable instead of a parameter</li>
<li>The form is similar to a CI though:</li>
</ul>
<p><span class="math display">\[\widehat{Y|x^*} \pm t_{n-2}^* \cdot s_{residuals} \sqrt{1 + \frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\]</span></p>
<ul>
<li>Note that the only difference to the CI for a mean value of y is the additional <code>1+</code> under the square root.
<ul>
<li>Thus the width is wider!</li>
</ul></li>
</ul>
<section id="example-prediction-interval" class="level3">
<h3 class="anchored" data-anchor-id="example-prediction-interval">Example: Prediction interval</h3>
<p><strong>Find the 95% prediction interval for the life expectancy when the female literacy rate is 60.</strong></p>
<p><span class="math display">\[\begin{align}
\widehat{Y|x^*} &amp;\pm t_{n-2}^* \cdot s_{residuals} \sqrt{1 + \frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 6.142157 \sqrt{1+\frac{1}{80} + \frac{(60 - 81.65375)^2}{(80-1)21.95371^2}}\\
(52.48072 &amp;, 77.23849)
\end{align}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>(Y60 <span class="ot">&lt;-</span> <span class="fl">50.9278981</span> <span class="sc">+</span> <span class="fl">0.2321951</span> <span class="sc">*</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.8596</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">78</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(mx <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.65375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.95371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(SE_Ypred <span class="ot">&lt;-</span> s_resid <span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (<span class="dv">60</span> <span class="sc">-</span> mx)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span>s_x<span class="sc">^</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.217898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(MOE_Ypred <span class="ot">&lt;-</span> SE_Ypred<span class="sc">*</span>tstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.37888</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">-</span> MOE_Ypred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52.48072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">+</span> MOE_Ypred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77.23849</code></pre>
</div>
</div>
</section>
<section id="example-using-r-for-prediction-interval" class="level3">
<h3 class="anchored" data-anchor-id="example-using-r-for-prediction-interval">Example: Using R for prediction interval</h3>
<p><strong>Find the 95% prediction intervals for the life expectancy when the female literacy rate is 40, 60, and 80.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>newdata  <span class="co"># previously defined for CI's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  female_literacy_rate_2011
1                        40
2                        60
3                        80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model1, </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span>newdata, </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"prediction"</span>)  <span class="co"># prediction instead of "confidence"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 60.21570 47.63758 72.79382
2 64.85961 52.48072 77.23849
3 69.50351 57.19879 81.80823</code></pre>
</div>
</div>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<p>We are 95% confident that a new selected country with a 60% female literacy rate will have a life expectancy between 52.5 and 77.2 years.</p>
</section>
</section>
<section id="prediction-bands-vs.-confidence-bands-12" class="level2">
<h2 class="anchored" data-anchor-id="prediction-bands-vs.-confidence-bands-12">Prediction bands vs.&nbsp;confidence bands (1/2)</h2>
<p>Create a scatterplot with the regression line, 95% confidence bands, and 95% prediction bands.</p>
<ul>
<li>First create a data frame with the original data points (both x and y values), their respective predicted values, andtheir respective prediction intervals</li>
<li>Can do this with <code>augment()</code> from the <code>broom</code> package.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>model1_pred_bands <span class="ot">&lt;-</span> <span class="fu">augment</span>(model1, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at new object:</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model1_pred_bands) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "life_expectancy_years_2011" "female_literacy_rate_2011" 
 [3] ".fitted"                    ".lower"                    
 [5] ".upper"                     ".resid"                    
 [7] ".hat"                       ".sigma"                    
 [9] ".cooksd"                    ".std.resid"                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse of select variables of interest:</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>model1_pred_bands <span class="sc">%&gt;%</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011, </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>         .fitted<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 5
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ .fitted                    &lt;dbl&gt; 53.94643, 73.14897, 64.53453, 74.00809, 73.…
$ .lower                     &lt;dbl&gt; 40.91166, 60.81324, 52.14572, 61.65365, 61.…
$ .upper                     &lt;dbl&gt; 66.98121, 85.48470, 76.92334, 86.36253, 86.…</code></pre>
</div>
</div>
<section id="prediction-bands-vs.-confidence-bands-22" class="level3">
<h3 class="anchored" data-anchor-id="prediction-bands-vs.-confidence-bands-22">Prediction bands vs.&nbsp;confidence bands (2/2)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model1_pred_bands) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "life_expectancy_years_2011" "female_literacy_rate_2011" 
 [3] ".fitted"                    ".lower"                    
 [5] ".upper"                     ".resid"                    
 [7] ".hat"                       ".sigma"                    
 [9] ".cooksd"                    ".std.resid"                </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model1_pred_bands, </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>female_literacy_rate_2011, <span class="at">y=</span>life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="co"># prediction bands</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span>  <span class="co"># confidence bands</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SLR with Confidence &amp; Prediction Bands"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Day16_bsta511_code_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="480"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>