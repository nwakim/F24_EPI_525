---
title: "Lesson 6: Normal and Poisson distributions"
subtitle: "TB sections 3.3-3.4"
author: "Meike Niederhausen and Nicky Wakim"
title-slide-attributes:
    data-background-color: "#3070BF"
date: "10/16/2024"
format: 
  revealjs:
    theme: "../simple_NW.scss"
    chalkboard: true
    slide-number: true
    show-slide-number: all
    width: 1955
    height: 1100
    footer: Lesson 6 Slides
    html-math-method: mathjax
    highlight-style: arrow
execute:
  echo: true
  freeze: auto
editor: 
  markdown: 
    wrap: 72
---

# Learning Objectives

## Where are we?

![](../img_slides/course_map.png){fig-align="center"}

# Learning Objectives

## Last time: Discrete vs. continuous random variables

-   Probability distributions are usually either **discrete** or
    **continuous**, depending on whether the random variable is discrete
    or continuous.

:::::::::::: columns
:::::: {.column width="47%"}
::::: red
::: red-ttl
Discrete random variable
:::

::: red-cont
A **discrete** r.v. $X$ takes on a finite number of values or countably
infinite number of possible values.
:::
:::::

Think:

-   Number of heads in a set of coin tosses
-   Number of people who have had chicken pox in a random sample
::::::

::: {.column width="2%"}
:::

:::::: {.column width="49%"}
::::: pink2
::: pink2-ttl
Continuous random variable
:::

::: pink2-cont
A **continuous** r.v. $X$ can take on any real value in an interval of
values or unions of intervals.
:::
:::::

Think:

-   Height in a population
-   Blood pressure in a population
::::::
::::::::::::

## Probabilities for continuous distributions

Two important features of continuous distributions:

-   The total area under the density curve is 1.

-   The probability that a variable has a value within a specified
    interval is the area under the curve over that interval.

![](../img_slides/fdicHeightContDistFilled.png){fig-align="center"}

## Probabilities for continuous distributions...

When working with continuous random variables, probability is found for
intervals of values rather than individual values.

-   The probability that a continuous r.v. $X$ takes on any single
    individual value is 0. That is, $P(X = x) = 0$.

-   Thus, $P(a < X < b)$ is equivalent to $P(a \leq X \leq b)$.

## Standard Normal Distribution

![Transformation from general normal $X$ to standard normal
$Z$](../img_slides/X_to_Z_transformation_Brase.png){width="5in"}

## Standard Normal Distribution

-   A *standard normal* distribution is defined as a normal distribution
    with mean 0 and variance 1. It is often denoted as $Z \sim N(0, 1)$.

-   Any normal random variable $X$ can be transformed into a standard
    normal random variable $Z$.

$$Z = \dfrac{X - \mu}{\sigma} \qquad X = \mu + Z\sigma$$

-   The $Z$-score of an observation quantifies how far the observation is from the mean, in units of standard deviation(s).

-   For example, if an observation has $Z$-score $z = 3.4$, then the observation is 3.4 standard deviations above the mean.

## Normal distribution

- Shorthand


## Normal distribution: R commands

R commands with their [input]{style="color:#BF396F"} and
[output]{style="color:#367B79"}:

+------------------+--------------------------------------------------+
| R code           | What does it return?                             |
+==================+==================================================+
| `rnorm()`        | returns [sample of random                        |
|                  | variables]{style="color:#367B79"} with           |
|                  | [specified normal                                |
|                  | distribution]{style="color:#BF396F"}             |
+------------------+--------------------------------------------------+
| `dnorm()`        | returns [value of probability                    |
|                  | density]{style="color:#367B79"} at [certain      |
|                  | point of the normal                              |
|                  | distribution]{style="color:#BF396F"}             |
|                  |                                                  |
|                  | -   Not typically used                           |
+------------------+--------------------------------------------------+
| `pnorm()`        | returns [cumulative                              |
|                  | probability]{style="color:#367B79"} of getting   |
|                  | [certain point (or less) of the normal           |
|                  | distribution]{style="color:#BF396F"}             |
+------------------+--------------------------------------------------+
| `qnorm()`        | returns [z-score]{style="color:#367B79"}        |
|                  | corresponding to [desired                        |
|                  | quantile]{style="color:#BF396F"}                 |
+------------------+--------------------------------------------------+

## Example calculating 

::: example
**Example 1**. ***Calculating standard normal probabilities practice**
Let* $Z$ be a standard normal random variable,
$Z\sim N(\mu=0,\sigma=1)$. Calculate the following probabilities.
Include sketches of the normal curves with the probability areas shaded
in.

1.  $\mathbb{P}( Z < 2.67 )$

2.  $\mathbb{P}( Z > -0.37 )$

3.  $\mathbb{P}( -2.18 < Z < 2.46 )$

4.  $\mathbb{P}(Z = 1.53 )$
:::

## example 1

::: example
**Example 3**. ***DBP** Suppose the distribution of diastolic blood
pressure (DBP) in 35- to 44-year old men is normally distributed with
mean 80 mm Hg and variance 144 mm Hg.*

1.  *Mild hypertension is when the DBP is between 90 and 99 mm Hg. What
    proportion of this population has mild hypertension?*

2.  *What is the* $10^{th}$ percentile of the DBP distribution?

3.  *What is the* $95^{th}$ percentile of the DBP distribution?
:::

## Normal approximation of the binomial distribution

-   Recall that a binomial random variable $X$ counts the total number
    of successes in $n$ independent trials, each with probability $p$ of
    a success.

-   Probability function for $x = 0, 1, ..., n$ :
    $$P(X = k) = {n\choose k}p^k(1-p)^{n-k} = \frac{n!}{k!(n-k)!}p^k(1-p)^{n-k}$$

-   Tedious to compute for large number of trails ($n$), although doable
    with software like R

-   As $n$ gets big though, the distribution shape of a binomial r.v.
    gets more and more symmetric, and can be *approximated by a normal
    distribution*.

![Binomial distribution histograms for varying $n$ when
$p=0.10$](../img_slides/fourBinomialModelsShowingApproxToNormal.pdf){width="5in"}

## Normal Approximation of the Binomial Distribution

-   Also known as: **Sampling distribution of** $\widehat{p}$

-   IF $X\sim \text{Binomial}(n,p)$ and $np>10$ and $nq = n(1-p) > 10$

    -   Ensures sample size ($n$) is moderately large and the $p$ is not too close to 0 or 1
    -   Other resources use other criteria (like $npq>5$ or $np>5$)
    -   When looking at a sample, we use $\widehat{p}$ instead of $p$ to check this!!

¬†

-   THEN approximately $ùëã\sim \text{Normal}\big(\mu_X = np, \sigma_X = \sqrt{np(1-p)} \big)$

    -   Or we often write this as the sampling distribution of $\widehat{p}$: $$\widehat{p} \sim \text{Normal}\bigg(\mu_{\widehat{p}} = p, \sigma_{\widehat{p}} = \sqrt{\dfrac{p(1-p)}{n}}\bigg)$$

-   [Pretty good video behind the intuition of this](https://www.youtube.com/watch?v=CCqWkJ_pqNU&ab_channel=jbstatistics) (Watch 00:00 - 05:40)

## Example using Normal approximation

::: example
**Example 5**. ***Vaccinated people testing positive for Covid-19
(revisited)** About 25% of people that test positive for Covid-19 are
vaccinated for Covid-19. Suppose 100 people have tested positive for
Covid-19 (independently of each other). Let* $X$ denote the number of
people that are vaccinated amongst the 100 that tested positive. What is
the probability that fewer than 20 of the people that tested positive
are vaccinated?

![image](../img_slides/binom_n100_p25_crop.png){width="4in"}

1.  *Calculate exact probability.*

2.  *Calculate approximate probability.*
:::

## Some resources for the normal distribution

- [Page on R commands](https://seankross.com/notes/dpqr/)

# Learning objectives

## Introduction to the Poisson distribution

- The Poisson distribution is often used to calculate probabilities for rare
events that accumulate over time.

  - It is a discrete distribution!

- It used most often in settings where events happen at a rate $\lambda$
per unit of population and per unit time, such as the annual incidence
of a disease in a population.

-   **Typical example:** for children ages 0 - 14, the incidence rate of
    acute lymphocytic leukemia (ALL) was approximately 30 diagnosed
    cases per million children per year in 2010.

-   Always take care to note and understand the units.

-   Used to model count data (# of successes), especially for rare
    events

-   Used to approximate binomial distribution when $n$ is large and $p$
    is small

## Poisson Distribution

Suppose events occur over time in such a way that

1.  The probability an event occurs in an interval is proportional to
    the length of the interval.

2.  Events occur independently at a rate $\lambda$ per unit of time.

Then the probability of exactly $x$ events in one unit of time is $$
P(X = x) = \frac{e^{-\lambda}\lambda^{x}}{x!}, \,\, x = 0, 1, 2,
\ldots
$$

The probability of exactly $x$ events $t$ units of time is $$
P(X = x) = \frac{e^{-\lambda t}(\lambda t)^{x}}{x!}, \,\, x = 0, 1,
2, \ldots
$$

For the Poisson distribution modeling the number of events in one unit
of time:

-   The mean is $\lambda$.

-   The standard deviation is $\sqrt{\lambda}$.

In $t$ units of time, the mean and standard deviation are, respectively,
$\lambda t$ and $\sqrt{\lambda t}$.

## Poisson distribution

-   Discrete distribution

-   Used to model count data (# of successes), especially for rare
    events

-   Used to approximate binomial distribution when $n$ is large and $p$
    is small

## 

::: definition
**Definition 6**. *Distribution of a **Poisson** random variable. Let*
$X$ be the total number of successes in an interval (such as time) with
an average success rate $\lambda$. Then probability of observing exactly
$k$ successes in a unit interval is
:::

-   The parameter of a Poisson distribution is $\lambda$.

-   If a r.v. $X$ is modeled by a Poisson distribution, then we write in
    shorthand

## Mean and SD

::: theorem
**Theorem 7**. *Mean and SD of a Poisson r.v. If* $X$ is a Poisson r.v.
with parameter $\lambda$, then
:::

## Example

::: example
**Example 8**. ***Typhoid fever** Suppose there are on average 5 deaths
per year from typhoid fever over a 1-year period.*

![image](../img_slides/Poisson_L5.png){width="5in"}

1.  *What is the probability of 3 deaths in a year?*

2.  *What is the probability of 2 deaths in 0.5 years?*

3.  *What is the probability of more than 12 deaths in 2 years?*
:::

## Example: Poisson approximation of binomial distribution

::: example
**Example 9**. ***Cleft palate** About 1 in every 1,700 babies is born
with cleft palate in the United States. Find the probability that there
are 2 babies born with cleft palates amongst the next 3000 births at
OHSU.*

1.  *Calculate exact probability.*

2.  *Calculate approximate probability.*
:::
